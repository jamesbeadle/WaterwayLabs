import{i as $a,a as su}from"./CLaUggeZ.js";import{_ as au}from"./CmsKOCeN.js";import{w as qa}from"./ChItw61O.js";var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ou(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}const cu=BigInt(60*60*1e3*1e3*1e3*24*14),uu=576,fu=625;var Cs;(function(r){r[r.SysFatal=1]="SysFatal",r[r.SysTransient=2]="SysTransient",r[r.DestinationInvalid=3]="DestinationInvalid",r[r.CanisterReject=4]="CanisterReject",r[r.CanisterError=5]="CanisterError"})(Cs||(Cs={}));const ni="abcdefghijklmnopqrstuvwxyz234567",kr=Object.create(null);for(let r=0;r<ni.length;r++)kr[ni[r]]=r;kr[0]=kr.o;kr[1]=kr.i;function lu(r){let e=0,t=0,n="";function i(o){return e<0?t|=o>>-e:t=o<<e&248,e>3?(e-=8,1):(e<4&&(n+=ni[t>>3],e+=5),0)}for(let o=0;o<r.length;)o+=i(r[o]);return n+(e<0?ni[t>>3]:"")}function du(r){let e=0,t=0;const n=new Uint8Array(r.length*4/3|0);let i=0;function o(c){let u=kr[c.toLowerCase()];if(u===void 0)throw new Error(`Invalid character: ${JSON.stringify(c)}`);u<<=3,t|=u>>>e,e+=5,e>=8&&(n[i++]=t,e-=8,e>0?t=u<<5-e&255:t=0)}for(const c of r)o(c);return n.slice(0,i)}const hu=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function pu(r){const e=new Uint8Array(r);let t=-1;for(let n=0;n<e.length;n++){const o=(e[n]^t)&255;t=hu[o]^t>>>8}return(t^-1)>>>0}const mr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function yu(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function wu(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function ms(r,...e){if(!yu(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function $s(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function gu(r,e){ms(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function un(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function Bi(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function wt(r,e){return r<<32-e|r>>>e}function bu(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Ga(r){return typeof r=="string"&&(r=bu(r)),ms(r),r}class mu{}function _s(r){const e=n=>r().update(Ga(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Ha(r=32){if(mr&&typeof mr.getRandomValues=="function")return mr.getRandomValues(new Uint8Array(r));if(mr&&typeof mr.randomBytes=="function")return Uint8Array.from(mr.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function _u(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),o=BigInt(4294967295),c=Number(t>>i&o),u=Number(t&o),h=n?4:0,w=n?0:4;r.setUint32(e+h,c,n),r.setUint32(e+w,u,n)}function xu(r,e,t){return r&e^~r&t}function Eu(r,e,t){return r&e^r&t^e&t}class Va extends mu{constructor(e,t,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Bi(this.buffer)}update(e){$s(this),e=Ga(e),ms(e);const{view:t,buffer:n,blockLen:i}=this,o=e.length;for(let c=0;c<o;){const u=Math.min(i-this.pos,o-c);if(u===i){const h=Bi(e);for(;i<=o-c;c+=i)this.process(h,c);continue}n.set(e.subarray(c,c+u),this.pos),this.pos+=u,c+=u,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){$s(this),gu(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:o}=this;let{pos:c}=this;t[c++]=128,un(this.buffer.subarray(c)),this.padOffset>i-c&&(this.process(n,0),c=0);for(let v=c;v<i;v++)t[v]=0;_u(n,i-8,BigInt(this.length*8),o),this.process(n,0);const u=Bi(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const w=h/4,x=this.get();if(w>x.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<w;v++)u.setUint32(4*v,x[v],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:o,destroyed:c,pos:u}=this;return e.destroyed=c,e.finished=o,e.length=i,e.pos=u,i%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Ct=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$t=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),je=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),En=BigInt(2**32-1),qs=BigInt(32);function vu(r,e=!1){return e?{h:Number(r&En),l:Number(r>>qs&En)}:{h:Number(r>>qs&En)|0,l:Number(r&En)|0}}function Iu(r,e=!1){const t=r.length;let n=new Uint32Array(t),i=new Uint32Array(t);for(let o=0;o<t;o++){const{h:c,l:u}=vu(r[o],e);[n[o],i[o]]=[c,u]}return[n,i]}const Gs=(r,e,t)=>r>>>t,Hs=(r,e,t)=>r<<32-t|e>>>t,_r=(r,e,t)=>r>>>t|e<<32-t,xr=(r,e,t)=>r<<32-t|e>>>t,vn=(r,e,t)=>r<<64-t|e>>>t-32,In=(r,e,t)=>r>>>t-32|e<<64-t;function Tt(r,e,t,n){const i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}const Au=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Su=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Tu=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Bu=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,Nu=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),Ou=(r,e,t,n,i,o)=>e+t+n+i+o+(r/2**32|0)|0,Uu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qt=new Uint32Array(64);class Ka extends Va{constructor(e=32){super(64,e,8,!1),this.A=Ct[0]|0,this.B=Ct[1]|0,this.C=Ct[2]|0,this.D=Ct[3]|0,this.E=Ct[4]|0,this.F=Ct[5]|0,this.G=Ct[6]|0,this.H=Ct[7]|0}get(){const{A:e,B:t,C:n,D:i,E:o,F:c,G:u,H:h}=this;return[e,t,n,i,o,c,u,h]}set(e,t,n,i,o,c,u,h){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=c|0,this.G=u|0,this.H=h|0}process(e,t){for(let v=0;v<16;v++,t+=4)qt[v]=e.getUint32(t,!1);for(let v=16;v<64;v++){const A=qt[v-15],d=qt[v-2],U=wt(A,7)^wt(A,18)^A>>>3,P=wt(d,17)^wt(d,19)^d>>>10;qt[v]=P+qt[v-7]+U+qt[v-16]|0}let{A:n,B:i,C:o,D:c,E:u,F:h,G:w,H:x}=this;for(let v=0;v<64;v++){const A=wt(u,6)^wt(u,11)^wt(u,25),d=x+A+xu(u,h,w)+Uu[v]+qt[v]|0,P=(wt(n,2)^wt(n,13)^wt(n,22))+Eu(n,i,o)|0;x=w,w=h,h=u,u=c+d|0,c=o,o=i,i=n,n=d+P|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,c=c+this.D|0,u=u+this.E|0,h=h+this.F|0,w=w+this.G|0,x=x+this.H|0,this.set(n,i,o,c,u,h,w,x)}roundClean(){un(qt)}destroy(){this.set(0,0,0,0,0,0,0,0),un(this.buffer)}}class Ru extends Ka{constructor(){super(28),this.A=$t[0]|0,this.B=$t[1]|0,this.C=$t[2]|0,this.D=$t[3]|0,this.E=$t[4]|0,this.F=$t[5]|0,this.G=$t[6]|0,this.H=$t[7]|0}}const ja=Iu(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Pu=ja[0],Fu=ja[1],Gt=new Uint32Array(80),Ht=new Uint32Array(80);class Lu extends Va{constructor(e=64){super(128,e,16,!1),this.Ah=je[0]|0,this.Al=je[1]|0,this.Bh=je[2]|0,this.Bl=je[3]|0,this.Ch=je[4]|0,this.Cl=je[5]|0,this.Dh=je[6]|0,this.Dl=je[7]|0,this.Eh=je[8]|0,this.El=je[9]|0,this.Fh=je[10]|0,this.Fl=je[11]|0,this.Gh=je[12]|0,this.Gl=je[13]|0,this.Hh=je[14]|0,this.Hl=je[15]|0}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:o,Cl:c,Dh:u,Dl:h,Eh:w,El:x,Fh:v,Fl:A,Gh:d,Gl:U,Hh:P,Hl:R}=this;return[e,t,n,i,o,c,u,h,w,x,v,A,d,U,P,R]}set(e,t,n,i,o,c,u,h,w,x,v,A,d,U,P,R){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=c|0,this.Dh=u|0,this.Dl=h|0,this.Eh=w|0,this.El=x|0,this.Fh=v|0,this.Fl=A|0,this.Gh=d|0,this.Gl=U|0,this.Hh=P|0,this.Hl=R|0}process(e,t){for(let F=0;F<16;F++,t+=4)Gt[F]=e.getUint32(t),Ht[F]=e.getUint32(t+=4);for(let F=16;F<80;F++){const O=Gt[F-15]|0,Z=Ht[F-15]|0,q=_r(O,Z,1)^_r(O,Z,8)^Gs(O,Z,7),$=xr(O,Z,1)^xr(O,Z,8)^Hs(O,Z,7),K=Gt[F-2]|0,z=Ht[F-2]|0,V=_r(K,z,19)^vn(K,z,61)^Gs(K,z,6),ae=xr(K,z,19)^In(K,z,61)^Hs(K,z,6),_=Tu($,ae,Ht[F-7],Ht[F-16]),S=Bu(_,q,V,Gt[F-7],Gt[F-16]);Gt[F]=S|0,Ht[F]=_|0}let{Ah:n,Al:i,Bh:o,Bl:c,Ch:u,Cl:h,Dh:w,Dl:x,Eh:v,El:A,Fh:d,Fl:U,Gh:P,Gl:R,Hh:k,Hl:C}=this;for(let F=0;F<80;F++){const O=_r(v,A,14)^_r(v,A,18)^vn(v,A,41),Z=xr(v,A,14)^xr(v,A,18)^In(v,A,41),q=v&d^~v&P,$=A&U^~A&R,K=Nu(C,Z,$,Fu[F],Ht[F]),z=Ou(K,k,O,q,Pu[F],Gt[F]),V=K|0,ae=_r(n,i,28)^vn(n,i,34)^vn(n,i,39),_=xr(n,i,28)^In(n,i,34)^In(n,i,39),S=n&o^n&u^o&u,M=i&c^i&h^c&h;k=P|0,C=R|0,P=d|0,R=U|0,d=v|0,U=A|0,{h:v,l:A}=Tt(w|0,x|0,z|0,V|0),w=u|0,x=h|0,u=o|0,h=c|0,o=n|0,c=i|0;const H=Au(V,_,M);n=Su(H,z,ae,S),i=H|0}({h:n,l:i}=Tt(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:c}=Tt(this.Bh|0,this.Bl|0,o|0,c|0),{h:u,l:h}=Tt(this.Ch|0,this.Cl|0,u|0,h|0),{h:w,l:x}=Tt(this.Dh|0,this.Dl|0,w|0,x|0),{h:v,l:A}=Tt(this.Eh|0,this.El|0,v|0,A|0),{h:d,l:U}=Tt(this.Fh|0,this.Fl|0,d|0,U|0),{h:P,l:R}=Tt(this.Gh|0,this.Gl|0,P|0,R|0),{h:k,l:C}=Tt(this.Hh|0,this.Hl|0,k|0,C|0),this.set(n,i,o,c,u,h,w,x,v,A,d,U,P,R,k,C)}roundClean(){un(Gt,Ht)}destroy(){un(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const xs=_s(()=>new Ka),Mu=_s(()=>new Ru),Du=_s(()=>new Lu),ku=xs,Cu=Mu;function $u(r){return Cu.create().update(new Uint8Array(r)).digest()}const An="__principal__",qu=2,Vs=4,Gu="aaaaa-aa",Hu=r=>{var e;return new Uint8Array(((e=r.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(t=>parseInt(t,16)))},Vu=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"");let Ee=class Ln{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([Vs]))}static managementCanister(){return this.fromText(Gu)}static selfAuthenticating(e){const t=$u(e);return new this(new Uint8Array([...t,qu]))}static from(e){if(typeof e=="string")return Ln.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new Ln(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new Ln(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(Hu(e))}static fromText(e){let t=e;if(e.includes(An)){const c=JSON.parse(e);An in c&&(t=c[An])}const n=t.toLowerCase().replace(/-/g,"");let i=du(n);i=i.slice(4,i.length);const o=new this(i);if(o.toText()!==t)throw new Error(`Principal "${o.toText()}" does not have a valid checksum (original value "${t}" may not be a valid Principal ID).`);return o}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===Vs}toUint8Array(){return this._arr}toHex(){return Vu(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,pu(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),o=new Uint8Array([...n,...i]),u=lu(o).match(/.{1,5}/g);if(!u)throw new Error;return u.join("-")}toString(){return this.toText()}toJSON(){return{[An]:this.toText()}}compareTo(e){for(let t=0;t<Math.min(this._arr.length,e._arr.length);t++){if(this._arr[t]<e._arr[t])return"lt";if(this._arr[t]>e._arr[t])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const t=this.compareTo(e);return t=="lt"||t=="eq"}gtEq(e){const t=this.compareTo(e);return t=="gt"||t=="eq"}};function pt(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e.buffer}function Pe(r){return[...new Uint8Array(r)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Ku=new RegExp(/^[0-9a-fA-F]+$/);function Mt(r){if(!Ku.test(r))throw new Error("Invalid hexadecimal string.");const e=[...r].reduce((t,n,i)=>(t[i/2|0]=(t[i/2|0]||"")+n,t),[]).map(t=>Number.parseInt(t,16));return new Uint8Array(e).buffer}function za(r,e){if(r.byteLength!==e.byteLength)return r.byteLength-e.byteLength;const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]!==n[i])return t[i]-n[i];return 0}function wn(r,e){return za(r,e)===0}function rn(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function Pt(r){return r instanceof Uint8Array?rn(r):r instanceof ArrayBuffer?r:Array.isArray(r)?rn(new Uint8Array(r)):"buffer"in r?Pt(r.buffer):rn(new Uint8Array(r))}class Me extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Me.prototype,Object.setPrototypeOf(this,Me.prototype)}}function _e(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e}class Gr{constructor(e,t=e?.byteLength||0){this._buffer=Cr(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,t)}save(){return this._view}restore(e){this._view=e}get buffer(){return Cr(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const t=this._view.subarray(0,e);return this._view=this._view.subarray(e),t.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const t=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+t.byteLength>=this._buffer.byteLength?this.alloc(t.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+t.byteLength),this._view.set(t,n)}get end(){return this._view.byteLength===0}alloc(e){const t=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(t,0,this._view.byteLength+e);n.set(this._view),this._buffer=t,this._view=n}}function Ni(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function Cr(r){return r instanceof Uint8Array?Ni(r):r instanceof ArrayBuffer?r:Array.isArray(r)?Ni(new Uint8Array(r)):"buffer"in r?Cr(r.buffer):Ni(new Uint8Array(r))}function ju(r){const t=new TextEncoder().encode(r);let n=0;for(const i of t)n=(n*223+i)%2**32;return n}function At(r){if(/^_\d+_$/.test(r)||/^_0x[0-9a-fA-F]+_$/.test(r)){const e=+r.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return ju(r)}function Wa(){throw new Error("unexpected end of buffer")}function hr(r,e){return r.byteLength<e&&Wa(),r.read(e)}function pr(r){const e=r.readUint8();return e===void 0&&Wa(),e}function Be(r){if(typeof r=="number"&&(r=BigInt(r)),r<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,t=new Gr(new ArrayBuffer(e),0);for(;;){const n=Number(r&BigInt(127));if(r/=BigInt(128),r===BigInt(0)){t.write(new Uint8Array([n]));break}else t.write(new Uint8Array([n|128]))}return t.buffer}function $e(r){let e=BigInt(1),t=BigInt(0),n;do n=pr(r),t+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return t}function De(r){typeof r=="number"&&(r=BigInt(r));const e=r<BigInt(0);e&&(r=-r-BigInt(1));const t=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,n=new Gr(new ArrayBuffer(t),0);for(;;){const o=i(r);if(r/=BigInt(128),e&&r===BigInt(0)&&o&64||!e&&r===BigInt(0)&&!(o&64)){n.write(new Uint8Array([o]));break}else n.write(new Uint8Array([o|128]))}function i(o){const c=o%BigInt(128);return Number(e?BigInt(128)-c-BigInt(1):c)}return n.buffer}function Kt(r){const e=new Uint8Array(r.buffer);let t=0;for(;t<e.byteLength;t++)if(e[t]<128){if(!(e[t]&64))return $e(r);break}const n=new Uint8Array(hr(r,t+1));let i=BigInt(0);for(let o=n.byteLength-1;o>=0;o--)i=i*BigInt(128)+BigInt(128-(n[o]&127)-1);return-i-BigInt(1)}function zu(r,e){if(BigInt(r)<BigInt(0))throw new Error("Cannot write negative values.");return Ya(r,e)}function Ya(r,e){r=BigInt(r);const t=new Gr(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),o=BigInt(0),c=Number(r%i);for(t.write(new Uint8Array([c]));++n<e;)r<0&&o===BigInt(0)&&c!==0&&(o=BigInt(1)),c=Number((r/i-o)%BigInt(256)),t.write(new Uint8Array([c])),i*=BigInt(256);return t.buffer}function Za(r,e){let t=BigInt(pr(r)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const o=BigInt(pr(r));t=t+n*o}return t}function Wu(r,e){let t=Za(r,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return t>=n&&(t-=n*BigInt(2)),t}function Ji(r){const e=BigInt(r);if(r<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const Mn="DIDL",Ks=400;function fn(r,e,t){return r.map((n,i)=>t(n,e[i]))}class Yu{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,t){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(t)}merge(e,t){const n=this._idx.get(e.name),i=this._idx.get(t);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+t);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(t)}encode(){const e=Be(this._typs.length),t=_e(...this._typs);return _e(e,t)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return De(this._idx.get(e)||0)}}class Zu{visitType(e,t){throw new Error("Not implemented")}visitPrimitive(e,t){return this.visitType(e,t)}visitEmpty(e,t){return this.visitPrimitive(e,t)}visitBool(e,t){return this.visitPrimitive(e,t)}visitNull(e,t){return this.visitPrimitive(e,t)}visitReserved(e,t){return this.visitPrimitive(e,t)}visitText(e,t){return this.visitPrimitive(e,t)}visitNumber(e,t){return this.visitPrimitive(e,t)}visitInt(e,t){return this.visitNumber(e,t)}visitNat(e,t){return this.visitNumber(e,t)}visitFloat(e,t){return this.visitPrimitive(e,t)}visitFixedInt(e,t){return this.visitNumber(e,t)}visitFixedNat(e,t){return this.visitNumber(e,t)}visitPrincipal(e,t){return this.visitPrimitive(e,t)}visitConstruct(e,t){return this.visitType(e,t)}visitVec(e,t,n){return this.visitConstruct(e,n)}visitOpt(e,t,n){return this.visitConstruct(e,n)}visitRecord(e,t,n){return this.visitConstruct(e,n)}visitTuple(e,t,n){const i=t.map((o,c)=>[`_${c}_`,o]);return this.visitRecord(e,i,n)}visitVariant(e,t,n){return this.visitConstruct(e,n)}visitRec(e,t,n){return this.visitConstruct(t,n)}visitFunc(e,t){return this.visitConstruct(e,t)}visitService(e,t){return this.visitConstruct(e,t)}}class bi{display(){return this.name}valueToString(e){return Ue(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class ot extends bi{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class nr extends bi{checkType(e){if(e instanceof kt){const t=e.getType();if(typeof t>"u")throw new Error("type mismatch with uninitialized type");return t}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class Xa extends ot{accept(e,t){return e.visitEmpty(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return De(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class Ja extends bi{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,t){throw e.visitType(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,t){let n=t.decodeValue(e,t);Object(n)!==n&&(n=Object(n));let i;return t instanceof kt?i=()=>t.getType():i=()=>t,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class Qa extends ot{accept(e,t){return e.visitBool(this,t)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return De(-2)}decodeValue(e,t){switch(this.checkType(t),pr(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class ii extends ot{accept(e,t){return e.visitNull(this,t)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return De(-1)}decodeValue(e,t){return this.checkType(t),null}get name(){return"null"}}class $r extends ot{accept(e,t){return e.visitReserved(this,t)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return De(-16)}decodeValue(e,t){return t.name!==this.name&&t.decodeValue(e,t),null}get name(){return"reserved"}}class eo extends ot{accept(e,t){return e.visitText(this,t)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=new TextEncoder().encode(e),n=Be(t.byteLength);return _e(n,t)}encodeType(){return De(-15)}decodeValue(e,t){this.checkType(t);const n=$e(e),i=hr(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class to extends ot{accept(e,t){return e.visitInt(this,t)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return De(e)}encodeType(){return De(-4)}decodeValue(e,t){return this.checkType(t),Kt(e)}get name(){return"int"}valueToString(e){return e.toString()}}class ro extends ot{accept(e,t){return e.visitNat(this,t)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return Be(e)}encodeType(){return De(-3)}decodeValue(e,t){return this.checkType(t),$e(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Es extends ot{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,t){return e.visitFloat(this,t)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=new ArrayBuffer(this._bits/8),n=new DataView(t);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),t}encodeType(){const e=this._bits===32?-13:-14;return De(e)}decodeValue(e,t){this.checkType(t);const n=hr(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class yr extends ot{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedInt(this,t)}covariant(e){const t=Ji(this._bits-1)*BigInt(-1),n=Ji(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=t&&e<=n;else if(Number.isInteger(e)){const o=BigInt(e);i=o>=t&&o<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return Ya(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return De(-9-e)}decodeValue(e,t){this.checkType(t);const n=Wu(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class Qt extends ot{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedNat(this,t)}covariant(e){const t=Ji(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<t:Number.isInteger(e)&&e>=0?n=BigInt(e)<t:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return zu(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return De(-5-e)}decodeValue(e,t){this.checkType(t);const n=Za(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class mi extends nr{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof Qt&&e._bits===8&&(this._blobOptimization=!0)}accept(e,t){return e.visitVec(this,this._type,t)}covariant(e){const t=this._type instanceof Qt?this._type._bits:this._type instanceof yr?this._type._bits:0;if(ArrayBuffer.isView(e)&&t==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(o){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${o.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=Be(e.length);if(this._blobOptimization)return _e(t,new Uint8Array(e));if(ArrayBuffer.isView(e))return _e(t,new Uint8Array(e.buffer));const n=new Gr(new ArrayBuffer(t.byteLength+e.length),0);n.write(t);for(const i of e){const o=this._type.encodeValue(i);n.write(new Uint8Array(o))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=De(-19),n=this._type.encodeType(e);e.add(this,_e(t,n))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof mi))throw new Error("Not a vector type");const i=Number($e(e));if(this._type instanceof Qt){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof yr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const o=[];for(let c=0;c<i;c++)o.push(this._type.decodeValue(e,n._type));return o}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class wr extends nr{constructor(e){super(),this._type=e}accept(e,t){return e.visitOpt(this,this._type,t)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(t){throw new Error(`Invalid ${this.display()} argument: ${Ue(e)} 

-> ${t.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):_e(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=De(-18),n=this._type.encodeType(e);e.add(this,_e(t,n))}decodeValue(e,t){if(t instanceof ii)return[];if(t instanceof $r)return[];let n=t;if(t instanceof kt){const i=t.getType();if(typeof i>"u")throw new Error("type mismatch with uninitialized type");n=i}if(n instanceof wr)switch(pr(e)){case 0:return[];case 1:{const i=e.save();try{return[this._type.decodeValue(e,n._type)]}catch{return e.restore(i),n._type.decodeValue(e,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof ii||this._type instanceof wr||this._type instanceof $r)return n.decodeValue(e,n),[];{const i=e.save();try{return[this._type.decodeValue(e,t)]}catch{return e.restore(i),n.decodeValue(e,t),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class gn extends nr{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>At(t[0])-At(n[0]))}accept(e,t){return e.visitRecord(this,this._fields,t)}tryAsTuple(){const e=[];for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(n!==`_${t}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([t,n])=>{if(!e.hasOwnProperty(t))throw new Error(`Record is missing key "${t}".`);try{return n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=this._fields.map(([i])=>e[i]),n=fn(this._fields,t,([,i],o)=>i.encodeValue(o));return _e(...n)}_buildTypeTableImpl(e){this._fields.forEach(([o,c])=>c.buildTypeTable(e));const t=De(-20),n=Be(this._fields.length),i=this._fields.map(([o,c])=>_e(Be(At(o)),c.encodeType(e)));e.add(this,_e(t,n,_e(...i)))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof gn))throw new Error("Not a record type");const i={};let o=0,c=0;for(;c<n._fields.length;){const[u,h]=n._fields[c];if(o>=this._fields.length){h.decodeValue(e,h),c++;continue}const[w,x]=this._fields[o],v=At(this._fields[o][0]),A=At(u);if(v===A)i[w]=x.decodeValue(e,h),o++,c++;else if(A>v)if(x instanceof wr||x instanceof $r)i[w]=[],o++;else throw new Error("Cannot find required field "+w);else h.decodeValue(e,h),c++}for(const[u,h]of this._fields.slice(o))if(h instanceof wr||h instanceof $r)i[u]=[];else throw new Error("Cannot find required field "+u);return i}get name(){return`record {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([t,n])=>t+":"+n.display()).join("; ")}}`}valueToString(e){const t=this._fields.map(([i])=>e[i]);return`record {${fn(this._fields,t,([i,o],c)=>i+"="+o.valueToString(c)).join("; ")}}`}}class _i extends gn{constructor(e){const t={};e.forEach((n,i)=>t["_"+i+"_"]=n),super(t),this._components=e}accept(e,t){return e.visitTuple(this,this._components,t)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((t,n)=>{try{return t.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=fn(this._components,e,(n,i)=>n.encodeValue(i));return _e(...t)}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof _i))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[o,c]of n._components.entries())o>=this._components.length?c.decodeValue(e,c):i.push(this._components[o].decodeValue(e,c));return i}display(){return`record {${this._components.map(t=>t.display()).join("; ")}}`}valueToString(e){return`record {${fn(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class xi extends nr{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>At(t[0])-At(n[0]))}accept(e,t){return e.visitVariant(this,this._fields,t)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([t,n])=>{try{return!e.hasOwnProperty(t)||n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(e.hasOwnProperty(n)){const o=Be(t),c=i.encodeValue(e[n]);return _e(o,c)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,o])=>{o.buildTypeTable(e)});const t=De(-21),n=Be(this._fields.length),i=this._fields.map(([o,c])=>_e(Be(At(o)),c.encodeType(e)));e.add(this,_e(t,n,...i))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof xi))throw new Error("Not a variant type");const i=Number($e(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[o,c]=n._fields[i];for(const[u,h]of this._fields)if(At(o)===At(u)){const w=h.decodeValue(e,c);return{[u]:w}}throw new Error("Cannot find field hash "+o)}get name(){return`variant {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([t,n])=>t+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[t,n]of this._fields)if(e.hasOwnProperty(t)){const i=n.valueToString(e[t]);return i==="null"?`variant {${t}}`:`variant {${t}=${i}}`}throw new Error("Variant has no data: "+e)}}class kt extends nr{constructor(){super(...arguments),this._id=kt._counter++,this._type=void 0}accept(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,t)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,t)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}kt._counter=0;function vs(r){if(pr(r)!==1)throw new Error("Cannot decode principal");const t=Number($e(r));return Ee.fromUint8Array(new Uint8Array(hr(r,t)))}class no extends ot{accept(e,t){return e.visitPrincipal(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=Be(t.byteLength);return _e(new Uint8Array([1]),n,t)}encodeType(){return De(-24)}decodeValue(e,t){return this.checkType(t),vs(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class Is extends nr{constructor(e,t,n=[]){super(),this.argTypes=e,this.retTypes=t,this.annotations=n}static argsToString(e,t){if(e.length!==t.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(t[i])).join(", ")+")"}accept(e,t){return e.visitFunc(this,t)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue([e,t]){const n=e.toUint8Array(),i=Be(n.byteLength),o=_e(new Uint8Array([1]),i,n),c=new TextEncoder().encode(t),u=Be(c.byteLength);return _e(new Uint8Array([1]),o,u,c)}_buildTypeTableImpl(e){this.argTypes.forEach(w=>w.buildTypeTable(e)),this.retTypes.forEach(w=>w.buildTypeTable(e));const t=De(-22),n=Be(this.argTypes.length),i=_e(...this.argTypes.map(w=>w.encodeType(e))),o=Be(this.retTypes.length),c=_e(...this.retTypes.map(w=>w.encodeType(e))),u=Be(this.annotations.length),h=_e(...this.annotations.map(w=>this.encodeAnnotation(w)));e.add(this,_e(t,n,i,o,c,u,h))}decodeValue(e){if(pr(e)!==1)throw new Error("Cannot decode function reference");const n=vs(e),i=Number($e(e)),o=hr(e,i),u=new TextDecoder("utf8",{fatal:!0}).decode(o);return[n,u]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),t=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${t})${n}`}valueToString([e,t]){return`func "${e.toText()}".${t}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),t=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e}) → (${t})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class io extends nr{constructor(e){super(),this._fields=Object.entries(e).sort((t,n)=>t[0]<n[0]?-1:t[0]>n[0]?1:0)}accept(e,t){return e.visitService(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ue(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=Be(t.length);return _e(new Uint8Array([1]),n,t)}_buildTypeTableImpl(e){this._fields.forEach(([o,c])=>c.buildTypeTable(e));const t=De(-23),n=Be(this._fields.length),i=this._fields.map(([o,c])=>{const u=new TextEncoder().encode(o),h=Be(u.length);return _e(h,u,c.encodeType(e))});e.add(this,_e(t,n,...i))}decodeValue(e){return vs(e)}get name(){return`service {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Ue(r){const e=JSON.stringify(r,(t,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>Ks?e.substring(0,Ks-3)+"...":e}function Xu(r,e){if(e.length<r.length)throw Error("Wrong number of message arguments");const t=new Yu;r.forEach(h=>h.buildTypeTable(t));const n=new TextEncoder().encode(Mn),i=t.encode(),o=Be(e.length),c=_e(...r.map(h=>h.encodeType(t))),u=_e(...fn(r,e,(h,w)=>{try{h.covariant(w)}catch(x){throw new Error(x.message+`

`)}return h.encodeValue(w)}));return _e(n,i,o,c,u)}function Ju(r,e){const t=new Gr(e);if(e.byteLength<Mn.length)throw new Error("Message length smaller than magic number");const n=hr(t,Mn.length),i=new TextDecoder().decode(n);if(i!==Mn)throw new Error("Wrong magic number: "+JSON.stringify(i));function o(d){const U=[],P=Number($e(d));for(let C=0;C<P;C++){const F=Number(Kt(d));switch(F){case-18:case-19:{const O=Number(Kt(d));U.push([F,O]);break}case-20:case-21:{const O=[];let Z=Number($e(d)),q;for(;Z--;){const $=Number($e(d));if($>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof q=="number"&&q>=$)throw new Error("field id collision or not sorted");q=$;const K=Number(Kt(d));O.push([$,K])}U.push([F,O]);break}case-22:{const O=[];let Z=Number($e(d));for(;Z--;)O.push(Number(Kt(d)));const q=[];let $=Number($e(d));for(;$--;)q.push(Number(Kt(d)));const K=[];let z=Number($e(d));for(;z--;)switch(Number($e(d))){case 1:{K.push("query");break}case 2:{K.push("oneway");break}case 3:{K.push("composite_query");break}default:throw new Error("unknown annotation")}U.push([F,[O,q,K]]);break}case-23:{let O=Number($e(d));const Z=[];for(;O--;){const q=Number($e(d)),$=new TextDecoder().decode(hr(d,q)),K=Kt(d);Z.push([$,K])}U.push([F,Z]);break}default:throw new Error("Illegal op_code: "+F)}}const R=[],k=Number($e(d));for(let C=0;C<k;C++)R.push(Number(Kt(d)));return[U,R]}const[c,u]=o(t);if(u.length<r.length)throw new Error("Wrong number of return values");const h=c.map(d=>No());function w(d){if(d<-24)throw new Error("future value not supported");if(d<0)switch(d){case-1:return co;case-2:return oo;case-3:return lo;case-4:return fo;case-5:return mo;case-6:return _o;case-7:return xo;case-8:return Eo;case-9:return yo;case-10:return wo;case-11:return go;case-12:return bo;case-13:return ho;case-14:return po;case-15:return uo;case-16:return ao;case-17:return so;case-24:return vo;default:throw new Error("Illegal op_code: "+d)}if(d>=c.length)throw new Error("type index out of range");return h[d]}function x(d){switch(d[0]){case-19:{const U=w(d[1]);return Ao(U)}case-18:{const U=w(d[1]);return So(U)}case-20:{const U={};for(const[k,C]of d[1]){const F=`_${k}_`;U[F]=w(C)}const P=To(U),R=P.tryAsTuple();return Array.isArray(R)?Io(...R):P}case-21:{const U={};for(const[P,R]of d[1]){const k=`_${P}_`;U[k]=w(R)}return Bo(U)}case-22:{const[U,P,R]=d[1];return Oo(U.map(k=>w(k)),P.map(k=>w(k)),R)}case-23:{const U={},P=d[1];for(const[R,k]of P){let C=w(k);if(C instanceof kt&&(C=C.getType()),!(C instanceof Is))throw new Error("Illegal service definition: services can only contain functions");U[R]=C}return Uo(U)}default:throw new Error("Illegal op_code: "+d[0])}}c.forEach((d,U)=>{if(d[0]===-22){const P=x(d);h[U].fill(P)}}),c.forEach((d,U)=>{if(d[0]!==-22){const P=x(d);h[U].fill(P)}});const v=u.map(d=>w(d)),A=r.map((d,U)=>d.decodeValue(t,v[U]));for(let d=r.length;d<v.length;d++)v[d].decodeValue(t,v[d]);if(t.byteLength>0)throw new Error("decode: Left-over bytes");return A}const so=new Xa,ao=new $r,Qu=new Ja,oo=new Qa,co=new ii,uo=new eo,fo=new to,lo=new ro,ho=new Es(32),po=new Es(64),yo=new yr(8),wo=new yr(16),go=new yr(32),bo=new yr(64),mo=new Qt(8),_o=new Qt(16),xo=new Qt(32),Eo=new Qt(64),vo=new no;function Io(...r){return new _i(r)}function Ao(r){return new mi(r)}function So(r){return new wr(r)}function To(r){return new gn(r)}function Bo(r){return new xi(r)}function No(){return new kt}function Oo(r,e,t=[]){return new Is(r,e,t)}function Uo(r){return new io(r)}const cd=Object.freeze(Object.defineProperty({__proto__:null,Bool:oo,BoolClass:Qa,ConstructType:nr,Empty:so,EmptyClass:Xa,FixedIntClass:yr,FixedNatClass:Qt,Float32:ho,Float64:po,FloatClass:Es,Func:Oo,FuncClass:Is,Int:fo,Int16:wo,Int32:go,Int64:bo,Int8:yo,IntClass:to,Nat:lo,Nat16:_o,Nat32:xo,Nat64:Eo,Nat8:mo,NatClass:ro,Null:co,NullClass:ii,Opt:So,OptClass:wr,PrimitiveType:ot,Principal:vo,PrincipalClass:no,Rec:No,RecClass:kt,Record:To,RecordClass:gn,Reserved:ao,ReservedClass:$r,Service:Uo,ServiceClass:io,Text:uo,TextClass:eo,Tuple:Io,TupleClass:_i,Type:bi,Unknown:Qu,UnknownClass:Ja,Variant:Bo,VariantClass:xi,Vec:Ao,VecClass:mi,Visitor:Zu,decode:Ju,encode:Xu},Symbol.toStringTag,{value:"Module"}));var Ro={},bn={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){var e=su,t=$a,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=C,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var f=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(f,s),f.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(f){if(f>i)throw new RangeError('The value "'+f+'" is invalid for option "size"');var s=new Uint8Array(f);return Object.setPrototypeOf(s,u.prototype),s}function u(f,s,a){if(typeof f=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(f)}return h(f,s,a)}u.poolSize=8192;function h(f,s,a){if(typeof f=="string")return A(f,s);if(ArrayBuffer.isView(f))return U(f);if(f==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);if(B(f,ArrayBuffer)||f&&B(f.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(B(f,SharedArrayBuffer)||f&&B(f.buffer,SharedArrayBuffer)))return P(f,s,a);if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var l=f.valueOf&&f.valueOf();if(l!=null&&l!==f)return u.from(l,s,a);var g=R(f);if(g)return g;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof f[Symbol.toPrimitive]=="function")return u.from(f[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f)}u.from=function(f,s,a){return h(f,s,a)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function w(f){if(typeof f!="number")throw new TypeError('"size" argument must be of type number');if(f<0)throw new RangeError('The value "'+f+'" is invalid for option "size"')}function x(f,s,a){return w(f),f<=0?c(f):s!==void 0?typeof a=="string"?c(f).fill(s,a):c(f).fill(s):c(f)}u.alloc=function(f,s,a){return x(f,s,a)};function v(f){return w(f),c(f<0?0:k(f)|0)}u.allocUnsafe=function(f){return v(f)},u.allocUnsafeSlow=function(f){return v(f)};function A(f,s){if((typeof s!="string"||s==="")&&(s="utf8"),!u.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var a=F(f,s)|0,l=c(a),g=l.write(f,s);return g!==a&&(l=l.slice(0,g)),l}function d(f){for(var s=f.length<0?0:k(f.length)|0,a=c(s),l=0;l<s;l+=1)a[l]=f[l]&255;return a}function U(f){if(B(f,Uint8Array)){var s=new Uint8Array(f);return P(s.buffer,s.byteOffset,s.byteLength)}return d(f)}function P(f,s,a){if(s<0||f.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');var l;return s===void 0&&a===void 0?l=new Uint8Array(f):a===void 0?l=new Uint8Array(f,s):l=new Uint8Array(f,s,a),Object.setPrototypeOf(l,u.prototype),l}function R(f){if(u.isBuffer(f)){var s=k(f.length)|0,a=c(s);return a.length===0||f.copy(a,0,0,s),a}if(f.length!==void 0)return typeof f.length!="number"||T(f.length)?c(0):d(f);if(f.type==="Buffer"&&Array.isArray(f.data))return d(f.data)}function k(f){if(f>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return f|0}function C(f){return+f!=f&&(f=0),u.alloc(+f)}u.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==u.prototype},u.compare=function(s,a){if(B(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),B(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),!u.isBuffer(s)||!u.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var l=s.length,g=a.length,E=0,L=Math.min(l,g);E<L;++E)if(s[E]!==a[E]){l=s[E],g=a[E];break}return l<g?-1:g<l?1:0},u.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return u.alloc(0);var l;if(a===void 0)for(a=0,l=0;l<s.length;++l)a+=s[l].length;var g=u.allocUnsafe(a),E=0;for(l=0;l<s.length;++l){var L=s[l];if(B(L,Uint8Array))E+L.length>g.length?u.from(L).copy(g,E):Uint8Array.prototype.set.call(g,L,E);else if(u.isBuffer(L))L.copy(g,E);else throw new TypeError('"list" argument must be an Array of Buffers');E+=L.length}return g};function F(f,s){if(u.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||B(f,ArrayBuffer))return f.byteLength;if(typeof f!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);var a=f.length,l=arguments.length>2&&arguments[2]===!0;if(!l&&a===0)return 0;for(var g=!1;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return W(f).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return b(f).length;default:if(g)return l?-1:W(f).length;s=(""+s).toLowerCase(),g=!0}}u.byteLength=F;function O(f,s,a){var l=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,s>>>=0,a<=s))return"";for(f||(f="utf8");;)switch(f){case"hex":return re(this,s,a);case"utf8":case"utf-8":return M(this,s,a);case"ascii":return G(this,s,a);case"latin1":case"binary":return D(this,s,a);case"base64":return S(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,s,a);default:if(l)throw new TypeError("Unknown encoding: "+f);f=(f+"").toLowerCase(),l=!0}}u.prototype._isBuffer=!0;function Z(f,s,a){var l=f[s];f[s]=f[a],f[a]=l}u.prototype.swap16=function(){var s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)Z(this,a,a+1);return this},u.prototype.swap32=function(){var s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)Z(this,a,a+3),Z(this,a+1,a+2);return this},u.prototype.swap64=function(){var s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)Z(this,a,a+7),Z(this,a+1,a+6),Z(this,a+2,a+5),Z(this,a+3,a+4);return this},u.prototype.toString=function(){var s=this.length;return s===0?"":arguments.length===0?M(this,0,s):O.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(s){if(!u.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:u.compare(this,s)===0},u.prototype.inspect=function(){var s="",a=r.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(s,a,l,g,E){if(B(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),!u.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(a===void 0&&(a=0),l===void 0&&(l=s?s.length:0),g===void 0&&(g=0),E===void 0&&(E=this.length),a<0||l>s.length||g<0||E>this.length)throw new RangeError("out of range index");if(g>=E&&a>=l)return 0;if(g>=E)return-1;if(a>=l)return 1;if(a>>>=0,l>>>=0,g>>>=0,E>>>=0,this===s)return 0;for(var L=E-g,X=l-a,ue=Math.min(L,X),de=this.slice(g,E),he=s.slice(a,l),ee=0;ee<ue;++ee)if(de[ee]!==he[ee]){L=de[ee],X=he[ee];break}return L<X?-1:X<L?1:0};function q(f,s,a,l,g){if(f.length===0)return-1;if(typeof a=="string"?(l=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,T(a)&&(a=g?0:f.length-1),a<0&&(a=f.length+a),a>=f.length){if(g)return-1;a=f.length-1}else if(a<0)if(g)a=0;else return-1;if(typeof s=="string"&&(s=u.from(s,l)),u.isBuffer(s))return s.length===0?-1:$(f,s,a,l,g);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?g?Uint8Array.prototype.indexOf.call(f,s,a):Uint8Array.prototype.lastIndexOf.call(f,s,a):$(f,[s],a,l,g);throw new TypeError("val must be string, number or Buffer")}function $(f,s,a,l,g){var E=1,L=f.length,X=s.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(f.length<2||s.length<2)return-1;E=2,L/=2,X/=2,a/=2}function ue(Ne,St){return E===1?Ne[St]:Ne.readUInt16BE(St*E)}var de;if(g){var he=-1;for(de=a;de<L;de++)if(ue(f,de)===ue(s,he===-1?0:de-he)){if(he===-1&&(he=de),de-he+1===X)return he*E}else he!==-1&&(de-=de-he),he=-1}else for(a+X>L&&(a=L-X),de=a;de>=0;de--){for(var ee=!0,we=0;we<X;we++)if(ue(f,de+we)!==ue(s,we)){ee=!1;break}if(ee)return de}return-1}u.prototype.includes=function(s,a,l){return this.indexOf(s,a,l)!==-1},u.prototype.indexOf=function(s,a,l){return q(this,s,a,l,!0)},u.prototype.lastIndexOf=function(s,a,l){return q(this,s,a,l,!1)};function K(f,s,a,l){a=Number(a)||0;var g=f.length-a;l?(l=Number(l),l>g&&(l=g)):l=g;var E=s.length;l>E/2&&(l=E/2);for(var L=0;L<l;++L){var X=parseInt(s.substr(L*2,2),16);if(T(X))return L;f[a+L]=X}return L}function z(f,s,a,l){return m(W(s,f.length-a),f,a,l)}function V(f,s,a,l){return m(te(s),f,a,l)}function ae(f,s,a,l){return m(b(s),f,a,l)}function _(f,s,a,l){return m(y(s,f.length-a),f,a,l)}u.prototype.write=function(s,a,l,g){if(a===void 0)g="utf8",l=this.length,a=0;else if(l===void 0&&typeof a=="string")g=a,l=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(l)?(l=l>>>0,g===void 0&&(g="utf8")):(g=l,l=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var E=this.length-a;if((l===void 0||l>E)&&(l=E),s.length>0&&(l<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");g||(g="utf8");for(var L=!1;;)switch(g){case"hex":return K(this,s,a,l);case"utf8":case"utf-8":return z(this,s,a,l);case"ascii":case"latin1":case"binary":return V(this,s,a,l);case"base64":return ae(this,s,a,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,s,a,l);default:if(L)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),L=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(f,s,a){return s===0&&a===f.length?e.fromByteArray(f):e.fromByteArray(f.slice(s,a))}function M(f,s,a){a=Math.min(f.length,a);for(var l=[],g=s;g<a;){var E=f[g],L=null,X=E>239?4:E>223?3:E>191?2:1;if(g+X<=a){var ue,de,he,ee;switch(X){case 1:E<128&&(L=E);break;case 2:ue=f[g+1],(ue&192)===128&&(ee=(E&31)<<6|ue&63,ee>127&&(L=ee));break;case 3:ue=f[g+1],de=f[g+2],(ue&192)===128&&(de&192)===128&&(ee=(E&15)<<12|(ue&63)<<6|de&63,ee>2047&&(ee<55296||ee>57343)&&(L=ee));break;case 4:ue=f[g+1],de=f[g+2],he=f[g+3],(ue&192)===128&&(de&192)===128&&(he&192)===128&&(ee=(E&15)<<18|(ue&63)<<12|(de&63)<<6|he&63,ee>65535&&ee<1114112&&(L=ee))}}L===null?(L=65533,X=1):L>65535&&(L-=65536,l.push(L>>>10&1023|55296),L=56320|L&1023),l.push(L),g+=X}return Q(l)}var H=4096;function Q(f){var s=f.length;if(s<=H)return String.fromCharCode.apply(String,f);for(var a="",l=0;l<s;)a+=String.fromCharCode.apply(String,f.slice(l,l+=H));return a}function G(f,s,a){var l="";a=Math.min(f.length,a);for(var g=s;g<a;++g)l+=String.fromCharCode(f[g]&127);return l}function D(f,s,a){var l="";a=Math.min(f.length,a);for(var g=s;g<a;++g)l+=String.fromCharCode(f[g]);return l}function re(f,s,a){var l=f.length;(!s||s<0)&&(s=0),(!a||a<0||a>l)&&(a=l);for(var g="",E=s;E<a;++E)g+=N[f[E]];return g}function ie(f,s,a){for(var l=f.slice(s,a),g="",E=0;E<l.length-1;E+=2)g+=String.fromCharCode(l[E]+l[E+1]*256);return g}u.prototype.slice=function(s,a){var l=this.length;s=~~s,a=a===void 0?l:~~a,s<0?(s+=l,s<0&&(s=0)):s>l&&(s=l),a<0?(a+=l,a<0&&(a=0)):a>l&&(a=l),a<s&&(a=s);var g=this.subarray(s,a);return Object.setPrototypeOf(g,u.prototype),g};function oe(f,s,a){if(f%1!==0||f<0)throw new RangeError("offset is not uint");if(f+s>a)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(s,a,l){s=s>>>0,a=a>>>0,l||oe(s,a,this.length);for(var g=this[s],E=1,L=0;++L<a&&(E*=256);)g+=this[s+L]*E;return g},u.prototype.readUintBE=u.prototype.readUIntBE=function(s,a,l){s=s>>>0,a=a>>>0,l||oe(s,a,this.length);for(var g=this[s+--a],E=1;a>0&&(E*=256);)g+=this[s+--a]*E;return g},u.prototype.readUint8=u.prototype.readUInt8=function(s,a){return s=s>>>0,a||oe(s,1,this.length),this[s]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(s,a){return s=s>>>0,a||oe(s,2,this.length),this[s]|this[s+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(s,a){return s=s>>>0,a||oe(s,2,this.length),this[s]<<8|this[s+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},u.prototype.readIntLE=function(s,a,l){s=s>>>0,a=a>>>0,l||oe(s,a,this.length);for(var g=this[s],E=1,L=0;++L<a&&(E*=256);)g+=this[s+L]*E;return E*=128,g>=E&&(g-=Math.pow(2,8*a)),g},u.prototype.readIntBE=function(s,a,l){s=s>>>0,a=a>>>0,l||oe(s,a,this.length);for(var g=a,E=1,L=this[s+--g];g>0&&(E*=256);)L+=this[s+--g]*E;return E*=128,L>=E&&(L-=Math.pow(2,8*a)),L},u.prototype.readInt8=function(s,a){return s=s>>>0,a||oe(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},u.prototype.readInt16LE=function(s,a){s=s>>>0,a||oe(s,2,this.length);var l=this[s]|this[s+1]<<8;return l&32768?l|4294901760:l},u.prototype.readInt16BE=function(s,a){s=s>>>0,a||oe(s,2,this.length);var l=this[s+1]|this[s]<<8;return l&32768?l|4294901760:l},u.prototype.readInt32LE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},u.prototype.readInt32BE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},u.prototype.readFloatLE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),t.read(this,s,!0,23,4)},u.prototype.readFloatBE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),t.read(this,s,!1,23,4)},u.prototype.readDoubleLE=function(s,a){return s=s>>>0,a||oe(s,8,this.length),t.read(this,s,!0,52,8)},u.prototype.readDoubleBE=function(s,a){return s=s>>>0,a||oe(s,8,this.length),t.read(this,s,!1,52,8)};function fe(f,s,a,l,g,E){if(!u.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>g||s<E)throw new RangeError('"value" argument is out of bounds');if(a+l>f.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(s,a,l,g){if(s=+s,a=a>>>0,l=l>>>0,!g){var E=Math.pow(2,8*l)-1;fe(this,s,a,l,E,0)}var L=1,X=0;for(this[a]=s&255;++X<l&&(L*=256);)this[a+X]=s/L&255;return a+l},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(s,a,l,g){if(s=+s,a=a>>>0,l=l>>>0,!g){var E=Math.pow(2,8*l)-1;fe(this,s,a,l,E,0)}var L=l-1,X=1;for(this[a+L]=s&255;--L>=0&&(X*=256);)this[a+L]=s/X&255;return a+l},u.prototype.writeUint8=u.prototype.writeUInt8=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,1,255,0),this[a]=s&255,a+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,2,65535,0),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=s&255,a+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4},u.prototype.writeIntLE=function(s,a,l,g){if(s=+s,a=a>>>0,!g){var E=Math.pow(2,8*l-1);fe(this,s,a,l,E-1,-E)}var L=0,X=1,ue=0;for(this[a]=s&255;++L<l&&(X*=256);)s<0&&ue===0&&this[a+L-1]!==0&&(ue=1),this[a+L]=(s/X>>0)-ue&255;return a+l},u.prototype.writeIntBE=function(s,a,l,g){if(s=+s,a=a>>>0,!g){var E=Math.pow(2,8*l-1);fe(this,s,a,l,E-1,-E)}var L=l-1,X=1,ue=0;for(this[a+L]=s&255;--L>=0&&(X*=256);)s<0&&ue===0&&this[a+L+1]!==0&&(ue=1),this[a+L]=(s/X>>0)-ue&255;return a+l},u.prototype.writeInt8=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=s&255,a+1},u.prototype.writeInt16LE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,2,32767,-32768),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeInt16BE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeInt32LE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,4,2147483647,-2147483648),this[a]=s&255,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},u.prototype.writeInt32BE=function(s,a,l){return s=+s,a=a>>>0,l||fe(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4};function j(f,s,a,l,g,E){if(a+l>f.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function p(f,s,a,l,g){return s=+s,a=a>>>0,g||j(f,s,a,4),t.write(f,s,a,l,23,4),a+4}u.prototype.writeFloatLE=function(s,a,l){return p(this,s,a,!0,l)},u.prototype.writeFloatBE=function(s,a,l){return p(this,s,a,!1,l)};function Y(f,s,a,l,g){return s=+s,a=a>>>0,g||j(f,s,a,8),t.write(f,s,a,l,52,8),a+8}u.prototype.writeDoubleLE=function(s,a,l){return Y(this,s,a,!0,l)},u.prototype.writeDoubleBE=function(s,a,l){return Y(this,s,a,!1,l)},u.prototype.copy=function(s,a,l,g){if(!u.isBuffer(s))throw new TypeError("argument should be a Buffer");if(l||(l=0),!g&&g!==0&&(g=this.length),a>=s.length&&(a=s.length),a||(a=0),g>0&&g<l&&(g=l),g===l||s.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),s.length-a<g-l&&(g=s.length-a+l);var E=g-l;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,l,g):Uint8Array.prototype.set.call(s,this.subarray(l,g),a),E},u.prototype.fill=function(s,a,l,g){if(typeof s=="string"){if(typeof a=="string"?(g=a,a=0,l=this.length):typeof l=="string"&&(g=l,l=this.length),g!==void 0&&typeof g!="string")throw new TypeError("encoding must be a string");if(typeof g=="string"&&!u.isEncoding(g))throw new TypeError("Unknown encoding: "+g);if(s.length===1){var E=s.charCodeAt(0);(g==="utf8"&&E<128||g==="latin1")&&(s=E)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(a<0||this.length<a||this.length<l)throw new RangeError("Out of range index");if(l<=a)return this;a=a>>>0,l=l===void 0?this.length:l>>>0,s||(s=0);var L;if(typeof s=="number")for(L=a;L<l;++L)this[L]=s;else{var X=u.isBuffer(s)?s:u.from(s,g),ue=X.length;if(ue===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(L=0;L<l-a;++L)this[L+a]=X[L%ue]}return this};var ne=/[^+/0-9A-Za-z-_]/g;function se(f){if(f=f.split("=")[0],f=f.trim().replace(ne,""),f.length<2)return"";for(;f.length%4!==0;)f=f+"=";return f}function W(f,s){s=s||1/0;for(var a,l=f.length,g=null,E=[],L=0;L<l;++L){if(a=f.charCodeAt(L),a>55295&&a<57344){if(!g){if(a>56319){(s-=3)>-1&&E.push(239,191,189);continue}else if(L+1===l){(s-=3)>-1&&E.push(239,191,189);continue}g=a;continue}if(a<56320){(s-=3)>-1&&E.push(239,191,189),g=a;continue}a=(g-55296<<10|a-56320)+65536}else g&&(s-=3)>-1&&E.push(239,191,189);if(g=null,a<128){if((s-=1)<0)break;E.push(a)}else if(a<2048){if((s-=2)<0)break;E.push(a>>6|192,a&63|128)}else if(a<65536){if((s-=3)<0)break;E.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((s-=4)<0)break;E.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return E}function te(f){for(var s=[],a=0;a<f.length;++a)s.push(f.charCodeAt(a)&255);return s}function y(f,s){for(var a,l,g,E=[],L=0;L<f.length&&!((s-=2)<0);++L)a=f.charCodeAt(L),l=a>>8,g=a%256,E.push(g),E.push(l);return E}function b(f){return e.toByteArray(se(f))}function m(f,s,a,l){for(var g=0;g<l&&!(g+a>=s.length||g>=f.length);++g)s[g+a]=f[g];return g}function B(f,s){return f instanceof s||f!=null&&f.constructor!=null&&f.constructor.name!=null&&f.constructor.name===s.name}function T(f){return f!==f}var N=function(){for(var f="0123456789abcdef",s=new Array(256),a=0;a<16;++a)for(var l=a*16,g=0;g<16;++g)s[l+g]=f[a]+f[g];return s}()})(bn);var Po={exports:{}};(function(r){(function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,c="[BigNumber Error] ",u=c+"Number primitive has more than 15 significant digits: ",h=1e14,w=14,x=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],A=1e7,d=1e9;function U(q){var $,K,z,V=p.prototype={constructor:p,toString:null,valueOf:null},ae=new p(1),_=20,S=4,M=-7,H=21,Q=-1e7,G=1e7,D=!1,re=1,ie=0,oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},fe="0123456789abcdefghijklmnopqrstuvwxyz",j=!0;function p(y,b){var m,B,T,N,f,s,a,l,g=this;if(!(g instanceof p))return new p(y,b);if(b==null){if(y&&y._isBigNumber===!0){g.s=y.s,!y.c||y.e>G?g.c=g.e=null:y.e<Q?g.c=[g.e=0]:(g.e=y.e,g.c=y.c.slice());return}if((s=typeof y=="number")&&y*0==0){if(g.s=1/y<0?(y=-y,-1):1,y===~~y){for(N=0,f=y;f>=10;f/=10,N++);N>G?g.c=g.e=null:(g.e=N,g.c=[y]);return}l=String(y)}else{if(!n.test(l=String(y)))return z(g,l,s);g.s=l.charCodeAt(0)==45?(l=l.slice(1),-1):1}(N=l.indexOf("."))>-1&&(l=l.replace(".","")),(f=l.search(/e/i))>0?(N<0&&(N=f),N+=+l.slice(f+1),l=l.substring(0,f)):N<0&&(N=l.length)}else{if(C(b,2,fe.length,"Base"),b==10&&j)return g=new p(y),W(g,_+g.e+1,S);if(l=String(y),s=typeof y=="number"){if(y*0!=0)return z(g,l,s,b);if(g.s=1/y<0?(l=l.slice(1),-1):1,p.DEBUG&&l.replace(/^0\.0*|\./,"").length>15)throw Error(u+y)}else g.s=l.charCodeAt(0)===45?(l=l.slice(1),-1):1;for(m=fe.slice(0,b),N=f=0,a=l.length;f<a;f++)if(m.indexOf(B=l.charAt(f))<0){if(B=="."){if(f>N){N=a;continue}}else if(!T&&(l==l.toUpperCase()&&(l=l.toLowerCase())||l==l.toLowerCase()&&(l=l.toUpperCase()))){T=!0,f=-1,N=0;continue}return z(g,String(y),s,b)}s=!1,l=K(l,b,10,g.s),(N=l.indexOf("."))>-1?l=l.replace(".",""):N=l.length}for(f=0;l.charCodeAt(f)===48;f++);for(a=l.length;l.charCodeAt(--a)===48;);if(l=l.slice(f,++a)){if(a-=f,s&&p.DEBUG&&a>15&&(y>x||y!==o(y)))throw Error(u+g.s*y);if((N=N-f-1)>G)g.c=g.e=null;else if(N<Q)g.c=[g.e=0];else{if(g.e=N,g.c=[],f=(N+1)%w,N<0&&(f+=w),f<a){for(f&&g.c.push(+l.slice(0,f)),a-=w;f<a;)g.c.push(+l.slice(f,f+=w));f=w-(l=l.slice(f)).length}else f-=a;for(;f--;l+="0");g.c.push(+l)}}else g.c=[g.e=0]}p.clone=U,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(y){var b,m;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(b="DECIMAL_PLACES")&&(m=y[b],C(m,0,d,b),_=m),y.hasOwnProperty(b="ROUNDING_MODE")&&(m=y[b],C(m,0,8,b),S=m),y.hasOwnProperty(b="EXPONENTIAL_AT")&&(m=y[b],m&&m.pop?(C(m[0],-1e9,0,b),C(m[1],0,d,b),M=m[0],H=m[1]):(C(m,-1e9,d,b),M=-(H=m<0?-m:m))),y.hasOwnProperty(b="RANGE"))if(m=y[b],m&&m.pop)C(m[0],-1e9,-1,b),C(m[1],1,d,b),Q=m[0],G=m[1];else if(C(m,-1e9,d,b),m)Q=-(G=m<0?-m:m);else throw Error(c+b+" cannot be zero: "+m);if(y.hasOwnProperty(b="CRYPTO"))if(m=y[b],m===!!m)if(m)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))D=m;else throw D=!m,Error(c+"crypto unavailable");else D=m;else throw Error(c+b+" not true or false: "+m);if(y.hasOwnProperty(b="MODULO_MODE")&&(m=y[b],C(m,0,9,b),re=m),y.hasOwnProperty(b="POW_PRECISION")&&(m=y[b],C(m,0,d,b),ie=m),y.hasOwnProperty(b="FORMAT"))if(m=y[b],typeof m=="object")oe=m;else throw Error(c+b+" not an object: "+m);if(y.hasOwnProperty(b="ALPHABET"))if(m=y[b],typeof m=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(m))j=m.slice(0,10)=="0123456789",fe=m;else throw Error(c+b+" invalid: "+m)}else throw Error(c+"Object expected: "+y);return{DECIMAL_PLACES:_,ROUNDING_MODE:S,EXPONENTIAL_AT:[M,H],RANGE:[Q,G],CRYPTO:D,MODULO_MODE:re,POW_PRECISION:ie,FORMAT:oe,ALPHABET:fe}},p.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var b,m,B=y.c,T=y.e,N=y.s;e:if({}.toString.call(B)=="[object Array]"){if((N===1||N===-1)&&T>=-1e9&&T<=d&&T===o(T)){if(B[0]===0){if(T===0&&B.length===1)return!0;break e}if(b=(T+1)%w,b<1&&(b+=w),String(B[0]).length==b){for(b=0;b<B.length;b++)if(m=B[b],m<0||m>=h||m!==o(m))break e;if(m!==0)return!0}}}else if(B===null&&T===null&&(N===null||N===1||N===-1))return!0;throw Error(c+"Invalid BigNumber: "+y)},p.maximum=p.max=function(){return ne(arguments,-1)},p.minimum=p.min=function(){return ne(arguments,1)},p.random=function(){var y=9007199254740992,b=Math.random()*y&2097151?function(){return o(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(m){var B,T,N,f,s,a=0,l=[],g=new p(ae);if(m==null?m=_:C(m,0,d),f=i(m/w),D)if(crypto.getRandomValues){for(B=crypto.getRandomValues(new Uint32Array(f*=2));a<f;)s=B[a]*131072+(B[a+1]>>>11),s>=9e15?(T=crypto.getRandomValues(new Uint32Array(2)),B[a]=T[0],B[a+1]=T[1]):(l.push(s%1e14),a+=2);a=f/2}else if(crypto.randomBytes){for(B=crypto.randomBytes(f*=7);a<f;)s=(B[a]&31)*281474976710656+B[a+1]*1099511627776+B[a+2]*4294967296+B[a+3]*16777216+(B[a+4]<<16)+(B[a+5]<<8)+B[a+6],s>=9e15?crypto.randomBytes(7).copy(B,a):(l.push(s%1e14),a+=7);a=f/7}else throw D=!1,Error(c+"crypto unavailable");if(!D)for(;a<f;)s=b(),s<9e15&&(l[a++]=s%1e14);for(f=l[--a],m%=w,f&&m&&(s=v[w-m],l[a]=o(f/s)*s);l[a]===0;l.pop(),a--);if(a<0)l=[N=0];else{for(N=-1;l[0]===0;l.splice(0,1),N-=w);for(a=1,s=l[0];s>=10;s/=10,a++);a<w&&(N-=w-a)}return g.e=N,g.c=l,g}}(),p.sum=function(){for(var y=1,b=arguments,m=new p(b[0]);y<b.length;)m=m.plus(b[y++]);return m},K=function(){var y="0123456789";function b(m,B,T,N){for(var f,s=[0],a,l=0,g=m.length;l<g;){for(a=s.length;a--;s[a]*=B);for(s[0]+=N.indexOf(m.charAt(l++)),f=0;f<s.length;f++)s[f]>T-1&&(s[f+1]==null&&(s[f+1]=0),s[f+1]+=s[f]/T|0,s[f]%=T)}return s.reverse()}return function(m,B,T,N,f){var s,a,l,g,E,L,X,ue,de=m.indexOf("."),he=_,ee=S;for(de>=0&&(g=ie,ie=0,m=m.replace(".",""),ue=new p(B),L=ue.pow(m.length-de),ie=g,ue.c=b(Z(R(L.c),L.e,"0"),10,T,y),ue.e=ue.c.length),X=b(m,B,T,f?(s=fe,y):(s=y,fe)),l=g=X.length;X[--g]==0;X.pop());if(!X[0])return s.charAt(0);if(de<0?--l:(L.c=X,L.e=l,L.s=N,L=$(L,ue,he,ee,T),X=L.c,E=L.r,l=L.e),a=l+he+1,de=X[a],g=T/2,E=E||a<0||X[a+1]!=null,E=ee<4?(de!=null||E)&&(ee==0||ee==(L.s<0?3:2)):de>g||de==g&&(ee==4||E||ee==6&&X[a-1]&1||ee==(L.s<0?8:7)),a<1||!X[0])m=E?Z(s.charAt(1),-he,s.charAt(0)):s.charAt(0);else{if(X.length=a,E)for(--T;++X[--a]>T;)X[a]=0,a||(++l,X=[1].concat(X));for(g=X.length;!X[--g];);for(de=0,m="";de<=g;m+=s.charAt(X[de++]));m=Z(m,l,s.charAt(0))}return m}}(),$=function(){function y(B,T,N){var f,s,a,l,g=0,E=B.length,L=T%A,X=T/A|0;for(B=B.slice();E--;)a=B[E]%A,l=B[E]/A|0,f=X*a+l*L,s=L*a+f%A*A+g,g=(s/N|0)+(f/A|0)+X*l,B[E]=s%N;return g&&(B=[g].concat(B)),B}function b(B,T,N,f){var s,a;if(N!=f)a=N>f?1:-1;else for(s=a=0;s<N;s++)if(B[s]!=T[s]){a=B[s]>T[s]?1:-1;break}return a}function m(B,T,N,f){for(var s=0;N--;)B[N]-=s,s=B[N]<T[N]?1:0,B[N]=s*f+B[N]-T[N];for(;!B[0]&&B.length>1;B.splice(0,1));}return function(B,T,N,f,s){var a,l,g,E,L,X,ue,de,he,ee,we,Ne,St,Kr,jr,ge,ir,rt=B.s==T.s?1:-1,He=B.c,Ae=T.c;if(!He||!He[0]||!Ae||!Ae[0])return new p(!B.s||!T.s||(He?Ae&&He[0]==Ae[0]:!Ae)?NaN:He&&He[0]==0||!Ae?rt*0:rt/0);for(de=new p(rt),he=de.c=[],l=B.e-T.e,rt=N+l+1,s||(s=h,l=P(B.e/w)-P(T.e/w),rt=rt/w|0),g=0;Ae[g]==(He[g]||0);g++);if(Ae[g]>(He[g]||0)&&l--,rt<0)he.push(1),E=!0;else{for(Kr=He.length,ge=Ae.length,g=0,rt+=2,L=o(s/(Ae[0]+1)),L>1&&(Ae=y(Ae,L,s),He=y(He,L,s),ge=Ae.length,Kr=He.length),St=ge,ee=He.slice(0,ge),we=ee.length;we<ge;ee[we++]=0);ir=Ae.slice(),ir=[0].concat(ir),jr=Ae[0],Ae[1]>=s/2&&jr++;do{if(L=0,a=b(Ae,ee,ge,we),a<0){if(Ne=ee[0],ge!=we&&(Ne=Ne*s+(ee[1]||0)),L=o(Ne/jr),L>1)for(L>=s&&(L=s-1),X=y(Ae,L,s),ue=X.length,we=ee.length;b(X,ee,ue,we)==1;)L--,m(X,ge<ue?ir:Ae,ue,s),ue=X.length,a=1;else L==0&&(a=L=1),X=Ae.slice(),ue=X.length;if(ue<we&&(X=[0].concat(X)),m(ee,X,we,s),we=ee.length,a==-1)for(;b(Ae,ee,ge,we)<1;)L++,m(ee,ge<we?ir:Ae,we,s),we=ee.length}else a===0&&(L++,ee=[0]);he[g++]=L,ee[0]?ee[we++]=He[St]||0:(ee=[He[St]],we=1)}while((St++<Kr||ee[0]!=null)&&rt--);E=ee[0]!=null,he[0]||he.splice(0,1)}if(s==h){for(g=1,rt=he[0];rt>=10;rt/=10,g++);W(de,N+(de.e=g+l*w-1)+1,f,E)}else de.e=l,de.r=+E;return de}}();function Y(y,b,m,B){var T,N,f,s,a;if(m==null?m=S:C(m,0,8),!y.c)return y.toString();if(T=y.c[0],f=y.e,b==null)a=R(y.c),a=B==1||B==2&&(f<=M||f>=H)?O(a,f):Z(a,f,"0");else if(y=W(new p(y),b,m),N=y.e,a=R(y.c),s=a.length,B==1||B==2&&(b<=N||N<=M)){for(;s<b;a+="0",s++);a=O(a,N)}else if(b-=f,a=Z(a,N,"0"),N+1>s){if(--b>0)for(a+=".";b--;a+="0");}else if(b+=N-s,b>0)for(N+1==s&&(a+=".");b--;a+="0");return y.s<0&&T?"-"+a:a}function ne(y,b){for(var m,B,T=1,N=new p(y[0]);T<y.length;T++)B=new p(y[T]),(!B.s||(m=k(N,B))===b||m===0&&N.s===b)&&(N=B);return N}function se(y,b,m){for(var B=1,T=b.length;!b[--T];b.pop());for(T=b[0];T>=10;T/=10,B++);return(m=B+m*w-1)>G?y.c=y.e=null:m<Q?y.c=[y.e=0]:(y.e=m,y.c=b),y}z=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,m=/^\.([^.]+)$/,B=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,f,s,a){var l,g=s?f:f.replace(T,"");if(B.test(g))N.s=isNaN(g)?null:g<0?-1:1;else{if(!s&&(g=g.replace(y,function(E,L,X){return l=(X=X.toLowerCase())=="x"?16:X=="b"?2:8,!a||a==l?L:E}),a&&(l=a,g=g.replace(b,"$1").replace(m,"0.$1")),f!=g))return new p(g,l);if(p.DEBUG)throw Error(c+"Not a"+(a?" base "+a:"")+" number: "+f);N.s=null}N.c=N.e=null}}();function W(y,b,m,B){var T,N,f,s,a,l,g,E=y.c,L=v;if(E){e:{for(T=1,s=E[0];s>=10;s/=10,T++);if(N=b-T,N<0)N+=w,f=b,a=E[l=0],g=o(a/L[T-f-1]%10);else if(l=i((N+1)/w),l>=E.length)if(B){for(;E.length<=l;E.push(0));a=g=0,T=1,N%=w,f=N-w+1}else break e;else{for(a=s=E[l],T=1;s>=10;s/=10,T++);N%=w,f=N-w+T,g=f<0?0:o(a/L[T-f-1]%10)}if(B=B||b<0||E[l+1]!=null||(f<0?a:a%L[T-f-1]),B=m<4?(g||B)&&(m==0||m==(y.s<0?3:2)):g>5||g==5&&(m==4||B||m==6&&(N>0?f>0?a/L[T-f]:0:E[l-1])%10&1||m==(y.s<0?8:7)),b<1||!E[0])return E.length=0,B?(b-=y.e+1,E[0]=L[(w-b%w)%w],y.e=-b||0):E[0]=y.e=0,y;if(N==0?(E.length=l,s=1,l--):(E.length=l+1,s=L[w-N],E[l]=f>0?o(a/L[T-f]%L[f])*s:0),B)for(;;)if(l==0){for(N=1,f=E[0];f>=10;f/=10,N++);for(f=E[0]+=s,s=1;f>=10;f/=10,s++);N!=s&&(y.e++,E[0]==h&&(E[0]=1));break}else{if(E[l]+=s,E[l]!=h)break;E[l--]=0,s=1}for(N=E.length;E[--N]===0;E.pop());}y.e>G?y.c=y.e=null:y.e<Q&&(y.c=[y.e=0])}return y}function te(y){var b,m=y.e;return m===null?y.toString():(b=R(y.c),b=m<=M||m>=H?O(b,m):Z(b,m,"0"),y.s<0?"-"+b:b)}return V.absoluteValue=V.abs=function(){var y=new p(this);return y.s<0&&(y.s=1),y},V.comparedTo=function(y,b){return k(this,new p(y,b))},V.decimalPlaces=V.dp=function(y,b){var m,B,T,N=this;if(y!=null)return C(y,0,d),b==null?b=S:C(b,0,8),W(new p(N),y+N.e+1,b);if(!(m=N.c))return null;if(B=((T=m.length-1)-P(this.e/w))*w,T=m[T])for(;T%10==0;T/=10,B--);return B<0&&(B=0),B},V.dividedBy=V.div=function(y,b){return $(this,new p(y,b),_,S)},V.dividedToIntegerBy=V.idiv=function(y,b){return $(this,new p(y,b),0,1)},V.exponentiatedBy=V.pow=function(y,b){var m,B,T,N,f,s,a,l,g,E=this;if(y=new p(y),y.c&&!y.isInteger())throw Error(c+"Exponent not an integer: "+te(y));if(b!=null&&(b=new p(b)),s=y.e>14,!E.c||!E.c[0]||E.c[0]==1&&!E.e&&E.c.length==1||!y.c||!y.c[0])return g=new p(Math.pow(+te(E),s?y.s*(2-F(y)):+te(y))),b?g.mod(b):g;if(a=y.s<0,b){if(b.c?!b.c[0]:!b.s)return new p(NaN);B=!a&&E.isInteger()&&b.isInteger(),B&&(E=E.mod(b))}else{if(y.e>9&&(E.e>0||E.e<-1||(E.e==0?E.c[0]>1||s&&E.c[1]>=24e7:E.c[0]<8e13||s&&E.c[0]<=9999975e7)))return N=E.s<0&&F(y)?-0:0,E.e>-1&&(N=1/N),new p(a?1/N:N);ie&&(N=i(ie/w+2))}for(s?(m=new p(.5),a&&(y.s=1),l=F(y)):(T=Math.abs(+te(y)),l=T%2),g=new p(ae);;){if(l){if(g=g.times(E),!g.c)break;N?g.c.length>N&&(g.c.length=N):B&&(g=g.mod(b))}if(T){if(T=o(T/2),T===0)break;l=T%2}else if(y=y.times(m),W(y,y.e+1,1),y.e>14)l=F(y);else{if(T=+te(y),T===0)break;l=T%2}E=E.times(E),N?E.c&&E.c.length>N&&(E.c.length=N):B&&(E=E.mod(b))}return B?g:(a&&(g=ae.div(g)),b?g.mod(b):N?W(g,ie,S,f):g)},V.integerValue=function(y){var b=new p(this);return y==null?y=S:C(y,0,8),W(b,b.e+1,y)},V.isEqualTo=V.eq=function(y,b){return k(this,new p(y,b))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(y,b){return k(this,new p(y,b))>0},V.isGreaterThanOrEqualTo=V.gte=function(y,b){return(b=k(this,new p(y,b)))===1||b===0},V.isInteger=function(){return!!this.c&&P(this.e/w)>this.c.length-2},V.isLessThan=V.lt=function(y,b){return k(this,new p(y,b))<0},V.isLessThanOrEqualTo=V.lte=function(y,b){return(b=k(this,new p(y,b)))===-1||b===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(y,b){var m,B,T,N,f=this,s=f.s;if(y=new p(y,b),b=y.s,!s||!b)return new p(NaN);if(s!=b)return y.s=-b,f.plus(y);var a=f.e/w,l=y.e/w,g=f.c,E=y.c;if(!a||!l){if(!g||!E)return g?(y.s=-b,y):new p(E?f:NaN);if(!g[0]||!E[0])return E[0]?(y.s=-b,y):new p(g[0]?f:S==3?-0:0)}if(a=P(a),l=P(l),g=g.slice(),s=a-l){for((N=s<0)?(s=-s,T=g):(l=a,T=E),T.reverse(),b=s;b--;T.push(0));T.reverse()}else for(B=(N=(s=g.length)<(b=E.length))?s:b,s=b=0;b<B;b++)if(g[b]!=E[b]){N=g[b]<E[b];break}if(N&&(T=g,g=E,E=T,y.s=-y.s),b=(B=E.length)-(m=g.length),b>0)for(;b--;g[m++]=0);for(b=h-1;B>s;){if(g[--B]<E[B]){for(m=B;m&&!g[--m];g[m]=b);--g[m],g[B]+=h}g[B]-=E[B]}for(;g[0]==0;g.splice(0,1),--l);return g[0]?se(y,g,l):(y.s=S==3?-1:1,y.c=[y.e=0],y)},V.modulo=V.mod=function(y,b){var m,B,T=this;return y=new p(y,b),!T.c||!y.s||y.c&&!y.c[0]?new p(NaN):!y.c||T.c&&!T.c[0]?new p(T):(re==9?(B=y.s,y.s=1,m=$(T,y,0,3),y.s=B,m.s*=B):m=$(T,y,0,re),y=T.minus(m.times(y)),!y.c[0]&&re==1&&(y.s=T.s),y)},V.multipliedBy=V.times=function(y,b){var m,B,T,N,f,s,a,l,g,E,L,X,ue,de,he,ee=this,we=ee.c,Ne=(y=new p(y,b)).c;if(!we||!Ne||!we[0]||!Ne[0])return!ee.s||!y.s||we&&!we[0]&&!Ne||Ne&&!Ne[0]&&!we?y.c=y.e=y.s=null:(y.s*=ee.s,!we||!Ne?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(B=P(ee.e/w)+P(y.e/w),y.s*=ee.s,a=we.length,E=Ne.length,a<E&&(ue=we,we=Ne,Ne=ue,T=a,a=E,E=T),T=a+E,ue=[];T--;ue.push(0));for(de=h,he=A,T=E;--T>=0;){for(m=0,L=Ne[T]%he,X=Ne[T]/he|0,f=a,N=T+f;N>T;)l=we[--f]%he,g=we[f]/he|0,s=X*l+g*L,l=L*l+s%he*he+ue[N]+m,m=(l/de|0)+(s/he|0)+X*g,ue[N--]=l%de;ue[N]=m}return m?++B:ue.splice(0,1),se(y,ue,B)},V.negated=function(){var y=new p(this);return y.s=-y.s||null,y},V.plus=function(y,b){var m,B=this,T=B.s;if(y=new p(y,b),b=y.s,!T||!b)return new p(NaN);if(T!=b)return y.s=-b,B.minus(y);var N=B.e/w,f=y.e/w,s=B.c,a=y.c;if(!N||!f){if(!s||!a)return new p(T/0);if(!s[0]||!a[0])return a[0]?y:new p(s[0]?B:T*0)}if(N=P(N),f=P(f),s=s.slice(),T=N-f){for(T>0?(f=N,m=a):(T=-T,m=s),m.reverse();T--;m.push(0));m.reverse()}for(T=s.length,b=a.length,T-b<0&&(m=a,a=s,s=m,b=T),T=0;b;)T=(s[--b]=s[b]+a[b]+T)/h|0,s[b]=h===s[b]?0:s[b]%h;return T&&(s=[T].concat(s),++f),se(y,s,f)},V.precision=V.sd=function(y,b){var m,B,T,N=this;if(y!=null&&y!==!!y)return C(y,1,d),b==null?b=S:C(b,0,8),W(new p(N),y,b);if(!(m=N.c))return null;if(T=m.length-1,B=T*w+1,T=m[T]){for(;T%10==0;T/=10,B--);for(T=m[0];T>=10;T/=10,B++);}return y&&N.e+1>B&&(B=N.e+1),B},V.shiftedBy=function(y){return C(y,-9007199254740991,x),this.times("1e"+y)},V.squareRoot=V.sqrt=function(){var y,b,m,B,T,N=this,f=N.c,s=N.s,a=N.e,l=_+4,g=new p("0.5");if(s!==1||!f||!f[0])return new p(!s||s<0&&(!f||f[0])?NaN:f?N:1/0);if(s=Math.sqrt(+te(N)),s==0||s==1/0?(b=R(f),(b.length+a)%2==0&&(b+="0"),s=Math.sqrt(+b),a=P((a+1)/2)-(a<0||a%2),s==1/0?b="5e"+a:(b=s.toExponential(),b=b.slice(0,b.indexOf("e")+1)+a),m=new p(b)):m=new p(s+""),m.c[0]){for(a=m.e,s=a+l,s<3&&(s=0);;)if(T=m,m=g.times(T.plus($(N,T,l,1))),R(T.c).slice(0,s)===(b=R(m.c)).slice(0,s))if(m.e<a&&--s,b=b.slice(s-3,s+1),b=="9999"||!B&&b=="4999"){if(!B&&(W(T,T.e+_+2,0),T.times(T).eq(N))){m=T;break}l+=4,s+=4,B=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(W(m,m.e+_+2,1),y=!m.times(m).eq(N));break}}return W(m,m.e+_+1,S,y)},V.toExponential=function(y,b){return y!=null&&(C(y,0,d),y++),Y(this,y,b,1)},V.toFixed=function(y,b){return y!=null&&(C(y,0,d),y=y+this.e+1),Y(this,y,b)},V.toFormat=function(y,b,m){var B,T=this;if(m==null)y!=null&&b&&typeof b=="object"?(m=b,b=null):y&&typeof y=="object"?(m=y,y=b=null):m=oe;else if(typeof m!="object")throw Error(c+"Argument not an object: "+m);if(B=T.toFixed(y,b),T.c){var N,f=B.split("."),s=+m.groupSize,a=+m.secondaryGroupSize,l=m.groupSeparator||"",g=f[0],E=f[1],L=T.s<0,X=L?g.slice(1):g,ue=X.length;if(a&&(N=s,s=a,a=N,ue-=N),s>0&&ue>0){for(N=ue%s||s,g=X.substr(0,N);N<ue;N+=s)g+=l+X.substr(N,s);a>0&&(g+=l+X.slice(N)),L&&(g="-"+g)}B=E?g+(m.decimalSeparator||"")+((a=+m.fractionGroupSize)?E.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(m.fractionGroupSeparator||"")):E):g}return(m.prefix||"")+B+(m.suffix||"")},V.toFraction=function(y){var b,m,B,T,N,f,s,a,l,g,E,L,X=this,ue=X.c;if(y!=null&&(s=new p(y),!s.isInteger()&&(s.c||s.s!==1)||s.lt(ae)))throw Error(c+"Argument "+(s.isInteger()?"out of range: ":"not an integer: ")+te(s));if(!ue)return new p(X);for(b=new p(ae),l=m=new p(ae),B=a=new p(ae),L=R(ue),N=b.e=L.length-X.e-1,b.c[0]=v[(f=N%w)<0?w+f:f],y=!y||s.comparedTo(b)>0?N>0?b:l:s,f=G,G=1/0,s=new p(L),a.c[0]=0;g=$(s,b,0,1),T=m.plus(g.times(B)),T.comparedTo(y)!=1;)m=B,B=T,l=a.plus(g.times(T=l)),a=T,b=s.minus(g.times(T=b)),s=T;return T=$(y.minus(m),B,0,1),a=a.plus(T.times(l)),m=m.plus(T.times(B)),a.s=l.s=X.s,N=N*2,E=$(l,B,N,S).minus(X).abs().comparedTo($(a,m,N,S).minus(X).abs())<1?[l,B]:[a,m],G=f,E},V.toNumber=function(){return+te(this)},V.toPrecision=function(y,b){return y!=null&&C(y,1,d),Y(this,y,b,2)},V.toString=function(y){var b,m=this,B=m.s,T=m.e;return T===null?B?(b="Infinity",B<0&&(b="-"+b)):b="NaN":(y==null?b=T<=M||T>=H?O(R(m.c),T):Z(R(m.c),T,"0"):y===10&&j?(m=W(new p(m),_+T+1,S),b=Z(R(m.c),m.e,"0")):(C(y,2,fe.length,"Base"),b=K(Z(R(m.c),T,"0"),10,y,B,!0)),B<0&&m.c[0]&&(b="-"+b)),b},V.valueOf=V.toJSON=function(){return te(this)},V._isBigNumber=!0,q!=null&&p.set(q),p}function P(q){var $=q|0;return q>0||q===$?$:$-1}function R(q){for(var $,K,z=1,V=q.length,ae=q[0]+"";z<V;){for($=q[z++]+"",K=w-$.length;K--;$="0"+$);ae+=$}for(V=ae.length;ae.charCodeAt(--V)===48;);return ae.slice(0,V+1||1)}function k(q,$){var K,z,V=q.c,ae=$.c,_=q.s,S=$.s,M=q.e,H=$.e;if(!_||!S)return null;if(K=V&&!V[0],z=ae&&!ae[0],K||z)return K?z?0:-S:_;if(_!=S)return _;if(K=_<0,z=M==H,!V||!ae)return z?0:!V^K?1:-1;if(!z)return M>H^K?1:-1;for(S=(M=V.length)<(H=ae.length)?M:H,_=0;_<S;_++)if(V[_]!=ae[_])return V[_]>ae[_]^K?1:-1;return M==H?0:M>H^K?1:-1}function C(q,$,K,z){if(q<$||q>K||q!==o(q))throw Error(c+(z||"Argument")+(typeof q=="number"?q<$||q>K?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function F(q){var $=q.c.length-1;return P(q.e/w)==$&&q.c[$]%2!=0}function O(q,$){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+($<0?"e":"e+")+$}function Z(q,$,K){var z,V;if($<0){for(V=K+".";++$;V+=K);q=V+q}else if(z=q.length,++$>z){for(V=K,$-=z;--$;V+=K);q+=V}else $<z&&(q=q.slice(0,$)+"."+q.slice($));return q}t=U(),t.default=t.BigNumber=t,r.exports?r.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(Dr)})(Po);var Ei=Po.exports,ef=function(e,t,n){var i=new e.Uint8Array(n),o=t.pushInt,c=t.pushInt32,u=t.pushInt32Neg,h=t.pushInt64,w=t.pushInt64Neg,x=t.pushFloat,v=t.pushFloatSingle,A=t.pushFloatDouble,d=t.pushTrue,U=t.pushFalse,P=t.pushUndefined,R=t.pushNull,k=t.pushInfinity,C=t.pushInfinityNeg,F=t.pushNaN,O=t.pushNaNNeg,Z=t.pushArrayStart,q=t.pushArrayStartFixed,$=t.pushArrayStartFixed32,K=t.pushArrayStartFixed64,z=t.pushObjectStart,V=t.pushObjectStartFixed,ae=t.pushObjectStartFixed32,_=t.pushObjectStartFixed64,S=t.pushByteString,M=t.pushByteStringStart,H=t.pushUtf8String,Q=t.pushUtf8StringStart,G=t.pushSimpleUnassigned,D=t.pushTagStart,re=t.pushTagStart4,ie=t.pushTagStart8,oe=t.pushTagUnassigned,fe=t.pushBreak,j=e.Math.pow,p=0,Y=0,ne=0;function se(I){for(I=I|0,p=0,Y=I;(p|0)<(Y|0)&&(ne=iu[i[p]&255](i[p]|0)|0,!((ne|0)>0)););return ne|0}function W(I){return I=I|0,((p|0)+(I|0)|0)<(Y|0)?0:1}function te(I){return I=I|0,i[I|0]<<8|i[I+1|0]|0}function y(I){return I=I|0,i[I|0]<<24|i[I+1|0]<<16|i[I+2|0]<<8|i[I+3|0]|0}function b(I){return I=I|0,o(I|0),p=p+1|0,0}function m(I){return I=I|0,W(1)|0?1:(o(i[p+1|0]|0),p=p+2|0,0)}function B(I){return I=I|0,W(2)|0?1:(o(te(p+1|0)|0),p=p+3|0,0)}function T(I){return I=I|0,W(4)|0?1:(c(te(p+1|0)|0,te(p+3|0)|0),p=p+5|0,0)}function N(I){return I=I|0,W(8)|0?1:(h(te(p+1|0)|0,te(p+3|0)|0,te(p+5|0)|0,te(p+7|0)|0),p=p+9|0,0)}function f(I){return I=I|0,o(-1-(I-32|0)|0),p=p+1|0,0}function s(I){return I=I|0,W(1)|0?1:(o(-1-(i[p+1|0]|0)|0),p=p+2|0,0)}function a(I){I=I|0;var be=0;return W(2)|0?1:(be=te(p+1|0)|0,o(-1-(be|0)|0),p=p+3|0,0)}function l(I){return I=I|0,W(4)|0?1:(u(te(p+1|0)|0,te(p+3|0)|0),p=p+5|0,0)}function g(I){return I=I|0,W(8)|0?1:(w(te(p+1|0)|0,te(p+3|0)|0,te(p+5|0)|0,te(p+7|0)|0),p=p+9|0,0)}function E(I){I=I|0;var be=0,me=0,pe=0;return pe=I-64|0,W(pe|0)|0?1:(be=p+1|0,me=(p+1|0)+(pe|0)|0,S(be|0,me|0),p=me|0,0)}function L(I){I=I|0;var be=0,me=0,pe=0;return W(1)|0||(pe=i[p+1|0]|0,be=p+2|0,me=(p+2|0)+(pe|0)|0,W(pe+1|0)|0)?1:(S(be|0,me|0),p=me|0,0)}function X(I){I=I|0;var be=0,me=0,pe=0;return W(2)|0||(pe=te(p+1|0)|0,be=p+3|0,me=(p+3|0)+(pe|0)|0,W(pe+2|0)|0)?1:(S(be|0,me|0),p=me|0,0)}function ue(I){I=I|0;var be=0,me=0,pe=0;return W(4)|0||(pe=y(p+1|0)|0,be=p+5|0,me=(p+5|0)+(pe|0)|0,W(pe+4|0)|0)?1:(S(be|0,me|0),p=me|0,0)}function de(I){return I=I|0,1}function he(I){return I=I|0,M(),p=p+1|0,0}function ee(I){I=I|0;var be=0,me=0,pe=0;return pe=I-96|0,W(pe|0)|0?1:(be=p+1|0,me=(p+1|0)+(pe|0)|0,H(be|0,me|0),p=me|0,0)}function we(I){I=I|0;var be=0,me=0,pe=0;return W(1)|0||(pe=i[p+1|0]|0,be=p+2|0,me=(p+2|0)+(pe|0)|0,W(pe+1|0)|0)?1:(H(be|0,me|0),p=me|0,0)}function Ne(I){I=I|0;var be=0,me=0,pe=0;return W(2)|0||(pe=te(p+1|0)|0,be=p+3|0,me=(p+3|0)+(pe|0)|0,W(pe+2|0)|0)?1:(H(be|0,me|0),p=me|0,0)}function St(I){I=I|0;var be=0,me=0,pe=0;return W(4)|0||(pe=y(p+1|0)|0,be=p+5|0,me=(p+5|0)+(pe|0)|0,W(pe+4|0)|0)?1:(H(be|0,me|0),p=me|0,0)}function Kr(I){return I=I|0,1}function jr(I){return I=I|0,Q(),p=p+1|0,0}function ge(I){return I=I|0,q(I-128|0),p=p+1|0,0}function ir(I){return I=I|0,W(1)|0?1:(q(i[p+1|0]|0),p=p+2|0,0)}function rt(I){return I=I|0,W(2)|0?1:(q(te(p+1|0)|0),p=p+3|0,0)}function He(I){return I=I|0,W(4)|0?1:($(te(p+1|0)|0,te(p+3|0)|0),p=p+5|0,0)}function Ae(I){return I=I|0,W(8)|0?1:(K(te(p+1|0)|0,te(p+3|0)|0,te(p+5|0)|0,te(p+7|0)|0),p=p+9|0,0)}function Cc(I){return I=I|0,Z(),p=p+1|0,0}function Se(I){I=I|0;var be=0;return be=I-160|0,W(be|0)|0?1:(V(be|0),p=p+1|0,0)}function $c(I){return I=I|0,W(1)|0?1:(V(i[p+1|0]|0),p=p+2|0,0)}function qc(I){return I=I|0,W(2)|0?1:(V(te(p+1|0)|0),p=p+3|0,0)}function Gc(I){return I=I|0,W(4)|0?1:(ae(te(p+1|0)|0,te(p+3|0)|0),p=p+5|0,0)}function Hc(I){return I=I|0,W(8)|0?1:(_(te(p+1|0)|0,te(p+3|0)|0,te(p+5|0)|0,te(p+7|0)|0),p=p+9|0,0)}function Vc(I){return I=I|0,z(),p=p+1|0,0}function br(I){return I=I|0,D(I-192|0|0),p=p+1|0,0}function Xl(I){return I=I|0,D(I|0),p=p+1|0,0}function Jl(I){return I=I|0,D(I|0),p=p+1|0,0}function Ql(I){return I=I|0,D(I|0),p=p+1|0,0}function ed(I){return I=I|0,D(I|0),p=p+1|0,0}function Ce(I){return I=I|0,D(I-192|0|0),p=p+1|0,0}function td(I){return I=I|0,D(I|0),p=p+1|0,0}function rd(I){return I=I|0,D(I|0),p=p+1|0,0}function nd(I){return I=I|0,D(I|0),p=p+1|0,0}function Kc(I){return I=I|0,W(1)|0?1:(D(i[p+1|0]|0),p=p+2|0,0)}function jc(I){return I=I|0,W(2)|0?1:(D(te(p+1|0)|0),p=p+3|0,0)}function zc(I){return I=I|0,W(4)|0?1:(re(te(p+1|0)|0,te(p+3|0)|0),p=p+5|0,0)}function Wc(I){return I=I|0,W(8)|0?1:(ie(te(p+1|0)|0,te(p+3|0)|0,te(p+5|0)|0,te(p+7|0)|0),p=p+9|0,0)}function Re(I){return I=I|0,G((I|0)-224|0),p=p+1|0,0}function Yc(I){return I=I|0,U(),p=p+1|0,0}function Zc(I){return I=I|0,d(),p=p+1|0,0}function Xc(I){return I=I|0,R(),p=p+1|0,0}function Jc(I){return I=I|0,P(),p=p+1|0,0}function Qc(I){return I=I|0,W(1)|0?1:(G(i[p+1|0]|0),p=p+2|0,0)}function eu(I){I=I|0;var be=0,me=0,pe=1,xn=0,zr=0,id=0;return W(2)|0?1:(be=i[p+1|0]|0,me=i[p+2|0]|0,(be|0)&128&&(pe=-1),xn=+(((be|0)&124)>>2),zr=+(((be|0)&3)<<8|me),+xn==0?x(+(+pe*5960464477539063e-23*+zr)):+xn==31?+pe==1?+zr>0?F():k():+zr>0?O():C():x(+(+pe*j(2,+(+xn-25))*+(1024+zr))),p=p+3|0,0)}function tu(I){return I=I|0,W(4)|0?1:(v(i[p+1|0]|0,i[p+2|0]|0,i[p+3|0]|0,i[p+4|0]|0),p=p+5|0,0)}function ru(I){return I=I|0,W(8)|0?1:(A(i[p+1|0]|0,i[p+2|0]|0,i[p+3|0]|0,i[p+4|0]|0,i[p+5|0]|0,i[p+6|0]|0,i[p+7|0]|0,i[p+8|0]|0),p=p+9|0,0)}function ve(I){return I=I|0,1}function nu(I){return I=I|0,fe(),p=p+1|0,0}var iu=[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,m,B,T,N,ve,ve,ve,ve,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,s,a,l,g,ve,ve,ve,ve,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,L,X,ue,de,ve,ve,ve,he,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,we,Ne,St,Kr,ve,ve,ve,jr,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,ir,rt,He,Ae,ve,ve,ve,Cc,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,$c,qc,Gc,Hc,ve,ve,ve,Vc,br,br,br,br,br,br,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Kc,jc,zc,Wc,ve,ve,ve,ve,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Yc,Zc,Xc,Jc,Qc,eu,tu,ru,ve,ve,ve,nu];return{parse:se}},vi={},Ze={};const As=Ei.BigNumber;Ze.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};Ze.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};Ze.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};Ze.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};Ze.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};Ze.SHIFT32=Math.pow(2,32);Ze.SHIFT16=Math.pow(2,16);Ze.MAX_SAFE_HIGH=2097151;Ze.NEG_ONE=new As(-1);Ze.TEN=new As(10);Ze.TWO=new As(2);Ze.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(r){const{Buffer:e}=bn,t=Ei.BigNumber,n=Ze,i=n.SHIFT32,o=n.SHIFT16,c=2097151;r.parseHalf=function(w){var x,v,A;return A=w[0]&128?-1:1,x=(w[0]&124)>>2,v=(w[0]&3)<<8|w[1],x?x===31?A*(v?NaN:1/0):A*Math.pow(2,x-25)*(1024+v):A*5960464477539063e-23*v};function u(h){return h<16?"0"+h.toString(16):h.toString(16)}r.arrayBufferToBignumber=function(h){const w=h.byteLength;let x="";for(let v=0;v<w;v++)x+=u(h[v]);return new t(x,16)},r.buildMap=h=>{const w=new Map,x=Object.keys(h),v=x.length;for(let A=0;A<v;A++)w.set(x[A],h[x[A]]);return w},r.buildInt32=(h,w)=>h*o+w,r.buildInt64=(h,w,x,v)=>{const A=r.buildInt32(h,w),d=r.buildInt32(x,v);return A>c?new t(A).times(i).plus(d):A*i+d},r.writeHalf=function(w,x){const v=e.allocUnsafe(4);v.writeFloatBE(x,0);const A=v.readUInt32BE(0);if(A&8191)return!1;var d=A>>16&32768;const U=A>>23&255,P=A&8388607;if(U>=113&&U<=142)d+=(U-112<<10)+(P>>13);else if(U>=103&&U<113){if(P&(1<<126-U)-1)return!1;d+=P+8388608>>126-U}else return!1;return w.writeUInt16BE(d,0),!0},r.keySorter=function(h,w){var x=h[0].byteLength,v=w[0].byteLength;return x>v?1:v>x?-1:h[0].compare(w[0])},r.isNegativeZero=h=>h===0&&1/h<0,r.nextPowerOf2=h=>{let w=0;if(h&&!(h&h-1))return h;for(;h!==0;)h>>=1,w+=1;return 1<<w}})(vi);const Ss=Ze,tf=Ss.MT,Sn=Ss.SIMPLE,Oi=Ss.SYMS;let rf=class Qi{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,tf.SIMPLE_FLOAT)}static isSimple(e){return e instanceof Qi}static decode(e,t){switch(t==null&&(t=!0),e){case Sn.FALSE:return!1;case Sn.TRUE:return!0;case Sn.NULL:return t?null:Oi.NULL;case Sn.UNDEFINED:return t?void 0:Oi.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return Oi.BREAK;default:return new Qi(e)}}};var Fo=rf;let nf=class es{constructor(e,t,n){if(this.tag=e,this.value=t,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var t,n;if(n=e?.[this.tag],typeof n!="function"&&(n=es["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(es,this.value)}catch(i){return t=i,this.err=t,this}}};var Lo=nf;const Mo=self.location?self.location.protocol+"//"+self.location.host:"",ts=self.URL;let sf=class{constructor(e="",t=Mo){this.super=new ts(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function af(r){if(typeof r=="string")return new ts(r).toString();if(!(r instanceof ts)){const e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",n=r.port?":"+r.port:"",i=r.protocol?r.protocol+"//":"",o=r.host||"",c=r.hostname||"",u=r.search||(r.query?"?"+r.query:""),h=r.hash||"",w=r.pathname||"",x=r.path||w+u;return`${i}${e||t}${o||c+n}${x}${h}`}}var Do={URLWithLegacySupport:sf,URLSearchParams:self.URLSearchParams,defaultBase:Mo,format:af};const{URLWithLegacySupport:fd,format:ld}=Do,{URLWithLegacySupport:of,format:dd,URLSearchParams:hd,defaultBase:pd}=Do;var ko={URL:of};const{Buffer:Er}=bn,js=$a,cf=Ei.BigNumber,uf=ef,Xe=vi,xe=Ze,ff=Fo,lf=Lo,{URL:df}=ko;let rs=class ns{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=Xe.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Er.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(t*1e3),2:t=>Xe.arrayBufferToBignumber(t),3:t=>xe.NEG_ONE.minus(Xe.arrayBufferToBignumber(t)),4:t=>xe.TEN.pow(t[0]).times(t[1]),5:t=>xe.TWO.pow(t[0]).times(t[1]),32:t=>new df(t),35:t=>new RegExp(t)},e.tags),this.parser=uf(Dr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case xe.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case xe.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case xe.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case xe.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case xe.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case xe.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===xe.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,t){const n=this._currentParent;switch(n.values++,n.type){case xe.PARENT.ARRAY:case xe.PARENT.BYTE_STRING:case xe.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case xe.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=xe.PARENT.MAP,n.ref=Xe.buildMap(n.ref)));break;case xe.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case xe.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,n){this._parents[this._depth]={type:t,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:xe.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const n=this._knownTags[e];return n?n(t):new lf(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return Er.concat(e)}createByteStringFromHeap(e,t){return e===t?Er.alloc(0):Er.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return Xe.buildInt32(e,t)}createInt64(e,t,n,i){return Xe.buildInt64(e,t,n,i)}createFloat(e){return e}createFloatSingle(e,t,n,i){return js.read([e,t,n,i],0,!1,23,4)}createFloatDouble(e,t,n,i,o,c,u,h){return js.read([e,t,n,i,o,c,u,h],0,!1,52,8)}createInt32Neg(e,t){return-1-Xe.buildInt32(e,t)}createInt64Neg(e,t,n,i){const o=Xe.buildInt32(e,t),c=Xe.buildInt32(n,i);return o>xe.MAX_SAFE_HIGH?xe.NEG_ONE.minus(new cf(o).times(xe.SHIFT32).plus(c)):-1-(o*xe.SHIFT32+c)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new ff(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,n,i){this._push(this.createInt64(e,t,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,n,i){this._push(this.createFloatSingle(e,t,n,i))}pushFloatDouble(e,t,n,i,o,c,u,h){this._push(this.createFloatDouble(e,t,n,i,o,c,u,h))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,n,i){this._push(this.createInt64Neg(e,t,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],xe.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const n=Xe.buildInt32(e,t);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,t,n,i){const o=Xe.buildInt64(e,t,n,i);this._createArrayStartFixed(o)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const n=Xe.buildInt32(e,t);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,t,n,i){const o=Xe.buildInt64(e,t,n,i);this._createObjectStartFixed(o)}pushByteStringStart(){this._parents[this._depth]={type:xe.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:xe.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:xe.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(Xe.buildInt32(e,t))}pushTagStart8(e,t,n,i){this.pushTagStart(Xe.buildInt64(e,t,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},xe.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),xe.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){return typeof e=="string"&&(e=Er.from(e,t||"hex")),new ns({size:e.length}).decodeFirst(e)}static decodeAll(e,t){return typeof e=="string"&&(e=Er.from(e,t||"hex")),new ns({size:e.length}).decodeAll(e)}};rs.decodeFirst=rs.decode;var Co=rs;const{Buffer:Ui}=bn,hf=Co,pf=vi;class Ts extends hf{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,n,i){return super.createInt64(e,t,n,i).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,n,i){return super.createInt64Neg(e,t,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return pf.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,n,i){return`${super.createFloatSingle(e,t,n,i)}_2`}createFloatDouble(e,t,n,i,o,c,u,h){return`${super.createFloatDouble(e,t,n,i,o,c,u,h)}_3`}createByteString(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,t){return`h'${Ui.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const n=super.createArray(e,t);return t===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,t){const n=super.createMap(e),i=Array.from(n.keys()).reduce(zs(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createObject(e,t){const n=super.createObject(e),i=Object.keys(n).reduce(zs(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,t){return`"${Ui.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){return typeof e=="string"&&(e=Ui.from(e,t||"hex")),new Ts().decodeFirst(e)}}var yf=Ts;function zs(r){return(e,t)=>e?`${e}, ${t}: ${r[t]}`:`${t}: ${r[t]}`}const{Buffer:vt}=bn,{URL:wf}=ko,is=Ei.BigNumber,Ri=vi,ke=Ze,ct=ke.MT,Tn=ke.NUMBYTES,Ws=ke.SHIFT32,Ys=ke.SYMS,vr=ke.TAG,gf=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.TWO,bf=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.FOUR,mf=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.EIGHT,_f=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.TRUE,xf=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.FALSE,Ef=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.UNDEFINED,Zs=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.NULL,vf=new is("0x20000000000000"),If=vt.from("f97e00","hex"),Af=vt.from("f9fc00","hex"),Sf=vt.from("f97c00","hex");function Tf(r){return{}.toString.call(r).slice(8,-1)}class si{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[wf,this._pushUrl],[is,this._pushBigNumber]];const t=e.genTypes||[],n=t.length;for(let i=0;i<n;i++)this.addSemanticType(t[i][0],t[i][1]);this._reset()}addSemanticType(e,t){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const c=this.semanticTypes[i][1];return this.semanticTypes[i][1]=t,c}return this.semanticTypes.push([e,t]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,t,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(If)}_pushInfinity(e){const t=e<0?Af:Sf;return this.push(t)}_pushFloat(e){const t=vt.allocUnsafe(2);if(Ri.writeHalf(t,e)&&Ri.parseHalf(t)===e)return this._pushUInt8(gf)&&this.push(t);const n=vt.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(bf)&&this.push(n):this._pushUInt8(mf)&&this._pushDoubleBE(e)}_pushInt(e,t,n){const i=t<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|Tn.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|Tn.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|Tn.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|Tn.EIGHT)&&this._pushUInt32BE(Math.floor(e/Ws))&&this._pushUInt32BE(e%Ws):t===ct.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,ct.NEG_INT,e):this._pushInt(e,ct.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=vt.byteLength(e,"utf8");return this._pushInt(t,ct.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?_f:xf)}_pushUndefined(e){return this._pushUInt8(Ef)}_pushArray(e,t){const n=t.length;if(!e._pushInt(n,ct.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(t[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,ct.TAG)}_pushDate(e,t){return e._pushTag(vr.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,ct.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(vr.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,ct.ARRAY))return!1;for(const n of t)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,t){return e._pushTag(vr.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=vr.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=vr.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=vt.from(n,"hex");return this._pushTag(t)&&this._pushBuffer(this,i)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!(e._pushTag(vr.DECIMAL_FRAC)&&e._pushInt(2,ct.ARRAY)))return!1;const n=t.decimalPlaces(),i=t.multipliedBy(new is(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(vf)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,t){return e._pushInt(t.size,ct.MAP)?this._pushRawMap(t.size,Array.from(t)):!1}_pushObject(e){if(!e)return this._pushUInt8(Zs);for(var t=this.semanticTypes.length,n=0;n<t;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var o=Object.keys(e),c=o.length;return this._pushInt(c,ct.MAP)?this._pushRawMap(c,o.map(u=>[u,e[u]])):!1}_pushRawMap(e,t){t=t.map(function(i){return i[0]=si.encode(i[0]),i}).sort(Ri.keySorter);for(var n=0;n<e;n++)if(!this.push(t[n][0])||!this.pushAny(t[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var t=Tf(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,vt.isBuffer(e)?e:vt.from(e));case"Null":return this._pushUInt8(Zs);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case Ys.NULL:return this._pushObject(null);case Ys.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,t=this.resultLength,n=this.resultMethod,i=this.offset,o=0,c=0;c<i;c++)o+=t[c];var u=vt.allocUnsafe(o),h=0,w=0;for(c=0;c<i;c++){switch(w=t[c],n[c]){case 0:e[c].copy(u,h);break;case 1:u.writeUInt8(e[c],h,!0);break;case 2:u.writeUInt16BE(e[c],h,!0);break;case 3:u.writeUInt32BE(e[c],h,!0);break;case 4:u.writeDoubleBE(e[c],h,!0);break;case 5:u.write(e[c],h,w,"utf8");break;default:throw new Error("unkown method")}h+=w}var x=u;return this._reset(),x}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new si;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}}var Bf=si;(function(r){r.Diagnose=yf,r.Decoder=Co,r.Encoder=Bf,r.Simple=Fo,r.Tagged=Lo,r.decodeAll=r.Decoder.decodeAll,r.decodeFirst=r.Decoder.decodeFirst,r.diagnose=r.Diagnose.diagnose,r.encode=r.Encoder.encode,r.decode=r.Decoder.decode,r.leveldb={decode:r.Decoder.decodeAll,encode:r.Encoder.encode,buffer:!0,name:"cbor"}})(Ro);const $o=ou(Ro);function ht(r){return rn(ku.create().update(new Uint8Array(r)).digest())}function Dn(r){if(r instanceof $o.Tagged)return Dn(r.value);if(typeof r=="string")return qo(r);if(typeof r=="number")return ht(Be(r));if(r instanceof ArrayBuffer||ArrayBuffer.isView(r))return ht(r);if(Array.isArray(r)){const e=r.map(Dn);return ht(pt(...e))}else{if(r&&typeof r=="object"&&r._isPrincipal)return ht(r.toUint8Array());if(typeof r=="object"&&r!==null&&typeof r.toHash=="function")return Dn(r.toHash());if(typeof r=="object")return ai(r);if(typeof r=="bigint")return ht(Be(r))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${r}`),{value:r})}const qo=r=>{const e=new TextEncoder().encode(r);return ht(e)};function ln(r){return ai(r)}function ai(r){const n=Object.entries(r).filter(([,c])=>c!==void 0).map(([c,u])=>{const h=qo(c),w=Dn(u);return[h,w]}).sort(([c],[u])=>za(c,u)),i=pt(...n.map(c=>pt(...c)));return ht(i)}var Nf=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Of=new TextEncoder().encode(`
ic-request`);class Bs{getPrincipal(){return this._principal||(this._principal=Ee.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:t}=e,n=Nf(e,["body"]),i=ln(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(pt(Of,i))}})}}class oi{getPrincipal(){return Ee.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var nt={},Hr={},Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});const Uf=9007199254740992;function Dt(r,...e){const t=new Uint8Array(r.byteLength+e.reduce((i,o)=>i+o.byteLength,0));t.set(new Uint8Array(r),0);let n=r.byteLength;for(const i of e)t.set(new Uint8Array(i),n),n+=i.byteLength;return t.buffer}function yt(r,e,t){t=t.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);t=t.slice(-n*2).padStart(n*2,"0");const i=[(r<<5)+e].concat(t.match(/../g).map(o=>parseInt(o,16)));return new Uint8Array(i).buffer}function Ii(r,e){if(e<24)return new Uint8Array([(r<<5)+e]).buffer;{const t=e<=255?24:e<=65535?25:e<=4294967295?26:27;return yt(r,t,e.toString(16))}}function Go(r){const e=[];for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(t++,n=(n&1023)<<10|r.charCodeAt(t)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Dt(new Uint8Array(Ii(3,r.length)),new Uint8Array(e))}function Rf(r,e){if(r==14277111)return Dt(new Uint8Array([217,217,247]),e);if(r<24)return Dt(new Uint8Array([192+r]),e);{const t=r<=255?24:r<=65535?25:r<=4294967295?26:27,n=2**(t-24),i=r.toString(16).slice(-n*2).padStart(n*2,"0"),o=[192+t].concat(i.match(/../g).map(c=>parseInt(c,16)));return new Uint8Array(o).buffer}}Ie.tagged=Rf;function mn(r){return new Uint8Array(r).buffer}Ie.raw=mn;function Ns(r){if(isNaN(r))throw new RangeError("Invalid number.");r=Math.min(Math.max(0,r),23);const e=[0+r];return new Uint8Array(e).buffer}Ie.uSmall=Ns;function Ho(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),255),r=r.toString(16),yt(0,24,r)}Ie.u8=Ho;function Vo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),65535),r=r.toString(16),yt(0,25,r)}Ie.u16=Vo;function Ko(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),4294967295),r=r.toString(16),yt(0,26,r)}Ie.u32=Ko;function Os(r,e){if(typeof r=="string"&&e==16){if(r.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return yt(0,27,r)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),Uf),r=r.toString(16),yt(0,27,r)}Ie.u64=Os;function jo(r){if(isNaN(r))throw new RangeError("Invalid number.");if(r===0)return Ns(0);r=Math.min(Math.max(0,-r),24)-1;const e=[32+r];return new Uint8Array(e).buffer}Ie.iSmall=jo;function zo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),255),r=r.toString(16),yt(1,24,r)}Ie.i8=zo;function Wo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),65535),r=r.toString(16),yt(1,25,r)}Ie.i16=Wo;function Yo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),4294967295),r=r.toString(16),yt(1,26,r)}Ie.i32=Yo;function Zo(r,e){if(typeof r=="string"&&e==16){if(r.startsWith("-")?r=r.slice(1):r="0",r.match(/[^0-9a-fA-F]/)||r.length>16)throw new RangeError("Invalid number.");let t=!1,n=r.split("").reduceRight((i,o)=>{if(t)return o+i;let c=parseInt(o,16)-1;return c>=0?(t=!0,c.toString(16)+i):"f"+i},"");return t?yt(1,27,n):Os(0)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),9007199254740992),r=r.toString(16),yt(1,27,r)}Ie.i64=Zo;function Pf(r){return r>=0?r<24?Ns(r):r<=255?Ho(r):r<=65535?Vo(r):r<=4294967295?Ko(r):Os(r):r>=-24?jo(r):r>=-255?zo(r):r>=-65535?Wo(r):r>=-4294967295?Yo(r):Zo(r)}Ie.number=Pf;function Ff(r){return Dt(Ii(2,r.byteLength),r)}Ie.bytes=Ff;function Lf(r){return Go(r)}Ie.string=Lf;function Mf(r){return Dt(Ii(4,r.length),...r)}Ie.array=Mf;function Df(r,e=!1){r instanceof Map||(r=new Map(Object.entries(r)));let t=Array.from(r.entries());return e&&(t=t.sort(([n],[i])=>n.localeCompare(i))),Dt(Ii(5,r.size),...t.map(([n,i])=>Dt(Go(n),i)))}Ie.map=Df;function kf(r){const e=new Float32Array([r]);return Dt(new Uint8Array([250]),new Uint8Array(e.buffer))}Ie.singleFloat=kf;function Cf(r){const e=new Float64Array([r]);return Dt(new Uint8Array([251]),new Uint8Array(e.buffer))}Ie.doubleFloat=Cf;function $f(r){return r?Xo():Jo()}Ie.bool=$f;function Xo(){return mn(new Uint8Array([245]))}Ie.true_=Xo;function Jo(){return mn(new Uint8Array([244]))}Ie.false_=Jo;function qf(){return mn(new Uint8Array([246]))}Ie.null_=qf;function Gf(){return mn(new Uint8Array([247]))}Ie.undefined_=Gf;var Hf=Dr&&Dr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e};Object.defineProperty(Hr,"__esModule",{value:!0});const ut=Hf(Ie),Vf=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class Qo{constructor(e,t=!1){this._serializer=e,this._stable=t,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return ut.undefined_();case"boolean":return ut.bool(e);case"number":return Math.floor(e)===e?ut.number(e):ut.doubleFloat(e);case"string":return ut.string(e);case"object":if(e===null)return ut.null_();if(Array.isArray(e))return ut.array(e.map(t=>this._serializer.serializeValue(t)));if(Vf.find(t=>e instanceof t))return ut.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const t=new Map;for(const[n,i]of e.entries())t.set(n,this._serializer.serializeValue(i));return ut.map(t,this._stable)}else{const t=new Map;for(const[n,i]of Object.entries(e))t.set(n,this._serializer.serializeValue(i));return ut.map(t,this._stable)}default:throw new Error("Invalid value.")}}}Hr.JsonDefaultCborEncoder=Qo;class ec{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}Hr.ToCborEncoder=ec;class tc{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const t=new this;return t.addEncoder(new Qo(t,e)),t.addEncoder(new ec),t}removeEncoder(e){for(const t of this._encoders.values())t.name==e&&this._encoders.delete(t)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let t=null;for(const n of this._encoders)(!t||n.priority>t.priority)&&n.match(e)&&(t=n);if(t===null)throw new Error("Could not find an encoder for value.");return t}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}Hr.CborSerializer=tc;class Kf extends tc{serialize(e){return ut.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}Hr.SelfDescribeCborSerializer=Kf;(function(r){function e(i){for(var o in i)r.hasOwnProperty(o)||(r[o]=i[o])}var t=Dr&&Dr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var c in i)Object.hasOwnProperty.call(i,c)&&(o[c]=i[c]);return o.default=i,o};Object.defineProperty(r,"__esModule",{value:!0}),e(Hr);const n=t(Ie);r.value=n})(nt);class jf{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return nt.value.bytes(e.toUint8Array())}}class zf{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return nt.value.bytes(new Uint8Array(e))}}class Wf{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?nt.value.tagged(2,nt.value.bytes(Mt(e.toString(16)))):nt.value.tagged(3,nt.value.bytes(Mt((BigInt("-1")*e).toString(16))))}}const Ai=nt.SelfDescribeCborSerializer.withDefaultEncoders(!0);Ai.addEncoder(new jf);Ai.addEncoder(new zf);Ai.addEncoder(new Wf);var ss;(function(r){r[r.Uint64LittleEndian=71]="Uint64LittleEndian",r[r.Semantic=55799]="Semantic"})(ss||(ss={}));function Pi(r){return Ai.serialize(r)}function Xs(r){const e=r.byteLength;let t=BigInt(0);for(let n=0;n<e;n++)t=t*BigInt(256)+BigInt(r[n]);return t}class Yf extends $o.Decoder{createByteString(e){return pt(...e)}createByteStringFromHeap(e,t){return e===t?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,t))}}function Ft(r){const e=new Uint8Array(r),t=new Yf({size:e.byteLength,tags:{2:n=>Xs(n),3:n=>-Xs(n),[ss.Semantic]:n=>n}});try{return t.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${Pe(e)}`)}}const Bn=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const r=new Uint32Array(1);return window.crypto.getRandomValues(r),r[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const r=new Uint32Array(1);return crypto.getRandomValues(r),r[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var as;(function(r){r.Call="call"})(as||(as={}));function os(){const r=new ArrayBuffer(16),e=new DataView(r),t=Bn(),n=Bn(),i=Bn(),o=Bn();return e.setUint32(0,t),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,o),r}const Js=BigInt(1e6),Zf=60*1e3;class Nn{constructor(e){if(e<90*1e3){const u=BigInt(Date.now()+e)*Js/BigInt(1e9);this._value=u*BigInt(1e9);return}const o=BigInt(Math.floor(Date.now()+e-Zf))*Js/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=o}toCBOR(){return nt.value.u64(this._value.toString(16),16)}toHash(){return Be(this._value)}}function Qs(r=os){return async e=>{const t=e.request.headers;e.request.headers=t,e.endpoint==="call"&&(e.body.nonce=r())}}function Yr(r){const e=[];return r.forEach((t,n)=>{e.push([n,t])}),e}class Fi extends Me{constructor(e,t){super(e),this.response=t,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class Xf extends Me{constructor(e,t,n,i,o,c){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=c,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Jf extends Me{constructor(e,t,n,i,o,c){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=c,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Qf extends Me{constructor(e,t,n,i,o,c){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=c,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Us=BigInt(0),ci=BigInt(1);function Si(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function rr(r){if(!Si(r))throw new Error("Uint8Array expected")}function nn(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}function rc(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Us:BigInt("0x"+r)}const nc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",e0=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function gr(r){if(rr(r),nc)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=e0[r[t]];return e}const Bt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ea(r){if(r>=Bt._0&&r<=Bt._9)return r-Bt._0;if(r>=Bt.A&&r<=Bt.F)return r-(Bt.A-10);if(r>=Bt.a&&r<=Bt.f)return r-(Bt.a-10)}function ic(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(nc)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){const c=ea(r.charCodeAt(o)),u=ea(r.charCodeAt(o+1));if(c===void 0||u===void 0){const h=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+o)}n[i]=c*16+u}return n}function dt(r){return rc(gr(r))}function sn(r){return rr(r),rc(gr(Uint8Array.from(r).reverse()))}function Ke(r,e){return ic(r.toString(16).padStart(e*2,"0"))}function ui(r,e){return Ke(r,e).reverse()}function tt(r,e,t){let n;if(typeof e=="string")try{n=ic(e)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(Si(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(r+" of length "+t+" expected, got "+i);return n}function Fe(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];rr(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const o=r[n];t.set(o,i),i+=o.length}return t}function Rs(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Li=r=>typeof r=="bigint"&&Us<=r;function sc(r,e,t){return Li(r)&&Li(e)&&Li(t)&&e<=r&&r<t}function Zt(r,e,t,n){if(!sc(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function an(r){let e;for(e=0;r>Us;r>>=ci,e+=1);return e}function t0(r,e){return r>>BigInt(e)&ci}const Lr=r=>(ci<<BigInt(r))-ci,r0={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Si(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function _n(r,e,t={}){const n=(i,o,c)=>{const u=r0[o];if(typeof u!="function")throw new Error("invalid validator function");const h=r[i];if(!(c&&h===void 0)&&!u(h,r))throw new Error("param "+String(i)+" is invalid. Expected "+o+", got "+h)};for(const[i,o]of Object.entries(e))n(i,o,!1);for(const[i,o]of Object.entries(t))n(i,o,!0);return r}const ta=()=>{throw new Error("not implemented")};function dn(r){const e=new WeakMap;return(t,...n)=>{const i=e.get(t);if(i!==void 0)return i;const o=r(t,...n);return e.set(t,o),o}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const it=BigInt(0),Ge=BigInt(1),dr=BigInt(2),n0=BigInt(3),cs=BigInt(4),ra=BigInt(5),na=BigInt(8);function Te(r,e){const t=r%e;return t>=it?t:e+t}function gt(r,e,t){let n=r;for(;e-- >it;)n*=n,n%=t;return n}function ia(r,e){if(r===it)throw new Error("invert: expected non-zero number");if(e<=it)throw new Error("invert: expected positive modulus, got "+e);let t=Te(r,e),n=e,i=it,o=Ge;for(;t!==it;){const u=n/t,h=n%t,w=i-o*u;n=t,t=h,i=o,o=w}if(n!==Ge)throw new Error("invert: does not exist");return Te(i,e)}function i0(r){let e=r-Ge,t=0;for(;e%dr===it;)e/=dr,t++;let n=dr;const i=Vr(r);for(;n<r&&sa(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1){const c=(r+Ge)/cs;return function(h,w){const x=h.pow(w,c);if(!h.eql(h.sqr(x),w))throw new Error("Cannot find square root");return x}}const o=(e+Ge)/dr;return function(u,h){if(!sa(u,h))throw new Error("Cannot find square root");let w=t,x=u.pow(u.mul(u.ONE,n),e),v=u.pow(h,o),A=u.pow(h,e);for(;!u.eql(A,u.ONE);){if(u.eql(A,u.ZERO))return u.ZERO;let d=1;for(let P=u.sqr(A);d<w&&!u.eql(P,u.ONE);d++)P=u.sqr(P);const U=u.pow(x,Ge<<BigInt(w-d-1));x=u.sqr(U),v=u.mul(v,U),A=u.mul(A,x),w=d}return v}}function s0(r){return r%cs===n0?function(t,n){const i=(r+Ge)/cs,o=t.pow(n,i);if(!t.eql(t.sqr(o),n))throw new Error("Cannot find square root");return o}:r%na===ra?function(t,n){const i=t.mul(n,dr),o=(r-ra)/na,c=t.pow(i,o),u=t.mul(n,c),h=t.mul(t.mul(u,dr),c),w=t.mul(u,t.sub(h,t.ONE));if(!t.eql(t.sqr(w),n))throw new Error("Cannot find square root");return w}:i0(r)}const a0=(r,e)=>(Te(r,e)&Ge)===Ge,o0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ac(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=o0.reduce((n,i)=>(n[i]="function",n),e);return _n(r,t)}function kn(r,e,t){if(t<it)throw new Error("invalid exponent, negatives unsupported");if(t===it)return r.ONE;if(t===Ge)return e;let n=r.ONE,i=e;for(;t>it;)t&Ge&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Ge;return n}function er(r,e,t=!1){const n=new Array(e.length).fill(t?r.ZERO:void 0),i=e.reduce((c,u,h)=>r.is0(u)?c:(n[h]=c,r.mul(c,u)),r.ONE),o=r.inv(i);return e.reduceRight((c,u,h)=>r.is0(u)?c:(n[h]=r.mul(c,n[h]),r.mul(c,u)),o),n}function us(r,e){const t=(r.ORDER-Ge)/dr,n=r.pow(e,t),i=r.eql(n,r.ONE),o=r.eql(n,r.ZERO),c=r.eql(n,r.neg(r.ONE));if(!i&&!o&&!c)throw new Error("Cannot find square root: probably non-prime P");return i?1:o?0:-1}function sa(r,e){const t=us(r,e);return t===0||t===1}function oc(r,e){e!==void 0&&wu(e);const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Vr(r,e,t=!1,n={}){if(r<=it)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:i,nByteLength:o}=oc(r,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:r,isLE:t,BITS:i,BYTES:o,MASK:Lr(i),ZERO:it,ONE:Ge,create:h=>Te(h,r),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return it<=h&&h<r},is0:h=>h===it,isOdd:h=>(h&Ge)===Ge,neg:h=>Te(-h,r),eql:(h,w)=>h===w,sqr:h=>Te(h*h,r),add:(h,w)=>Te(h+w,r),sub:(h,w)=>Te(h-w,r),mul:(h,w)=>Te(h*w,r),pow:(h,w)=>kn(u,h,w),div:(h,w)=>Te(h*ia(w,r),r),sqrN:h=>h*h,addN:(h,w)=>h+w,subN:(h,w)=>h-w,mulN:(h,w)=>h*w,inv:h=>ia(h,r),sqrt:n.sqrt||(h=>(c||(c=s0(r)),c(u,h))),toBytes:h=>t?ui(h,o):Ke(h,o),fromBytes:h=>{if(h.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+h.length);return t?sn(h):dt(h)},invertBatch:h=>er(u,h),cmov:(h,w,x)=>x?w:h});return Object.freeze(u)}function cc(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function uc(r){const e=cc(r);return e+Math.ceil(e/2)}function c0(r,e,t=!1){const n=r.length,i=cc(e),o=uc(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const c=t?sn(r):dt(r),u=Te(c,e-Ge)+Ge;return t?ui(u,i):Ke(u,i)}const u0=dt;function jt(r,e){if(hn(r),hn(e),r<0||r>=1<<8*e)throw new Error("invalid I2OSP input: "+r);const t=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)t[n]=r&255,r>>>=8;return new Uint8Array(t)}function f0(r,e){const t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return t}function hn(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function l0(r,e,t,n){rr(r),rr(e),hn(t),e.length>255&&(e=n(Fe(Rs("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,c=Math.ceil(t/i);if(t>65535||c>255)throw new Error("expand_message_xmd: invalid lenInBytes");const u=Fe(e,jt(e.length,1)),h=jt(0,o),w=jt(t,2),x=new Array(c),v=n(Fe(h,r,w,jt(0,1),u));x[0]=n(Fe(v,jt(1,1),u));for(let d=1;d<=c;d++){const U=[f0(v,x[d-1]),jt(d+1,1),u];x[d]=n(Fe(...U))}return Fe(...x).slice(0,t)}function d0(r,e,t,n,i){if(rr(r),rr(e),hn(t),e.length>255){const o=Math.ceil(2*n/8);e=i.create({dkLen:o}).update(Rs("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:t}).update(r).update(jt(t,2)).update(e).update(jt(e.length,1)).digest()}function aa(r,e,t){_n(t,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:c,expand:u,DST:h}=t;rr(r),hn(e);const w=typeof h=="string"?Rs(h):h,x=n.toString(2).length,v=Math.ceil((x+i)/8),A=e*o*v;let d;if(u==="xmd")d=l0(r,w,A,c);else if(u==="xof")d=d0(r,w,A,i,c);else if(u==="_internal_pass")d=r;else throw new Error('expand must be "xmd" or "xof"');const U=new Array(e);for(let P=0;P<e;P++){const R=new Array(o);for(let k=0;k<o;k++){const C=v*(k+P*o),F=d.subarray(C,C+v);R[k]=Te(u0(F),n)}U[P]=R}return U}function fc(r,e){const t=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[o,c,u,h]=t.map(v=>v.reduce((A,d)=>r.add(r.mul(A,n),d))),[w,x]=er(r,[c,h],!0);return n=r.mul(o,w),i=r.mul(i,r.mul(u,x)),{x:n,y:i}}}function oa(r,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");function n(o){return r.fromAffine(e(o))}function i(o){const c=o.clearCofactor();return c.equals(r.ZERO)?r.ZERO:(c.assertValidity(),c)}return{defaults:t,hashToCurve(o,c){const u=aa(o,2,{...t,DST:t.DST,...c}),h=n(u[0]),w=n(u[1]);return i(h.add(w))},encodeToCurve(o,c){const u=aa(o,1,{...t,DST:t.encodeDST,...c});return i(n(u[0]))},mapToCurve(o){if(!Array.isArray(o))throw new Error("expected array of bigints");for(const c of o)if(typeof c!="bigint")throw new Error("expected array of bigints");return i(n(o))}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ca=BigInt(0),fs=BigInt(1);function Mi(r,e){const t=e.negate();return r?t:e}function lc(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Di(r,e){lc(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),i=2**r,o=Lr(r),c=BigInt(r);return{windows:t,windowSize:n,mask:o,maxNumber:i,shiftBy:c}}function ua(r,e,t){const{windowSize:n,mask:i,maxNumber:o,shiftBy:c}=t;let u=Number(r&i),h=r>>c;u>n&&(u-=o,h+=fs);const w=e*n,x=w+Math.abs(u)-1,v=u===0,A=u<0,d=e%2!==0;return{nextN:h,offset:x,isZero:v,isNeg:A,isNegF:d,offsetF:w}}function h0(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function p0(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const ki=new WeakMap,dc=new WeakMap;function Ci(r){return dc.get(r)||1}function hc(r,e){return{constTimeNegate:Mi,hasPrecomputes(t){return Ci(t)!==1},unsafeLadder(t,n,i=r.ZERO){let o=t;for(;n>ca;)n&fs&&(i=i.add(o)),o=o.double(),n>>=fs;return i},precomputeWindow(t,n){const{windows:i,windowSize:o}=Di(n,e),c=[];let u=t,h=u;for(let w=0;w<i;w++){h=u,c.push(h);for(let x=1;x<o;x++)h=h.add(u),c.push(h);u=h.double()}return c},wNAF(t,n,i){let o=r.ZERO,c=r.BASE;const u=Di(t,e);for(let h=0;h<u.windows;h++){const{nextN:w,offset:x,isZero:v,isNeg:A,isNegF:d,offsetF:U}=ua(i,h,u);i=w,v?c=c.add(Mi(d,n[U])):o=o.add(Mi(A,n[x]))}return{p:o,f:c}},wNAFUnsafe(t,n,i,o=r.ZERO){const c=Di(t,e);for(let u=0;u<c.windows&&i!==ca;u++){const{nextN:h,offset:w,isZero:x,isNeg:v}=ua(i,u,c);if(i=h,!x){const A=n[w];o=o.add(v?A.negate():A)}}return o},getPrecomputes(t,n,i){let o=ki.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&ki.set(n,i(o))),o},wNAFCached(t,n,i){const o=Ci(t);return this.wNAF(o,this.getPrecomputes(o,t,i),n)},wNAFCachedUnsafe(t,n,i,o){const c=Ci(t);return c===1?this.unsafeLadder(t,n,o):this.wNAFUnsafe(c,this.getPrecomputes(c,t,i),n,o)},setWindowSize(t,n){lc(n,e),dc.set(t,n),ki.delete(t)}}}function pc(r,e,t,n){if(h0(t,r),p0(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=r.ZERO,o=an(BigInt(t.length)),c=o>12?o-3:o>4?o-2:o?2:1,u=Lr(c),h=new Array(Number(u)+1).fill(i),w=Math.floor((e.BITS-1)/c)*c;let x=i;for(let v=w;v>=0;v-=c){h.fill(i);for(let d=0;d<n.length;d++){const U=n[d],P=Number(U>>BigInt(v)&u);h[P]=h[P].add(t[d])}let A=i;for(let d=h.length-1,U=i;d>0;d--)U=U.add(h[d]),A=A.add(U);if(x=x.add(A),v!==0)for(let d=0;d<c;d++)x=x.double()}return x}function yc(r){return ac(r.Fp),_n(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...oc(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function y0(r){const e=yc(r);_n(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const fr=BigInt(0),Oe=BigInt(1),Vt=BigInt(2),fi=BigInt(3),fa=BigInt(4);function la(r){const e=y0(r),{Fp:t}=e,n=Vr(e.n,e.nBitLength),i=e.toBytes||((P,R,k)=>{const C=R.toAffine();return Fe(Uint8Array.from([4]),t.toBytes(C.x),t.toBytes(C.y))}),o=e.fromBytes||(P=>{const R=P.subarray(1),k=t.fromBytes(R.subarray(0,t.BYTES)),C=t.fromBytes(R.subarray(t.BYTES,2*t.BYTES));return{x:k,y:C}});function c(P){const{a:R,b:k}=e,C=t.sqr(P),F=t.mul(C,P);return t.add(t.add(F,t.mul(P,R)),k)}if(!t.eql(t.sqr(e.Gy),c(e.Gx)))throw new Error("bad generator point: equation left != right");function u(P){return sc(P,Oe,e.n)}function h(P){const{allowedPrivateKeyLengths:R,nByteLength:k,wrapPrivateKey:C,n:F}=e;if(R&&typeof P!="bigint"){if(Si(P)&&(P=gr(P)),typeof P!="string"||!R.includes(P.length))throw new Error("invalid private key");P=P.padStart(k*2,"0")}let O;try{O=typeof P=="bigint"?P:dt(tt("private key",P,k))}catch{throw new Error("invalid private key, expected hex or "+k+" bytes, got "+typeof P)}return C&&(O=Te(O,F)),Zt("private key",O,Oe,F),O}function w(P){if(!(P instanceof A))throw new Error("ProjectivePoint expected")}const x=dn((P,R)=>{const{px:k,py:C,pz:F}=P;if(t.eql(F,t.ONE))return{x:k,y:C};const O=P.is0();R==null&&(R=O?t.ONE:t.inv(F));const Z=t.mul(k,R),q=t.mul(C,R),$=t.mul(F,R);if(O)return{x:t.ZERO,y:t.ZERO};if(!t.eql($,t.ONE))throw new Error("invZ was invalid");return{x:Z,y:q}}),v=dn(P=>{if(P.is0()){if(e.allowInfinityPoint&&!t.is0(P.py))return;throw new Error("bad point: ZERO")}const{x:R,y:k}=P.toAffine();if(!t.isValid(R)||!t.isValid(k))throw new Error("bad point: x or y not FE");const C=t.sqr(k),F=c(R);if(!t.eql(C,F))throw new Error("bad point: equation left != right");if(!P.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class A{constructor(R,k,C){if(R==null||!t.isValid(R))throw new Error("x required");if(k==null||!t.isValid(k)||t.is0(k))throw new Error("y required");if(C==null||!t.isValid(C))throw new Error("z required");this.px=R,this.py=k,this.pz=C,Object.freeze(this)}static fromAffine(R){const{x:k,y:C}=R||{};if(!R||!t.isValid(k)||!t.isValid(C))throw new Error("invalid affine point");if(R instanceof A)throw new Error("projective point not allowed");const F=O=>t.eql(O,t.ZERO);return F(k)&&F(C)?A.ZERO:new A(k,C,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(R){const k=er(t,R.map(C=>C.pz));return R.map((C,F)=>C.toAffine(k[F])).map(A.fromAffine)}static fromHex(R){const k=A.fromAffine(o(tt("pointHex",R)));return k.assertValidity(),k}static fromPrivateKey(R){return A.BASE.multiply(h(R))}static msm(R,k){return pc(A,n,R,k)}_setWindowSize(R){U.setWindowSize(this,R)}assertValidity(){v(this)}hasEvenY(){const{y:R}=this.toAffine();if(t.isOdd)return!t.isOdd(R);throw new Error("Field doesn't support isOdd")}equals(R){w(R);const{px:k,py:C,pz:F}=this,{px:O,py:Z,pz:q}=R,$=t.eql(t.mul(k,q),t.mul(O,F)),K=t.eql(t.mul(C,q),t.mul(Z,F));return $&&K}negate(){return new A(this.px,t.neg(this.py),this.pz)}double(){const{a:R,b:k}=e,C=t.mul(k,fi),{px:F,py:O,pz:Z}=this;let q=t.ZERO,$=t.ZERO,K=t.ZERO,z=t.mul(F,F),V=t.mul(O,O),ae=t.mul(Z,Z),_=t.mul(F,O);return _=t.add(_,_),K=t.mul(F,Z),K=t.add(K,K),q=t.mul(R,K),$=t.mul(C,ae),$=t.add(q,$),q=t.sub(V,$),$=t.add(V,$),$=t.mul(q,$),q=t.mul(_,q),K=t.mul(C,K),ae=t.mul(R,ae),_=t.sub(z,ae),_=t.mul(R,_),_=t.add(_,K),K=t.add(z,z),z=t.add(K,z),z=t.add(z,ae),z=t.mul(z,_),$=t.add($,z),ae=t.mul(O,Z),ae=t.add(ae,ae),z=t.mul(ae,_),q=t.sub(q,z),K=t.mul(ae,V),K=t.add(K,K),K=t.add(K,K),new A(q,$,K)}add(R){w(R);const{px:k,py:C,pz:F}=this,{px:O,py:Z,pz:q}=R;let $=t.ZERO,K=t.ZERO,z=t.ZERO;const V=e.a,ae=t.mul(e.b,fi);let _=t.mul(k,O),S=t.mul(C,Z),M=t.mul(F,q),H=t.add(k,C),Q=t.add(O,Z);H=t.mul(H,Q),Q=t.add(_,S),H=t.sub(H,Q),Q=t.add(k,F);let G=t.add(O,q);return Q=t.mul(Q,G),G=t.add(_,M),Q=t.sub(Q,G),G=t.add(C,F),$=t.add(Z,q),G=t.mul(G,$),$=t.add(S,M),G=t.sub(G,$),z=t.mul(V,Q),$=t.mul(ae,M),z=t.add($,z),$=t.sub(S,z),z=t.add(S,z),K=t.mul($,z),S=t.add(_,_),S=t.add(S,_),M=t.mul(V,M),Q=t.mul(ae,Q),S=t.add(S,M),M=t.sub(_,M),M=t.mul(V,M),Q=t.add(Q,M),_=t.mul(S,Q),K=t.add(K,_),_=t.mul(G,Q),$=t.mul(H,$),$=t.sub($,_),_=t.mul(H,S),z=t.mul(G,z),z=t.add(z,_),new A($,K,z)}subtract(R){return this.add(R.negate())}is0(){return this.equals(A.ZERO)}wNAF(R){return U.wNAFCached(this,R,A.normalizeZ)}multiplyUnsafe(R){const{endo:k,n:C}=e;Zt("scalar",R,fr,C);const F=A.ZERO;if(R===fr)return F;if(this.is0()||R===Oe)return this;if(!k||U.hasPrecomputes(this))return U.wNAFCachedUnsafe(this,R,A.normalizeZ);let{k1neg:O,k1:Z,k2neg:q,k2:$}=k.splitScalar(R),K=F,z=F,V=this;for(;Z>fr||$>fr;)Z&Oe&&(K=K.add(V)),$&Oe&&(z=z.add(V)),V=V.double(),Z>>=Oe,$>>=Oe;return O&&(K=K.negate()),q&&(z=z.negate()),z=new A(t.mul(z.px,k.beta),z.py,z.pz),K.add(z)}multiply(R){const{endo:k,n:C}=e;Zt("scalar",R,Oe,C);let F,O;if(k){const{k1neg:Z,k1:q,k2neg:$,k2:K}=k.splitScalar(R);let{p:z,f:V}=this.wNAF(q),{p:ae,f:_}=this.wNAF(K);z=U.constTimeNegate(Z,z),ae=U.constTimeNegate($,ae),ae=new A(t.mul(ae.px,k.beta),ae.py,ae.pz),F=z.add(ae),O=V.add(_)}else{const{p:Z,f:q}=this.wNAF(R);F=Z,O=q}return A.normalizeZ([F,O])[0]}multiplyAndAddUnsafe(R,k,C){const F=A.BASE,O=(q,$)=>$===fr||$===Oe||!q.equals(F)?q.multiplyUnsafe($):q.multiply($),Z=O(this,k).add(O(R,C));return Z.is0()?void 0:Z}toAffine(R){return x(this,R)}isTorsionFree(){const{h:R,isTorsionFree:k}=e;if(R===Oe)return!0;if(k)return k(A,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:R,clearCofactor:k}=e;return R===Oe?this:k?k(A,this):this.multiplyUnsafe(e.h)}toRawBytes(R=!0){return nn("isCompressed",R),this.assertValidity(),i(A,this,R)}toHex(R=!0){return nn("isCompressed",R),gr(this.toRawBytes(R))}}A.BASE=new A(e.Gx,e.Gy,t.ONE),A.ZERO=new A(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,U=hc(A,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:A,normPrivateKeyToScalar:h,weierstrassEquation:c,isWithinCurveOrder:u}}function w0(r,e){const t=r.ORDER;let n=fr;for(let U=t-Oe;U%Vt===fr;U/=Vt)n+=Oe;const i=n,o=Vt<<i-Oe-Oe,c=o*Vt,u=(t-Oe)/c,h=(u-Oe)/Vt,w=c-Oe,x=o,v=r.pow(e,u),A=r.pow(e,(u+Oe)/Vt);let d=(U,P)=>{let R=v,k=r.pow(P,w),C=r.sqr(k);C=r.mul(C,P);let F=r.mul(U,C);F=r.pow(F,h),F=r.mul(F,k),k=r.mul(F,P),C=r.mul(F,U);let O=r.mul(C,k);F=r.pow(O,x);let Z=r.eql(F,r.ONE);k=r.mul(C,A),F=r.mul(O,R),C=r.cmov(k,C,Z),O=r.cmov(F,O,Z);for(let q=i;q>Oe;q--){let $=q-Vt;$=Vt<<$-Oe;let K=r.pow(O,$);const z=r.eql(K,r.ONE);k=r.mul(C,R),R=r.mul(R,R),K=r.mul(O,R),C=r.cmov(k,C,z),O=r.cmov(K,O,z)}return{isValid:Z,value:C}};if(r.ORDER%fa===fi){const U=(r.ORDER-fi)/fa,P=r.sqrt(r.neg(e));d=(R,k)=>{let C=r.sqr(k);const F=r.mul(R,k);C=r.mul(C,F);let O=r.pow(C,U);O=r.mul(O,F);const Z=r.mul(O,P),q=r.mul(r.sqr(O),k),$=r.eql(q,R);let K=r.cmov(Z,O,$);return{isValid:$,value:K}}}return d}function wc(r,e){if(ac(r),!r.isValid(e.A)||!r.isValid(e.B)||!r.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const t=w0(r,e.Z);if(!r.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,c,u,h,w,x,v;i=r.sqr(n),i=r.mul(i,e.Z),o=r.sqr(i),o=r.add(o,i),c=r.add(o,r.ONE),c=r.mul(c,e.B),u=r.cmov(e.Z,r.neg(o),!r.eql(o,r.ZERO)),u=r.mul(u,e.A),o=r.sqr(c),w=r.sqr(u),h=r.mul(w,e.A),o=r.add(o,h),o=r.mul(o,c),w=r.mul(w,u),h=r.mul(w,e.B),o=r.add(o,h),x=r.mul(i,c);const{isValid:A,value:d}=t(o,w);v=r.mul(i,n),v=r.mul(v,d),x=r.cmov(x,c,A),v=r.cmov(v,d,A);const U=r.isOdd(n)===r.isOdd(v);v=r.cmov(r.neg(v),v,U);const P=er(r,[u],!0)[0];return x=r.mul(x,P),{x,y:v}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const g0=BigInt(0),On=BigInt(1),da=BigInt(2),Rr=BigInt(3);function b0(r){const e=[];for(;r>On;r>>=On)(r&On)===g0?e.unshift(0):(r&Rr)===Rr?(e.unshift(-1),r+=On):e.unshift(1);return e}function m0(r){const{Fp:e,Fr:t,Fp2:n,Fp6:i,Fp12:o}=r.fields,c=r.params.xNegative,u=r.params.twistType,h=la({n:t.ORDER,...r.G1}),w=Object.assign(h,oa(h.ProjectivePoint,r.G1.mapToCurve,{...r.htfDefaults,...r.G1.htfDefaults})),x=la({n:t.ORDER,...r.G2}),v=Object.assign(x,oa(x.ProjectivePoint,r.G2.mapToCurve,{...r.htfDefaults,...r.G2.htfDefaults}));let A;if(u==="multiplicative")A=(j,p,Y,ne,se,W)=>o.mul014(ne,j,n.mul(p,se),n.mul(Y,W));else if(u==="divisive")A=(j,p,Y,ne,se,W)=>o.mul034(ne,n.mul(Y,W),n.mul(p,se),j);else throw new Error("bls: unknown twist type");const d=n.div(n.ONE,n.mul(n.ONE,da));function U(j,p,Y,ne){const se=n.sqr(Y),W=n.sqr(ne),te=n.mulByB(n.mul(W,Rr)),y=n.mul(te,Rr),b=n.sub(n.sub(n.sqr(n.add(Y,ne)),W),se),m=n.sub(te,se),B=n.mul(n.sqr(p),Rr),T=n.neg(b);return j.push([m,B,T]),p=n.mul(n.mul(n.mul(n.sub(se,y),p),Y),d),Y=n.sub(n.sqr(n.mul(n.add(se,y),d)),n.mul(n.sqr(te),Rr)),ne=n.mul(se,b),{Rx:p,Ry:Y,Rz:ne}}function P(j,p,Y,ne,se,W){const te=n.sub(Y,n.mul(W,ne)),y=n.sub(p,n.mul(se,ne)),b=n.sub(n.mul(te,se),n.mul(y,W)),m=n.neg(te),B=y;j.push([b,m,B]);const T=n.sqr(y),N=n.mul(T,y),f=n.mul(T,p),s=n.add(n.sub(N,n.mul(f,da)),n.mul(n.sqr(te),ne));return p=n.mul(y,s),Y=n.sub(n.mul(n.sub(f,s),te),n.mul(N,Y)),ne=n.mul(ne,N),{Rx:p,Ry:Y,Rz:ne}}const R=b0(r.params.ateLoopSize),k=dn(j=>{const p=j,{x:Y,y:ne}=p.toAffine(),se=Y,W=ne,te=n.neg(ne);let y=se,b=W,m=n.ONE;const B=[];for(const T of R){const N=[];({Rx:y,Ry:b,Rz:m}=U(N,y,b,m)),T&&({Rx:y,Ry:b,Rz:m}=P(N,y,b,m,se,T===-1?te:W)),B.push(N)}if(r.postPrecompute){const T=B[B.length-1];r.postPrecompute(y,b,m,se,W,P.bind(null,T))}return B});function C(j,p=!1){let Y=o.ONE;if(j.length){const ne=j[0][0].length;for(let se=0;se<ne;se++){Y=o.sqr(Y);for(const[W,te,y]of j)for(const[b,m,B]of W[se])Y=A(b,m,B,Y,te,y)}}return c&&(Y=o.conjugate(Y)),p?o.finalExponentiate(Y):Y}function F(j,p=!0){const Y=[];w.ProjectivePoint.normalizeZ(j.map(({g1:ne})=>ne)),v.ProjectivePoint.normalizeZ(j.map(({g2:ne})=>ne));for(const{g1:ne,g2:se}of j){if(ne.equals(w.ProjectivePoint.ZERO)||se.equals(v.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ne.assertValidity(),se.assertValidity();const W=ne.toAffine();Y.push([k(se),W.x,W.y])}return C(Y,p)}function O(j,p,Y=!0){return F([{g1:j,g2:p}],Y)}const Z={randomPrivateKey:()=>{const j=uc(t.ORDER);return c0(r.randomBytes(j),t.ORDER)},calcPairingPrecomputes:k},{ShortSignature:q}=r.G1,{Signature:$}=r.G2;function K(j){return j instanceof w.ProjectivePoint?j:w.ProjectivePoint.fromHex(j)}function z(j,p){return j instanceof w.ProjectivePoint?j:w.hashToCurve(tt("point",j),p)}function V(j){return j instanceof v.ProjectivePoint?j:$.fromHex(j)}function ae(j,p){return j instanceof v.ProjectivePoint?j:v.hashToCurve(tt("point",j),p)}function _(j){return w.ProjectivePoint.fromPrivateKey(j).toRawBytes(!0)}function S(j){return v.ProjectivePoint.fromPrivateKey(j).toRawBytes(!0)}function M(j,p,Y){const ne=ae(j,Y);ne.assertValidity();const se=ne.multiply(w.normPrivateKeyToScalar(p));return j instanceof v.ProjectivePoint?se:$.toRawBytes(se)}function H(j,p,Y){const ne=z(j,Y);ne.assertValidity();const se=ne.multiply(w.normPrivateKeyToScalar(p));return j instanceof w.ProjectivePoint?se:q.toRawBytes(se)}function Q(j,p,Y,ne){const se=K(Y),W=ae(p,ne),te=w.ProjectivePoint.BASE,y=V(j),b=F([{g1:se.negate(),g2:W},{g1:te,g2:y}]);return o.eql(b,o.ONE)}function G(j,p,Y,ne){const se=V(Y),W=z(p,ne),te=v.ProjectivePoint.BASE,y=K(j),b=F([{g1:W,g2:se},{g1:y,g2:te.negate()}]);return o.eql(b,o.ONE)}function D(j){if(!Array.isArray(j)||j.length===0)throw new Error("expected non-empty array")}function re(j){D(j);const Y=j.map(K).reduce((ne,se)=>ne.add(se),w.ProjectivePoint.ZERO);return j[0]instanceof w.ProjectivePoint?(Y.assertValidity(),Y):Y.toRawBytes(!0)}function ie(j){D(j);const Y=j.map(V).reduce((ne,se)=>ne.add(se),v.ProjectivePoint.ZERO);return j[0]instanceof v.ProjectivePoint?(Y.assertValidity(),Y):$.toRawBytes(Y)}function oe(j){D(j);const Y=j.map(K).reduce((ne,se)=>ne.add(se),w.ProjectivePoint.ZERO);return j[0]instanceof w.ProjectivePoint?(Y.assertValidity(),Y):q.toRawBytes(Y)}function fe(j,p,Y,ne){if(D(p),Y.length!==p.length)throw new Error("amount of public keys and messages should be equal");const se=V(j),W=p.map(m=>ae(m,ne)),te=Y.map(K),y=new Map;for(let m=0;m<te.length;m++){const B=te[m],T=W[m];let N=y.get(T);N===void 0&&(N=[],y.set(T,N)),N.push(B)}const b=[];try{for(const[m,B]of y){const T=B.reduce((N,f)=>N.add(f));b.push({g1:T,g2:m})}return b.push({g1:w.ProjectivePoint.BASE.negate(),g2:se}),o.eql(F(b),o.ONE)}catch{return!1}}return w.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:_,getPublicKeyForShortSignatures:S,sign:M,signShortSignature:H,verify:Q,verifyBatch:fe,verifyShortSignature:G,aggregatePublicKeys:re,aggregateSignatures:ie,aggregateShortSignatures:oe,millerLoopBatch:C,pairing:O,pairingBatch:F,G1:w,G2:v,Signature:$,ShortSignature:q,fields:{Fr:t,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:r.params.ateLoopSize,r:r.params.r,G1b:r.G1.b,G2b:r.G2.b},utils:Z}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0=BigInt(0),Pr=BigInt(1),Ut=BigInt(2),ha=BigInt(3);function $i(r,e,t,n,i=1,o){const c=BigInt(o===void 0?n:o),u=t**BigInt(n),h=[];for(let w=0;w<i;w++){const x=BigInt(w+1),v=[];for(let A=0,d=Pr;A<n;A++){const U=(x*d-x)/c%u;v.push(r.pow(e,U)),d*=t}h.push(v)}return h}function x0(r,e,t){const n=e.pow(t,(r.ORDER-Pr)/ha),i=e.pow(t,(r.ORDER-Pr)/Ut);function o(A,d){const U=e.mul(e.frobeniusMap(A,1),n),P=e.mul(e.frobeniusMap(d,1),i);return[U,P]}const c=e.pow(t,(r.ORDER**Ut-Pr)/ha),u=e.pow(t,(r.ORDER**Ut-Pr)/Ut);if(!e.eql(u,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function h(A,d){return[e.mul(A,c),e.neg(d)]}const w=A=>(d,U)=>{const P=U.toAffine(),R=A(P.x,P.y);return d.fromAffine({x:R[0],y:R[1]})},x=w(o),v=w(h);return{psi:o,psi2:h,G2psi:x,G2psi2:v,PSI_X:n,PSI_Y:i,PSI2_X:c,PSI2_Y:u}}function E0(r){const{ORDER:e}=r,t=Vr(e),n=t.create(r.NONRESIDUE||BigInt(-1)),i=t.div(t.ONE,Ut),o=$i(t,n,t.ORDER,2)[0],c=({c0:_,c1:S},{c0:M,c1:H})=>({c0:t.add(_,M),c1:t.add(S,H)}),u=({c0:_,c1:S},{c0:M,c1:H})=>({c0:t.sub(_,M),c1:t.sub(S,H)}),h=({c0:_,c1:S},M)=>{if(typeof M=="bigint")return{c0:t.mul(_,M),c1:t.mul(S,M)};const{c0:H,c1:Q}=M;let G=t.mul(_,H),D=t.mul(S,Q);const re=t.sub(G,D),ie=t.sub(t.mul(t.add(_,S),t.add(H,Q)),t.add(G,D));return{c0:re,c1:ie}},w=({c0:_,c1:S})=>{const M=t.add(_,S),H=t.sub(_,S),Q=t.add(_,_);return{c0:t.mul(M,H),c1:t.mul(Q,S)}},x=_=>{if(_.length!==2)throw new Error("invalid tuple");const S=_.map(M=>t.create(M));return{c0:S[0],c1:S[1]}},v=e*e,A=x(r.FP2_NONRESIDUE),d={ORDER:v,isLE:t.isLE,NONRESIDUE:A,BITS:an(v),BYTES:Math.ceil(an(v)/8),MASK:Lr(an(v)),ZERO:{c0:t.ZERO,c1:t.ZERO},ONE:{c0:t.ONE,c1:t.ZERO},create:_=>_,isValid:({c0:_,c1:S})=>typeof _=="bigint"&&typeof S=="bigint",is0:({c0:_,c1:S})=>t.is0(_)&&t.is0(S),eql:({c0:_,c1:S},{c0:M,c1:H})=>t.eql(_,M)&&t.eql(S,H),neg:({c0:_,c1:S})=>({c0:t.neg(_),c1:t.neg(S)}),pow:(_,S)=>kn(d,_,S),invertBatch:_=>er(d,_),add:c,sub:u,mul:h,sqr:w,addN:c,subN:u,mulN:h,sqrN:w,div:(_,S)=>d.mul(_,typeof S=="bigint"?t.inv(t.create(S)):d.inv(S)),inv:({c0:_,c1:S})=>{const M=t.inv(t.create(_*_+S*S));return{c0:t.mul(M,t.create(_)),c1:t.mul(M,t.create(-S))}},sqrt:_=>{if(r.Fp2sqrt)return r.Fp2sqrt(_);const{c0:S,c1:M}=_;if(t.is0(M))return us(t,S)===1?d.create({c0:t.sqrt(S),c1:t.ZERO}):d.create({c0:t.ZERO,c1:t.sqrt(t.div(S,n))});const H=t.sqrt(t.sub(t.sqr(S),t.mul(t.sqr(M),n)));let Q=t.mul(t.add(H,S),i);us(t,Q)===-1&&(Q=t.sub(Q,H));const D=t.sqrt(Q),re=d.create({c0:D,c1:t.div(t.mul(M,i),D)});if(!d.eql(d.sqr(re),_))throw new Error("Cannot find square root");const ie=re,oe=d.neg(ie),{re:fe,im:j}=d.reim(ie),{re:p,im:Y}=d.reim(oe);return j>Y||j===Y&&fe>p?ie:oe},isOdd:_=>{const{re:S,im:M}=d.reim(_),H=S%Ut,Q=S===_0,G=M%Ut;return BigInt(H||Q&&G)==Pr},fromBytes(_){if(_.length!==d.BYTES)throw new Error("fromBytes invalid length="+_.length);return{c0:t.fromBytes(_.subarray(0,t.BYTES)),c1:t.fromBytes(_.subarray(t.BYTES))}},toBytes:({c0:_,c1:S})=>Fe(t.toBytes(_),t.toBytes(S)),cmov:({c0:_,c1:S},{c0:M,c1:H},Q)=>({c0:t.cmov(_,M,Q),c1:t.cmov(S,H,Q)}),reim:({c0:_,c1:S})=>({re:_,im:S}),mulByNonresidue:({c0:_,c1:S})=>d.mul({c0:_,c1:S},A),mulByB:r.Fp2mulByB,fromBigTuple:x,frobeniusMap:({c0:_,c1:S},M)=>({c0:_,c1:t.mul(S,o[M%2])})},U=({c0:_,c1:S,c2:M},{c0:H,c1:Q,c2:G})=>({c0:d.add(_,H),c1:d.add(S,Q),c2:d.add(M,G)}),P=({c0:_,c1:S,c2:M},{c0:H,c1:Q,c2:G})=>({c0:d.sub(_,H),c1:d.sub(S,Q),c2:d.sub(M,G)}),R=({c0:_,c1:S,c2:M},H)=>{if(typeof H=="bigint")return{c0:d.mul(_,H),c1:d.mul(S,H),c2:d.mul(M,H)};const{c0:Q,c1:G,c2:D}=H,re=d.mul(_,Q),ie=d.mul(S,G),oe=d.mul(M,D);return{c0:d.add(re,d.mulByNonresidue(d.sub(d.mul(d.add(S,M),d.add(G,D)),d.add(ie,oe)))),c1:d.add(d.sub(d.mul(d.add(_,S),d.add(Q,G)),d.add(re,ie)),d.mulByNonresidue(oe)),c2:d.sub(d.add(ie,d.mul(d.add(_,M),d.add(Q,D))),d.add(re,oe))}},k=({c0:_,c1:S,c2:M})=>{let H=d.sqr(_),Q=d.mul(d.mul(_,S),Ut),G=d.mul(d.mul(S,M),Ut),D=d.sqr(M);return{c0:d.add(d.mulByNonresidue(G),H),c1:d.add(d.mulByNonresidue(D),Q),c2:d.sub(d.sub(d.add(d.add(Q,d.sqr(d.add(d.sub(_,S),M))),G),H),D)}},[C,F]=$i(d,A,t.ORDER,6,2,3),O={ORDER:d.ORDER,isLE:d.isLE,BITS:3*d.BITS,BYTES:3*d.BYTES,MASK:Lr(3*d.BITS),ZERO:{c0:d.ZERO,c1:d.ZERO,c2:d.ZERO},ONE:{c0:d.ONE,c1:d.ZERO,c2:d.ZERO},create:_=>_,isValid:({c0:_,c1:S,c2:M})=>d.isValid(_)&&d.isValid(S)&&d.isValid(M),is0:({c0:_,c1:S,c2:M})=>d.is0(_)&&d.is0(S)&&d.is0(M),neg:({c0:_,c1:S,c2:M})=>({c0:d.neg(_),c1:d.neg(S),c2:d.neg(M)}),eql:({c0:_,c1:S,c2:M},{c0:H,c1:Q,c2:G})=>d.eql(_,H)&&d.eql(S,Q)&&d.eql(M,G),sqrt:ta,div:(_,S)=>O.mul(_,typeof S=="bigint"?t.inv(t.create(S)):O.inv(S)),pow:(_,S)=>kn(O,_,S),invertBatch:_=>er(O,_),add:U,sub:P,mul:R,sqr:k,addN:U,subN:P,mulN:R,sqrN:k,inv:({c0:_,c1:S,c2:M})=>{let H=d.sub(d.sqr(_),d.mulByNonresidue(d.mul(M,S))),Q=d.sub(d.mulByNonresidue(d.sqr(M)),d.mul(_,S)),G=d.sub(d.sqr(S),d.mul(_,M)),D=d.inv(d.add(d.mulByNonresidue(d.add(d.mul(M,Q),d.mul(S,G))),d.mul(_,H)));return{c0:d.mul(D,H),c1:d.mul(D,Q),c2:d.mul(D,G)}},fromBytes:_=>{if(_.length!==O.BYTES)throw new Error("fromBytes invalid length="+_.length);return{c0:d.fromBytes(_.subarray(0,d.BYTES)),c1:d.fromBytes(_.subarray(d.BYTES,2*d.BYTES)),c2:d.fromBytes(_.subarray(2*d.BYTES))}},toBytes:({c0:_,c1:S,c2:M})=>Fe(d.toBytes(_),d.toBytes(S),d.toBytes(M)),cmov:({c0:_,c1:S,c2:M},{c0:H,c1:Q,c2:G},D)=>({c0:d.cmov(_,H,D),c1:d.cmov(S,Q,D),c2:d.cmov(M,G,D)}),fromBigSix:_=>{if(!Array.isArray(_)||_.length!==6)throw new Error("invalid Fp6 usage");return{c0:d.fromBigTuple(_.slice(0,2)),c1:d.fromBigTuple(_.slice(2,4)),c2:d.fromBigTuple(_.slice(4,6))}},frobeniusMap:({c0:_,c1:S,c2:M},H)=>({c0:d.frobeniusMap(_,H),c1:d.mul(d.frobeniusMap(S,H),C[H%6]),c2:d.mul(d.frobeniusMap(M,H),F[H%6])}),mulByFp2:({c0:_,c1:S,c2:M},H)=>({c0:d.mul(_,H),c1:d.mul(S,H),c2:d.mul(M,H)}),mulByNonresidue:({c0:_,c1:S,c2:M})=>({c0:d.mulByNonresidue(M),c1:_,c2:S}),mul1:({c0:_,c1:S,c2:M},H)=>({c0:d.mulByNonresidue(d.mul(M,H)),c1:d.mul(_,H),c2:d.mul(S,H)}),mul01({c0:_,c1:S,c2:M},H,Q){let G=d.mul(_,H),D=d.mul(S,Q);return{c0:d.add(d.mulByNonresidue(d.sub(d.mul(d.add(S,M),Q),D)),G),c1:d.sub(d.sub(d.mul(d.add(H,Q),d.add(_,S)),G),D),c2:d.add(d.sub(d.mul(d.add(_,M),H),G),D)}}},Z=$i(d,A,t.ORDER,12,1,6)[0],q=({c0:_,c1:S},{c0:M,c1:H})=>({c0:O.add(_,M),c1:O.add(S,H)}),$=({c0:_,c1:S},{c0:M,c1:H})=>({c0:O.sub(_,M),c1:O.sub(S,H)}),K=({c0:_,c1:S},M)=>{if(typeof M=="bigint")return{c0:O.mul(_,M),c1:O.mul(S,M)};let{c0:H,c1:Q}=M,G=O.mul(_,H),D=O.mul(S,Q);return{c0:O.add(G,O.mulByNonresidue(D)),c1:O.sub(O.mul(O.add(_,S),O.add(H,Q)),O.add(G,D))}},z=({c0:_,c1:S})=>{let M=O.mul(_,S);return{c0:O.sub(O.sub(O.mul(O.add(O.mulByNonresidue(S),_),O.add(_,S)),M),O.mulByNonresidue(M)),c1:O.add(M,M)}};function V(_,S){const M=d.sqr(_),H=d.sqr(S);return{first:d.add(d.mulByNonresidue(H),M),second:d.sub(d.sub(d.sqr(d.add(_,S)),M),H)}}const ae={ORDER:d.ORDER,isLE:O.isLE,BITS:2*O.BITS,BYTES:2*O.BYTES,MASK:Lr(2*O.BITS),ZERO:{c0:O.ZERO,c1:O.ZERO},ONE:{c0:O.ONE,c1:O.ZERO},create:_=>_,isValid:({c0:_,c1:S})=>O.isValid(_)&&O.isValid(S),is0:({c0:_,c1:S})=>O.is0(_)&&O.is0(S),neg:({c0:_,c1:S})=>({c0:O.neg(_),c1:O.neg(S)}),eql:({c0:_,c1:S},{c0:M,c1:H})=>O.eql(_,M)&&O.eql(S,H),sqrt:ta,inv:({c0:_,c1:S})=>{let M=O.inv(O.sub(O.sqr(_),O.mulByNonresidue(O.sqr(S))));return{c0:O.mul(_,M),c1:O.neg(O.mul(S,M))}},div:(_,S)=>ae.mul(_,typeof S=="bigint"?t.inv(t.create(S)):ae.inv(S)),pow:(_,S)=>kn(ae,_,S),invertBatch:_=>er(ae,_),add:q,sub:$,mul:K,sqr:z,addN:q,subN:$,mulN:K,sqrN:z,fromBytes:_=>{if(_.length!==ae.BYTES)throw new Error("fromBytes invalid length="+_.length);return{c0:O.fromBytes(_.subarray(0,O.BYTES)),c1:O.fromBytes(_.subarray(O.BYTES))}},toBytes:({c0:_,c1:S})=>Fe(O.toBytes(_),O.toBytes(S)),cmov:({c0:_,c1:S},{c0:M,c1:H},Q)=>({c0:O.cmov(_,M,Q),c1:O.cmov(S,H,Q)}),fromBigTwelve:_=>({c0:O.fromBigSix(_.slice(0,6)),c1:O.fromBigSix(_.slice(6,12))}),frobeniusMap(_,S){const{c0:M,c1:H,c2:Q}=O.frobeniusMap(_.c1,S),G=Z[S%12];return{c0:O.frobeniusMap(_.c0,S),c1:O.create({c0:d.mul(M,G),c1:d.mul(H,G),c2:d.mul(Q,G)})}},mulByFp2:({c0:_,c1:S},M)=>({c0:O.mulByFp2(_,M),c1:O.mulByFp2(S,M)}),conjugate:({c0:_,c1:S})=>({c0:_,c1:O.neg(S)}),mul014:({c0:_,c1:S},M,H,Q)=>{let G=O.mul01(_,M,H),D=O.mul1(S,Q);return{c0:O.add(O.mulByNonresidue(D),G),c1:O.sub(O.sub(O.mul01(O.add(S,_),M,d.add(H,Q)),G),D)}},mul034:({c0:_,c1:S},M,H,Q)=>{const G=O.create({c0:d.mul(_.c0,M),c1:d.mul(_.c1,M),c2:d.mul(_.c2,M)}),D=O.mul01(S,H,Q),re=O.mul01(O.add(_,S),d.add(M,H),Q);return{c0:O.add(O.mulByNonresidue(D),G),c1:O.sub(re,O.add(G,D))}},_cyclotomicSquare:r.Fp12cyclotomicSquare,_cyclotomicExp:r.Fp12cyclotomicExp,finalExponentiate:r.Fp12finalExponentiate};return{Fp:t,Fp2:d,Fp6:O,Fp4Square:V,Fp12:ae}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const et=BigInt(0),li=BigInt(1),qe=BigInt(2),Un=BigInt(3),on=BigInt(4),zt=BigInt("0xd201000000010000"),v0=an(zt),{Fp:ce,Fp2:le,Fp6:ls,Fp4Square:qi,Fp12:ye}=E0({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[li,li],Fp2mulByB:({c0:r,c1:e})=>{const t=ce.mul(r,on),n=ce.mul(e,on);return{c0:ce.sub(t,n),c1:ce.add(t,n)}},Fp12cyclotomicSquare:({c0:r,c1:e})=>{const{c0:t,c1:n,c2:i}=r,{c0:o,c1:c,c2:u}=e,{first:h,second:w}=qi(t,c),{first:x,second:v}=qi(o,i),{first:A,second:d}=qi(n,u),U=le.mulByNonresidue(d);return{c0:ls.create({c0:le.add(le.mul(le.sub(h,t),qe),h),c1:le.add(le.mul(le.sub(x,n),qe),x),c2:le.add(le.mul(le.sub(A,i),qe),A)}),c1:ls.create({c0:le.add(le.mul(le.add(U,o),qe),U),c1:le.add(le.mul(le.add(w,c),qe),w),c2:le.add(le.mul(le.add(v,u),qe),v)})}},Fp12cyclotomicExp(r,e){let t=ye.ONE;for(let n=v0-1;n>=0;n--)t=ye._cyclotomicSquare(t),t0(e,n)&&(t=ye.mul(t,r));return t},Fp12finalExponentiate:r=>{const e=zt,t=ye.div(ye.frobeniusMap(r,6),r),n=ye.mul(ye.frobeniusMap(t,2),t),i=ye.conjugate(ye._cyclotomicExp(n,e)),o=ye.mul(ye.conjugate(ye._cyclotomicSquare(n)),i),c=ye.conjugate(ye._cyclotomicExp(o,e)),u=ye.conjugate(ye._cyclotomicExp(c,e)),h=ye.mul(ye.conjugate(ye._cyclotomicExp(u,e)),ye._cyclotomicSquare(i)),w=ye.conjugate(ye._cyclotomicExp(h,e)),x=ye.frobeniusMap(ye.mul(i,u),2),v=ye.frobeniusMap(ye.mul(c,n),3),A=ye.frobeniusMap(ye.mul(h,ye.conjugate(n)),1),d=ye.mul(ye.mul(w,ye.conjugate(o)),n);return ye.mul(ye.mul(ye.mul(x,v),A),d)}}),pa=Vr(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),I0=fc(le,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(r=>r.map(e=>le.fromBigTuple(e.map(BigInt))))),A0=fc(ce,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(r=>r.map(e=>BigInt(e)))),S0=wc(le,{A:le.create({c0:ce.create(et),c1:ce.create(BigInt(240))}),B:le.create({c0:ce.create(BigInt(1012)),c1:ce.create(BigInt(1012))}),Z:le.create({c0:ce.create(BigInt(-2)),c1:ce.create(BigInt(-1))})}),T0=wc(ce,{A:ce.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ce.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ce.create(BigInt(11))}),{G2psi:ya,G2psi2:B0}=x0(ce,le,le.div(le.ONE,le.NONRESIDUE)),Gi=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ce.ORDER,m:2,k:128,expand:"xmd",hash:xs}),di=pn(ce.toBytes(et),{infinity:!0,compressed:!0});function Rn(r){r=r.slice();const e=r[0]&224,t=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return r[0]&=31,{compressed:t,infinity:n,sort:i,value:r}}function pn(r,e){if(r[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(r[0]|=128),e.infinity&&(r[0]|=64),e.sort&&(r[0]|=32),r}function wa(r){r.assertValidity();const e=r.equals(at.G1.ProjectivePoint.ZERO),{x:t,y:n}=r.toAffine();if(e)return di.slice();const i=ce.ORDER,o=!!(n*qe/i);return pn(Ke(t,ce.BYTES),{compressed:!0,sort:o})}function ga(r){r.assertValidity();const e=ce.BYTES;if(r.equals(at.G2.ProjectivePoint.ZERO))return Fe(di,Ke(et,e));const{x:t,y:n}=r.toAffine(),{re:i,im:o}=le.reim(t),{re:c,im:u}=le.reim(n),w=!!((u>et?u*qe:c*qe)/ce.ORDER&li),x=i;return Fe(pn(Ke(o,e),{sort:w,compressed:!0}),Ke(x,e))}const at=m0({fields:{Fp:ce,Fp2:le,Fp6:ls,Fp12:ye,Fr:pa},G1:{Fp:ce,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ce.ZERO,b:on,htfDefaults:{...Gi,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(r,e)=>{const t=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new r(ce.mul(e.px,t),e.py,e.pz);return e.multiplyUnsafe(zt).negate().multiplyUnsafe(zt).equals(n)},clearCofactor:(r,e)=>e.multiplyUnsafe(zt).add(e),mapToCurve:r=>{const{x:e,y:t}=T0(ce.create(r[0]));return A0(e,t)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=Rn(r);if(i.length===48&&e){const o=ce.ORDER,c=dt(i),u=ce.create(c&ce.MASK);if(t){if(u!==et)throw new Error("G1: non-empty compressed point at infinity");return{x:et,y:et}}const h=ce.add(ce.pow(u,Un),ce.create(at.params.G1b));let w=ce.sqrt(h);if(!w)throw new Error("invalid compressed G1 point");return w*qe/o!==BigInt(n)&&(w=ce.neg(w)),{x:ce.create(u),y:ce.create(w)}}else if(i.length===96&&!e){const o=dt(i.subarray(0,ce.BYTES)),c=dt(i.subarray(ce.BYTES));if(t){if(o!==et||c!==et)throw new Error("G1: non-empty point at infinity");return at.G1.ProjectivePoint.ZERO.toAffine()}return{x:ce.create(o),y:ce.create(c)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(r,e,t)=>{const n=e.equals(r.ZERO),{x:i,y:o}=e.toAffine();if(t){if(n)return di.slice();const c=ce.ORDER,u=!!(o*qe/c);return pn(Ke(i,ce.BYTES),{compressed:!0,sort:u})}else return n?Fe(new Uint8Array([64]),new Uint8Array(2*ce.BYTES-1)):Fe(Ke(i,ce.BYTES),Ke(o,ce.BYTES))},ShortSignature:{fromHex(r){const{infinity:e,sort:t,value:n}=Rn(tt("signatureHex",r,48)),i=ce.ORDER,o=dt(n);if(e)return at.G1.ProjectivePoint.ZERO;const c=ce.create(o&ce.MASK),u=ce.add(ce.pow(c,Un),ce.create(at.params.G1b));let h=ce.sqrt(u);if(!h)throw new Error("invalid compressed G1 point");const w=BigInt(t);h*qe/i!==w&&(h=ce.neg(h));const x=at.G1.ProjectivePoint.fromAffine({x:c,y:h});return x.assertValidity(),x},toRawBytes(r){return wa(r)},toHex(r){return gr(wa(r))}}},G2:{Fp:le,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:le.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:le.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:le.ZERO,b:le.fromBigTuple([on,on]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Gi},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:r=>{const{x:e,y:t}=S0(le.fromBigTuple(r));return I0(e,t)},isTorsionFree:(r,e)=>e.multiplyUnsafe(zt).negate().equals(ya(r,e)),clearCofactor:(r,e)=>{const t=zt;let n=e.multiplyUnsafe(t).negate(),i=ya(r,e),o=e.double();return o=B0(r,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(t).negate(),o=o.add(i),o=o.subtract(n),o.subtract(e)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=Rn(r);if(!e&&!t&&n||!e&&t&&n||n&&t&&e)throw new Error("invalid encoding flag: "+(r[0]&224));const o=ce.BYTES,c=(u,h,w)=>dt(u.slice(h,w));if(i.length===96&&e){const u=at.params.G2b,h=ce.ORDER;if(t){if(i.reduce((P,R)=>P!==0?R+1:R,0)>0)throw new Error("invalid compressed G2 point");return{x:le.ZERO,y:le.ZERO}}const w=c(i,0,o),x=c(i,o,2*o),v=le.create({c0:ce.create(x),c1:ce.create(w)}),A=le.add(le.pow(v,Un),u);let d=le.sqrt(A);const U=d.c1===et?d.c0*qe/h:d.c1*qe/h?li:et;return d=n&&U>0?d:le.neg(d),{x:v,y:d}}else if(i.length===192&&!e){if(t){if(i.reduce((v,A)=>v!==0?A+1:A,0)>0)throw new Error("invalid uncompressed G2 point");return{x:le.ZERO,y:le.ZERO}}const u=c(i,0,o),h=c(i,o,2*o),w=c(i,2*o,3*o),x=c(i,3*o,4*o);return{x:le.fromBigTuple([h,u]),y:le.fromBigTuple([x,w])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(r,e,t)=>{const{BYTES:n,ORDER:i}=ce,o=e.equals(r.ZERO),{x:c,y:u}=e.toAffine();if(t){if(o)return Fe(di,Ke(et,n));const h=!!(u.c1===et?u.c0*qe/i:u.c1*qe/i);return Fe(pn(Ke(c.c1,n),{compressed:!0,sort:h}),Ke(c.c0,n))}else{if(o)return Fe(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:h,im:w}=le.reim(c),{re:x,im:v}=le.reim(u);return Fe(Ke(w,n),Ke(h,n),Ke(v,n),Ke(x,n))}},Signature:{fromHex(r){const{infinity:e,sort:t,value:n}=Rn(tt("signatureHex",r)),i=ce.ORDER,o=n.length/2;if(o!==48&&o!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const c=dt(n.slice(0,o)),u=dt(n.slice(o));if(e)return at.G2.ProjectivePoint.ZERO;const h=ce.create(c&ce.MASK),w=ce.create(u),x=le.create({c0:w,c1:h}),v=le.add(le.pow(x,Un),at.params.G2b);let A=le.sqrt(v);if(!A)throw new Error("Failed to find a square root");const{re:d,im:U}=le.reim(A),P=BigInt(t),R=U>et&&U*qe/i!==P,k=U===et&&d*qe/i!==P;(R||k)&&(A=le.neg(A));const C=at.G2.ProjectivePoint.fromAffine({x,y:A});return C.assertValidity(),C},toRawBytes(r){return ga(r)},toHex(r){return gr(ga(r))}}},params:{ateLoopSize:zt,r:pa.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Gi,hash:xs,randomBytes:Ha});function N0(r,e,t){const n=typeof r=="string"?r:Pe(r),i=typeof e=="string"?e:Pe(e),o=typeof t=="string"?t:Pe(t);return at.verifyShortSignature(i,o,n)}const gc=r=>$e(new Gr(r)),Ps=r=>{const e=gc(r);return new Date(Number(e)/1e6)};var O0=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},U0=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Cn;class It extends Me{constructor(e){super(`Invalid certificate: ${e}`)}}var st;(function(r){r[r.Empty=0]="Empty",r[r.Fork=1]="Fork",r[r.Labeled=2]="Labeled",r[r.Leaf=3]="Leaf",r[r.Pruned=4]="Pruned"})(st||(st={}));function R0(r,e){const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]>n[i])return!0;return!1}class cn{constructor(e,t,n,i,o=5,c=!1){this._rootKey=t,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=o,Cn.set(this,!1),O0(this,Cn,c,"f"),this.cert=Ft(new Uint8Array(e))}static async create(e){const t=cn.createUnverified(e);return await t.verify(),t}static createUnverified(e){let t=e.blsVerify;return t||(t=N0),new cn(e.certificate,e.rootKey,e.canisterId,t,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return qr(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await $n(this.cert.tree),t=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=F0(t),o=pt(Zr("ic-state-root"),e);let c=!1;const u=ds(this.lookup(["time"]));if(!u)throw new It("Certificate does not contain a time");if(!U0(this,Cn,"f")){const w=this._maxAgeInMinutes*60*1e3,x=Date.now(),v=x-w,A=x+3e5,d=Ps(u);if(d.getTime()<v)throw new It(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+d.toISOString()+" Current time: "+new Date(x).toISOString());if(d.getTime()>A)throw new It("Certificate is signed more than 5 minutes in the future. Certificate time: "+d.toISOString()+" Current time: "+new Date(x).toISOString())}try{c=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(o))}catch{c=!1}if(!c)throw new It("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const t=await cn.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(t.cert.delegation)throw new It("Delegation certificates cannot be nested");if(await t.verify(),this._canisterId.toString()!==tl&&!bc({canisterId:this._canisterId,subnetId:Ee.fromUint8Array(new Uint8Array(e.subnet_id)),tree:t.cert.tree}))throw new It(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Pe(e.subnet_id)}`);const n=ds(t.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${Pe(e.subnet_id)}`);return n}}Cn=new WeakMap;const Wr=Mt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),P0=96;function F0(r){const e=Wr.byteLength+P0;if(r.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const t=r.slice(0,Wr.byteLength);if(!wn(t,Wr))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Wr}, but get ${t}`);return r.slice(Wr.byteLength)}function ds(r){if(r.status===Le.Found){if(r.value instanceof ArrayBuffer)return r.value;if(r.value instanceof Uint8Array)return r.value.buffer}}async function $n(r){switch(r[0]){case st.Empty:return ht(Zr("ic-hashtree-empty"));case st.Pruned:return r[1];case st.Leaf:return ht(pt(Zr("ic-hashtree-leaf"),r[1]));case st.Labeled:return ht(pt(Zr("ic-hashtree-labeled"),r[1],await $n(r[2])));case st.Fork:return ht(pt(Zr("ic-hashtree-fork"),await $n(r[1]),await $n(r[2])));default:throw new Error("unreachable")}}function Zr(r){const e=new Uint8Array([r.length]),t=new TextEncoder().encode(r);return pt(e,t)}var Le;(function(r){r.Unknown="unknown",r.Absent="absent",r.Found="found"})(Le||(Le={}));var Rt;(function(r){r.Less="less",r.Greater="greater"})(Rt||(Rt={}));function qr(r,e){if(r.length===0)switch(e[0]){case st.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Le.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Le.Found,value:e[1].buffer}:{status:Le.Found,value:e[1]}}default:return{status:Le.Found,value:e}}const t=typeof r[0]=="string"?new TextEncoder().encode(r[0]):r[0],n=qn(t,e);switch(n.status){case Le.Found:return qr(r.slice(1),n.value);case Rt.Greater:case Rt.Less:return{status:Le.Absent};default:return n}}function hs(r){switch(r[0]){case st.Empty:return[];case st.Fork:return hs(r[1]).concat(hs(r[2]));default:return[r]}}function qn(r,e){switch(e[0]){case st.Labeled:return R0(r,e[1])?{status:Rt.Greater}:wn(r,e[1])?{status:Le.Found,value:e[2]}:{status:Rt.Less};case st.Fork:const t=qn(r,e[1]);switch(t.status){case Rt.Greater:{const n=qn(r,e[2]);return n.status===Rt.Less?{status:Le.Absent}:n}case Le.Unknown:{let n=qn(r,e[2]);return n.status===Rt.Less?{status:Le.Unknown}:n}default:return t}case st.Pruned:return{status:Le.Unknown};default:return{status:Le.Absent}}}function bc(r){const{canisterId:e,subnetId:t,tree:n}=r,i=qr(["subnet",t.toUint8Array(),"canister_ranges"],n);if(i.status!==Le.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${t}`);return Ft(i.value).map(h=>[Ee.fromUint8Array(h[0]),Ee.fromUint8Array(h[1])]).some(h=>h[0].ltEq(e)&&h[1].gtEq(e))}class L0{constructor(e,t,n){this.key=e,this.path=t,this.decodeStrategy=n}}const mc=async r=>{const{agent:e,paths:t}=r,n=Ee.from(r.canisterId),i=[...new Set(t)],o=i.map(h=>ps(h,n)),c=new Map,u=i.map((h,w)=>(async()=>{var x;try{const v=await e.readState(n,{paths:[o[w]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const A=await cn.create({certificate:v.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),d=(R,k)=>{if(k==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const C=_c(v.certificate,n,e.rootKey);return{path:k,data:C}}else return{path:k,data:ds(R.lookup(ps(k,n)))}},{path:U,data:P}=d(A,i[w]);if(!P)console.warn(`Expected to find result for path ${U}, but instead found nothing.`),typeof U=="string"?c.set(U,null):c.set(U.key,null);else switch(U){case"time":{c.set(U,Ps(P));break}case"controllers":{c.set(U,D0(P));break}case"module_hash":{c.set(U,ba(P));break}case"subnet":{c.set(U,P);break}case"candid":{c.set(U,new TextDecoder().decode(P));break}default:if(typeof U!="string"&&"key"in U&&"path"in U)switch(U.decodeStrategy){case"raw":c.set(U.key,P);break;case"leb128":{c.set(U.key,gc(P));break}case"cbor":{c.set(U.key,xc(P));break}case"hex":{c.set(U.key,ba(P));break}case"utf-8":c.set(U.key,M0(P))}}}catch(v){if(!((x=v?.message)===null||x===void 0)&&x.includes("Invalid certificate"))throw new Me(v.message);typeof h!="string"&&"key"in h&&"path"in h?c.set(h.key,null):c.set(h,null),console.group(),console.warn(`Expected to find result for path ${h}, but instead found nothing.`),console.warn(v),console.groupEnd()}})());return await Promise.all(u),c},_c=(r,e,t)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=Ft(new Uint8Array(r)),i=n.tree;let o=n.delegation,c;if(o&&o.subnet_id?c=Ee.fromUint8Array(new Uint8Array(o.subnet_id)):!o&&typeof t<"u"?(c=Ee.selfAuthenticating(new Uint8Array(t)),o={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}):(c=Ee.selfAuthenticating(Ee.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),o={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}),!bc({canisterId:e,subnetId:c,tree:i}))throw new Error("Canister not in range");const h=qr(["subnet",o.subnet_id,"node"],i);if(h.status!==Le.Found)throw new Error("Node not found");if(h.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const w=hs(h.value),x=new Map;return w.forEach(v=>{const A=Ee.from(new Uint8Array(v[1])).toText(),d=qr(["public_key"],v[2]);if(d.status!==Le.Found)throw new Error("Public key not found");const U=d.value;if(U.byteLength!==44)throw new Error("Invalid public key length");x.set(A,U)}),{subnetId:Ee.fromUint8Array(new Uint8Array(o.subnet_id)).toText(),nodeKeys:x}},ps=(r,e)=>{const t=new TextEncoder,n=o=>new DataView(t.encode(o).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(r){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in r&&"path"in r)if(typeof r.path=="string"||r.path instanceof ArrayBuffer){const o=r.path,c=typeof o=="string"?n(o):o;return[n("canister"),i,n("metadata"),c]}else return r.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${r} was formatted correctly.`)},ba=r=>Pe(r),xc=r=>Ft(r),M0=r=>new TextDecoder().decode(r),D0=r=>xc(r).map(t=>Ee.fromUint8Array(new Uint8Array(t))),k0=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:L0,encodePath:ps,fetchNodeKeys:_c,request:mc},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bt=BigInt(0),Je=BigInt(1),ma=BigInt(2),C0=BigInt(8),$0={zip215:!0};function q0(r){const e=yc(r);return _n(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function G0(r){const e=q0(r),{Fp:t,n,prehash:i,hash:o,randomBytes:c,nByteLength:u,h}=e,w=ma<<BigInt(u*8)-Je,x=t.create,v=Vr(e.n,e.nBitLength),A=e.uvRatio||((G,D)=>{try{return{isValid:!0,value:t.sqrt(G*t.inv(D))}}catch{return{isValid:!1,value:bt}}}),d=e.adjustScalarBytes||(G=>G),U=e.domain||((G,D,re)=>{if(nn("phflag",re),D.length||re)throw new Error("Contexts/pre-hash are not supported");return G});function P(G,D,re=!1){const ie=re?Je:bt;Zt("coordinate "+G,D,ie,w)}function R(G){if(!(G instanceof F))throw new Error("ExtendedPoint expected")}const k=dn((G,D)=>{const{ex:re,ey:ie,ez:oe}=G,fe=G.is0();D==null&&(D=fe?C0:t.inv(oe));const j=x(re*D),p=x(ie*D),Y=x(oe*D);if(fe)return{x:bt,y:Je};if(Y!==Je)throw new Error("invZ was invalid");return{x:j,y:p}}),C=dn(G=>{const{a:D,d:re}=e;if(G.is0())throw new Error("bad point: ZERO");const{ex:ie,ey:oe,ez:fe,et:j}=G,p=x(ie*ie),Y=x(oe*oe),ne=x(fe*fe),se=x(ne*ne),W=x(p*D),te=x(ne*x(W+Y)),y=x(se+x(re*x(p*Y)));if(te!==y)throw new Error("bad point: equation left != right (1)");const b=x(ie*oe),m=x(fe*j);if(b!==m)throw new Error("bad point: equation left != right (2)");return!0});class F{constructor(D,re,ie,oe){P("x",D),P("y",re),P("z",ie,!0),P("t",oe),this.ex=D,this.ey=re,this.ez=ie,this.et=oe,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(D){if(D instanceof F)throw new Error("extended point not allowed");const{x:re,y:ie}=D||{};return P("x",re),P("y",ie),new F(re,ie,Je,x(re*ie))}static normalizeZ(D){const re=er(t,D.map(ie=>ie.ez));return D.map((ie,oe)=>ie.toAffine(re[oe])).map(F.fromAffine)}static msm(D,re){return pc(F,v,D,re)}_setWindowSize(D){q.setWindowSize(this,D)}assertValidity(){C(this)}equals(D){R(D);const{ex:re,ey:ie,ez:oe}=this,{ex:fe,ey:j,ez:p}=D,Y=x(re*p),ne=x(fe*oe),se=x(ie*p),W=x(j*oe);return Y===ne&&se===W}is0(){return this.equals(F.ZERO)}negate(){return new F(x(-this.ex),this.ey,this.ez,x(-this.et))}double(){const{a:D}=e,{ex:re,ey:ie,ez:oe}=this,fe=x(re*re),j=x(ie*ie),p=x(ma*x(oe*oe)),Y=x(D*fe),ne=re+ie,se=x(x(ne*ne)-fe-j),W=Y+j,te=W-p,y=Y-j,b=x(se*te),m=x(W*y),B=x(se*y),T=x(te*W);return new F(b,m,T,B)}add(D){R(D);const{a:re,d:ie}=e,{ex:oe,ey:fe,ez:j,et:p}=this,{ex:Y,ey:ne,ez:se,et:W}=D,te=x(oe*Y),y=x(fe*ne),b=x(p*ie*W),m=x(j*se),B=x((oe+fe)*(Y+ne)-te-y),T=m-b,N=m+b,f=x(y-re*te),s=x(B*T),a=x(N*f),l=x(B*f),g=x(T*N);return new F(s,a,g,l)}subtract(D){return this.add(D.negate())}wNAF(D){return q.wNAFCached(this,D,F.normalizeZ)}multiply(D){const re=D;Zt("scalar",re,Je,n);const{p:ie,f:oe}=this.wNAF(re);return F.normalizeZ([ie,oe])[0]}multiplyUnsafe(D,re=F.ZERO){const ie=D;return Zt("scalar",ie,bt,n),ie===bt?Z:this.is0()||ie===Je?this:q.wNAFCachedUnsafe(this,ie,F.normalizeZ,re)}isSmallOrder(){return this.multiplyUnsafe(h).is0()}isTorsionFree(){return q.unsafeLadder(this,n).is0()}toAffine(D){return k(this,D)}clearCofactor(){const{h:D}=e;return D===Je?this:this.multiplyUnsafe(D)}static fromHex(D,re=!1){const{d:ie,a:oe}=e,fe=t.BYTES;D=tt("pointHex",D,fe),nn("zip215",re);const j=D.slice(),p=D[fe-1];j[fe-1]=p&-129;const Y=sn(j),ne=re?w:t.ORDER;Zt("pointHex.y",Y,bt,ne);const se=x(Y*Y),W=x(se-Je),te=x(ie*se-oe);let{isValid:y,value:b}=A(W,te);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const m=(b&Je)===Je,B=(p&128)!==0;if(!re&&b===bt&&B)throw new Error("Point.fromHex: x=0 and x_0=1");return B!==m&&(b=x(-b)),F.fromAffine({x:b,y:Y})}static fromPrivateKey(D){const{scalar:re}=z(D);return O.multiply(re)}toRawBytes(){const{x:D,y:re}=this.toAffine(),ie=ui(re,t.BYTES);return ie[ie.length-1]|=D&Je?128:0,ie}toHex(){return gr(this.toRawBytes())}}F.BASE=new F(e.Gx,e.Gy,Je,x(e.Gx*e.Gy)),F.ZERO=new F(bt,Je,Je,bt);const{BASE:O,ZERO:Z}=F,q=hc(F,u*8);function $(G){return Te(G,n)}function K(G){return $(sn(G))}function z(G){const D=t.BYTES;G=tt("private key",G,D);const re=tt("hashed private key",o(G),2*D),ie=d(re.slice(0,D)),oe=re.slice(D,2*D),fe=K(ie);return{head:ie,prefix:oe,scalar:fe}}function V(G){const{head:D,prefix:re,scalar:ie}=z(G),oe=O.multiply(ie),fe=oe.toRawBytes();return{head:D,prefix:re,scalar:ie,point:oe,pointBytes:fe}}function ae(G){return V(G).pointBytes}function _(G=Uint8Array.of(),...D){const re=Fe(...D);return K(o(U(re,tt("context",G),!!i)))}function S(G,D,re={}){G=tt("message",G),i&&(G=i(G));const{prefix:ie,scalar:oe,pointBytes:fe}=V(D),j=_(re.context,ie,G),p=O.multiply(j).toRawBytes(),Y=_(re.context,p,fe,G),ne=$(j+Y*oe);Zt("signature.s",ne,bt,n);const se=Fe(p,ui(ne,t.BYTES));return tt("result",se,t.BYTES*2)}const M=$0;function H(G,D,re,ie=M){const{context:oe,zip215:fe}=ie,j=t.BYTES;G=tt("signature",G,2*j),D=tt("message",D),re=tt("publicKey",re,j),fe!==void 0&&nn("zip215",fe),i&&(D=i(D));const p=sn(G.slice(j,2*j));let Y,ne,se;try{Y=F.fromHex(re,fe),ne=F.fromHex(G.slice(0,j),fe),se=O.multiplyUnsafe(p)}catch{return!1}if(!fe&&Y.isSmallOrder())return!1;const W=_(oe,ne.toRawBytes(),Y.toRawBytes(),D);return ne.add(Y.multiplyUnsafe(W)).subtract(se).clearCofactor().equals(F.ZERO)}return O._setWindowSize(8),{CURVE:e,getPublicKey:ae,sign:S,verify:H,ExtendedPoint:F,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>c(t.BYTES),precompute(G=8,D=F.BASE){return D._setWindowSize(G),D.multiply(BigInt(3)),D}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fs=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),_a=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const H0=BigInt(1),xa=BigInt(2);BigInt(3);const V0=BigInt(5),K0=BigInt(8);function j0(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),i=BigInt(80),o=Fs,u=r*r%o*r%o,h=gt(u,xa,o)*u%o,w=gt(h,H0,o)*r%o,x=gt(w,V0,o)*w%o,v=gt(x,e,o)*x%o,A=gt(v,t,o)*v%o,d=gt(A,n,o)*A%o,U=gt(d,i,o)*d%o,P=gt(U,i,o)*d%o,R=gt(P,e,o)*x%o;return{pow_p_5_8:gt(R,xa,o)*r%o,b2:u}}function z0(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function W0(r,e){const t=Fs,n=Te(e*e*e,t),i=Te(n*n*e,t),o=j0(r*i).pow_p_5_8;let c=Te(r*n*o,t);const u=Te(e*c*c,t),h=c,w=Te(c*_a,t),x=u===r,v=u===Te(-r,t),A=u===Te(-r*_a,t);return x&&(c=h),(v||A)&&(c=w),a0(c,t)&&(c=Te(-c,t)),{isValid:x||v,value:c}}const Ea=Vr(Fs,void 0,!0),Y0={a:Ea.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ea,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:K0,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Du,randomBytes:Ha,adjustScalarBytes:z0,uvRatio:W0},Ar=G0(Y0);var va=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Qe=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},We,Xr,Ec,vc;class Z0{constructor(e={}){We.set(this,void 0),Xr.set(this,void 0),this[Ec]=this.entries.bind(this),this[vc]="ExpirableMap";const{source:t=[],expirationTime:n=10*60*1e3}=e,i=Date.now();va(this,We,new Map([...t].map(([o,c])=>[o,{value:c,timestamp:i}])),"f"),va(this,Xr,n,"f")}prune(){const e=Date.now();for(const[t,n]of Qe(this,We,"f").entries())e-n.timestamp>Qe(this,Xr,"f")&&Qe(this,We,"f").delete(t);return this}set(e,t){this.prune();const n={value:t,timestamp:Date.now()};return Qe(this,We,"f").set(e,n),this}get(e){const t=Qe(this,We,"f").get(e);if(t!==void 0){if(Date.now()-t.timestamp>Qe(this,Xr,"f")){Qe(this,We,"f").delete(e);return}return t.value}}clear(){Qe(this,We,"f").clear()}entries(){const e=Qe(this,We,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=Qe(this,We,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return Qe(this,We,"f").keys()}forEach(e,t){for(const[n,i]of Qe(this,We,"f").entries())e.call(t,i.value,n,this)}has(e){return Qe(this,We,"f").has(e)}delete(e){return Qe(this,We,"f").delete(e)}get size(){return Qe(this,We,"f").size}}We=new WeakMap,Xr=new WeakMap,Ec=Symbol.iterator,vc=Symbol.toStringTag;const Ia=r=>{if(r<=127)return 1;if(r<=255)return 2;if(r<=65535)return 3;if(r<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Aa=(r,e,t)=>{if(t<=127)return r[e]=t,1;if(t<=255)return r[e]=129,r[e+1]=t,2;if(t<=65535)return r[e]=130,r[e+1]=t>>8,r[e+2]=t,3;if(t<=16777215)return r[e]=131,r[e+1]=t>>16,r[e+2]=t>>8,r[e+3]=t,4;throw new Error("Length too long (> 4 bytes)")},ys=(r,e)=>{if(r[e]<128)return 1;if(r[e]===128)throw new Error("Invalid length 0");if(r[e]===129)return 2;if(r[e]===130)return 3;if(r[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},X0=(r,e)=>{const t=ys(r,e);if(t===1)return r[e];if(t===2)return r[e+1];if(t===3)return(r[e+1]<<8)+r[e+2];if(t===4)return(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const hi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function Ic(r,e){const t=2+Ia(r.byteLength+1),n=e.byteLength+t+r.byteLength;let i=0;const o=new Uint8Array(1+Ia(n)+n);return o[i++]=48,i+=Aa(o,i,n),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=Aa(o,i,r.byteLength+1),o[i++]=0,o.set(new Uint8Array(r),i),o}const Ac=(r,e)=>{let t=0;const n=(u,h)=>{if(i[t++]!==u)throw new Error("Expected: "+h)},i=new Uint8Array(r);if(n(48,"sequence"),t+=ys(i,t),!wn(i.slice(t,t+e.byteLength),e))throw new Error("Not the expected OID.");t+=e.byteLength,n(3,"bit string");const o=X0(i,t)-1;t+=ys(i,t),n(0,"0 padding");const c=i.slice(t);if(o!==c.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${c.length}`);return c};var Sa=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ta=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Gn,Hn;let Sc=class Jr{constructor(e){if(Gn.set(this,void 0),Hn.set(this,void 0),e.byteLength!==Jr.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Sa(this,Gn,e,"f"),Sa(this,Hn,Jr.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new Jr(e)}static fromDer(e){return new Jr(this.derDecode(e))}static derEncode(e){return Ic(e,hi).buffer}static derDecode(e){const t=Ac(e,hi);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return t}get rawKey(){return Ta(this,Gn,"f")}get derKey(){return Ta(this,Hn,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Gn=new WeakMap,Hn=new WeakMap;Sc.RAW_KEY_LENGTH=32;class J0{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(t=>t!==e)}notify(e,...t){this.observers.forEach(n=>n(e,...t))}}class Q0 extends J0{constructor(){super()}print(e,...t){this.notify({message:e,level:"info"},...t)}warn(e,...t){this.notify({message:e,level:"warn"},...t)}error(e,t,...n){this.notify({message:e,level:"error",error:t},...n)}}var mt=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ze=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},xt,Vn,Kn,jn,zn,Wn,Yn,Zn,Sr;const Tc=.5,Bc=1.5,Nc=500,Oc=6e4,Uc=9e5,Rc=10;class Ti{constructor(e=Ti.default){xt.set(this,void 0),Vn.set(this,void 0),Kn.set(this,void 0),jn.set(this,void 0),zn.set(this,void 0),Wn.set(this,void 0),Yn.set(this,void 0),Zn.set(this,void 0),Sr.set(this,0);const{initialInterval:t=Nc,randomizationFactor:n=Tc,multiplier:i=Bc,maxInterval:o=Oc,maxElapsedTime:c=Uc,maxIterations:u=Rc,date:h=Date}=e;mt(this,xt,t,"f"),mt(this,Vn,n,"f"),mt(this,Kn,i,"f"),mt(this,jn,o,"f"),mt(this,Zn,h,"f"),mt(this,zn,h.now(),"f"),mt(this,Wn,c,"f"),mt(this,Yn,u,"f")}get ellapsedTimeInMsec(){return ze(this,Zn,"f").now()-ze(this,zn,"f")}get currentInterval(){return ze(this,xt,"f")}get count(){return ze(this,Sr,"f")}get randomValueFromInterval(){const e=ze(this,Vn,"f")*ze(this,xt,"f"),t=ze(this,xt,"f")-e,n=ze(this,xt,"f")+e;return Math.random()*(n-t)+t}incrementCurrentInterval(){var e;return mt(this,xt,Math.min(ze(this,xt,"f")*ze(this,Kn,"f"),ze(this,jn,"f")),"f"),mt(this,Sr,(e=ze(this,Sr,"f"),e++,e),"f"),ze(this,xt,"f")}next(){return this.ellapsedTimeInMsec>=ze(this,Wn,"f")||ze(this,Sr,"f")>=ze(this,Yn,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}xt=new WeakMap,Vn=new WeakMap,Kn=new WeakMap,jn=new WeakMap,zn=new WeakMap,Wn=new WeakMap,Yn=new WeakMap,Zn=new WeakMap,Sr=new WeakMap;Ti.default={initialInterval:Nc,randomizationFactor:Tc,multiplier:Bc,maxInterval:Oc,maxElapsedTime:Uc,maxIterations:Rc,date:Date};var Ve=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},J=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ye,sr,Mr,Et,Ot,Fr,Qr,Tr,ft,lt,ar,or,en,Br,Nr,cr,lr,Pc,Xn,Jn,ur,Ba;(function(r){r.Received="received",r.Processing="processing",r.Replied="replied",r.Rejected="rejected",r.Unknown="unknown",r.Done="done"})(Ba||(Ba={}));const Pn=60*1e3,el="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",tl="aaaaa-aa",rl="ic0.app",nl=".ic0.app",il="icp0.io",sl=".icp0.io",al="icp-api.io",ol=".icp-api.io";class Hi extends Me{constructor(e){super(e),this.message=e}}class Fn extends Me{constructor(e){super(e),this.message=e}}function cl(){let r;if(typeof window<"u")if(window.fetch)r=window.fetch.bind(window);else throw new Hi("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)r=global.fetch.bind(global);else throw new Hi("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(r=self.fetch.bind(self));if(r)return r;throw new Hi("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function ul(r){let e;if(r!==void 0)!r.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+r):e=new URL(r);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,o=i?.hostname;let c;o&&typeof o=="string"&&(n.some(u=>o.endsWith(u))?c=o:c=t.find(u=>o.endsWith(u))),i&&c?e=new URL(`${i.protocol}//${c}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class tn{constructor(e={}){var t,n;Ye.add(this),sr.set(this,null),Mr.set(this,!1),Et.set(this,void 0),Ot.set(this,void 0),Fr.set(this,void 0),Qr.set(this,void 0),Tr.set(this,0),ft.set(this,void 0),lt.set(this,void 0),ar.set(this,void 0),or.set(this,void 0),this._isAgent=!0,this.config={},en.set(this,0),this.log=new Q0,Br.set(this,[]),Nr.set(this,[]),cr.set(this,new Z0({expirationTime:5*60*1e3})),lr.set(this,!0),Jn.set(this,(c,u)=>{if(J(this,lr,"f")===!1)return c;if(!u)throw new It("Invalid signature from replica signed query: no matching node key found.");const{status:h,signatures:w=[],requestId:x}=c,v=Pt(new TextEncoder().encode("\vic-response"));for(const A of w){const{timestamp:d,identity:U}=A,P=Ee.fromUint8Array(U).toText();let R;if(h==="replied"){const{reply:Z}=c;R=ai({status:h,reply:Z,timestamp:BigInt(d),request_id:x})}else if(h==="rejected"){const{reject_code:Z,reject_message:q,error_code:$}=c;R=ai({status:h,reject_code:Z,reject_message:q,error_code:$,timestamp:BigInt(d),request_id:x})}else throw new Error(`Unknown status: ${h}`);const k=pt(v,Pt(new Uint8Array(R))),C=u?.nodeKeys.get(P);if(!C)throw new It("Invalid signature from replica signed query: no matching node key found.");const F=Sc.fromDer(C).rawKey;if(Ar.verify(A.signature,new Uint8Array(k),new Uint8Array(F)))return c;throw new It(`Invalid signature from replica ${P} signed query.`)}return c}),this.config=e,Ve(this,Ot,e.fetch||cl()||fetch.bind(global),"f"),Ve(this,Fr,e.fetchOptions,"f"),Ve(this,Qr,e.callOptions,"f"),Ve(this,Mr,(t=e.shouldFetchRootKey)!==null&&t!==void 0?t:!1,"f"),e.rootKey?this.rootKey=e.rootKey:J(this,Mr,"f")?this.rootKey=null:this.rootKey=Mt(el);const i=ul(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&Ve(this,lr,e.verifyQuerySignatures,"f"),Ve(this,lt,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const o=()=>new Ti({maxIterations:J(this,lt,"f")});if(Ve(this,ar,e.backoffStrategy||o,"f"),this.host.hostname.endsWith(nl)?this.host.hostname=rl:this.host.hostname.endsWith(sl)?this.host.hostname=il:this.host.hostname.endsWith(ol)&&(this.host.hostname=al),e.credentials){const{name:c,password:u}=e.credentials;Ve(this,ft,`${c}${u?":"+u:""}`,"f")}if(Ve(this,Et,Promise.resolve(e.identity||new oi),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Me(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Me(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);Ve(this,or,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",Qs(os)),e.useQueryNonces&&this.addTransform("query",Qs(os)),e.logToConsole&&this.log.subscribe(c=>{c.level==="error"?console.error(c.message):c.level==="warn"?console.warn(c.message):console.log(c.message)})}get waterMark(){return J(this,en,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const t=tn.createSync(e),n=[t.syncTime()];return t.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(t.fetchRootKey()),await Promise.all(n),t}static async from(e){var t;try{return"config"in e?await tn.create(e.config):await tn.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(t=e._identity)!==null&&t!==void 0?t:void 0})}catch{throw new Me("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,t,n=t.priority||0){if(e==="update"){const i=J(this,Nr,"f").findIndex(o=>(o.priority||0)<n);J(this,Nr,"f").splice(i>=0?i:J(this,Nr,"f").length,0,Object.assign(t,{priority:n}))}else if(e==="query"){const i=J(this,Br,"f").findIndex(o=>(o.priority||0)<n);J(this,Br,"f").splice(i>=0?i:J(this,Br,"f").length,0,Object.assign(t,{priority:n}))}}async getPrincipal(){if(!J(this,Et,"f"))throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");return(await J(this,Et,"f")).getPrincipal()}async call(e,t,n){var i,o;await J(this,Ye,"m",ur).call(this);const c=(i=t.callSync)!==null&&i!==void 0?i:!0,u=await(n!==void 0?await n:await J(this,Et,"f"));if(!u)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const h=Ee.from(e),w=t.effectiveCanisterId?Ee.from(t.effectiveCanisterId):h,x=u.getPrincipal()||Ee.anonymous();let v=new Nn(J(this,or,"f")*Pn);Math.abs(J(this,Tr,"f"))>1e3*30&&(v=new Nn(J(this,or,"f")*Pn+J(this,Tr,"f")));const A={request_type:as.Call,canister_id:h,method_name:t.methodName,arg:t.arg,sender:x,ingress_expiry:v};let d=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},J(this,ft,"f")?{Authorization:"Basic "+btoa(J(this,ft,"f"))}:{})},endpoint:"call",body:A}),U;t?.nonce?U=P(t.nonce):d.body.nonce?U=P(d.body.nonce):U=void 0,A.nonce=U;function P(F){return new Uint8Array(F)}d=await u.transformRequest(d);const R=Pi(d.body),k=J(this,ar,"f").call(this),C=ln(A);try{const F=()=>(this.log.print(`fetching "/api/v3/canister/${w.toText()}/call" with request:`,d),J(this,Ot,"f").call(this,""+new URL(`/api/v3/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},J(this,Qr,"f")),d.request),{body:R}))),O=()=>(this.log.print(`fetching "/api/v2/canister/${w.toText()}/call" with request:`,d),J(this,Ot,"f").call(this,""+new URL(`/api/v2/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},J(this,Qr,"f")),d.request),{body:R}))),q=await J(this,Ye,"m",Xn).call(this,{request:c?F:O,backoff:k,tries:0}),$=await q.arrayBuffer(),K=q.status===200&&$.byteLength>0?Ft($):null;if(K&&"certificate"in K){const z=await this.parseTimeFromResponse({certificate:K.certificate});Ve(this,en,z,"f")}return{requestId:C,response:{ok:q.ok,status:q.status,statusText:q.statusText,body:K,headers:Yr(q.headers)},requestDetails:A}}catch(F){if(F.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},t),{callSync:!1}),n);const O=`Error while making call: ${(o=F.message)!==null&&o!==void 0?o:String(F)}`,Z=new Xf(O,F,Pe(C),Pe(d.body.sender_pubkey),Pe(d.body.sender_sig),String(d.body.content.ingress_expiry._value));throw this.log.error(O,Z),Z}}async query(e,t,n){var i,o,c,u;await J(this,Ye,"m",ur).call(this);const h=J(this,ar,"f").call(this),w=t.effectiveCanisterId?Ee.from(t.effectiveCanisterId):Ee.from(e);this.log.print(`ecid ${w.toString()}`),this.log.print(`canisterId ${e.toString()}`);let x,v;const A=await(n!==void 0?n:J(this,Et,"f"));if(!A)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const d=Ee.from(e),U=A?.getPrincipal()||Ee.anonymous(),P={request_type:"query",canister_id:d,method_name:t.methodName,arg:t.arg,sender:U,ingress_expiry:new Nn(J(this,or,"f")*Pn)},R=ln(P);x=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},J(this,ft,"f")?{Authorization:"Basic "+btoa(J(this,ft,"f"))}:{})},endpoint:"read",body:P}),x=await A?.transformRequest(x);const k=Pi(x.body),C={canister:d.toText(),ecid:w,transformedRequest:x,body:k,requestId:R,backoff:h,tries:0},F=async()=>({requestDetails:P,query:await J(this,Ye,"m",Pc).call(this,C)}),O=async()=>{if(!J(this,lr,"f"))return;const Z=J(this,cr,"f").get(w.toString());return Z||(await this.fetchSubnetKeys(w.toString()),J(this,cr,"f").get(w.toString()))};try{const[Z,q]=await Promise.all([F(),O()]);v=Z;const{requestDetails:$,query:K}=v,z=Object.assign(Object.assign({},K),{requestDetails:$});if(this.log.print("Query response:",z),!J(this,lr,"f"))return z;try{return J(this,Jn,"f").call(this,z,q)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),J(this,cr,"f").delete(e.toString()),await this.fetchSubnetKeys(w.toString());const ae=J(this,cr,"f").get(e.toString());if(!ae)throw new It("Invalid signature from replica signed query: no matching node key found.");return J(this,Jn,"f").call(this,z,ae)}}catch(Z){const q=`Error while making call: ${(i=Z.message)!==null&&i!==void 0?i:String(Z)}`,$=new Jf(q,Z,String(R),Pe((o=x?.body)===null||o===void 0?void 0:o.sender_pubkey),Pe((c=x?.body)===null||c===void 0?void 0:c.sender_sig),String((u=x?.body)===null||u===void 0?void 0:u.content.ingress_expiry._value));throw this.log.error(q,$),$}}async createReadStateRequest(e,t){await J(this,Ye,"m",ur).call(this);const n=await(t!==void 0?await t:await J(this,Et,"f"));if(!n)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const i=n?.getPrincipal()||Ee.anonymous(),o=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},J(this,ft,"f")?{Authorization:"Basic "+btoa(J(this,ft,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new Nn(J(this,or,"f")*Pn)}});return n?.transformRequest(o)}async readState(e,t,n,i){var o,c,u,h;function w(P){for(const R of P.paths){const[k,C]=R,F=Pt(new TextEncoder().encode("request_status"));if(wn(k,F))return C}}const x=w(t);await J(this,Ye,"m",ur).call(this);const v=typeof e=="string"?Ee.fromText(e):e,A=i??await this.createReadStateRequest(t,n),d=Pi(A.body);this.log.print(`fetching "/api/v2/canister/${v}/read_state" with request:`,A);const U=J(this,ar,"f").call(this);try{const P=await J(this,Ye,"m",Xn).call(this,{request:()=>J(this,Ot,"f").call(this,""+new URL(`/api/v2/canister/${v.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},J(this,Fr,"f")),A.request),{body:d})),backoff:U,tries:0});if(!P.ok)throw new Error(`Server returned an error:
  Code: ${P.status} (${P.statusText})
  Body: ${await P.text()}
`);const R=Ft(await P.arrayBuffer());this.log.print("Read state response:",R);const k=await this.parseTimeFromResponse(R);return k>0&&(this.log.print("Read state response time:",k),Ve(this,en,k,"f")),R}catch(P){const R=`Caught exception while attempting to read state: ${(o=P.message)!==null&&o!==void 0?o:String(P)}`,k=new Qf(R,P,String(x),Pe((c=A?.body)===null||c===void 0?void 0:c.sender_pubkey),Pe((u=A?.body)===null||u===void 0?void 0:u.sender_sig),String((h=A?.body)===null||h===void 0?void 0:h.content.ingress_expiry._value));throw this.log.error(R,k),k}}async parseTimeFromResponse(e){let t;if(e.certificate){const n=Ft(e.certificate);if(n&&"tree"in n)t=n.tree;else throw new Error("Could not decode time from response");const i=qr(["time"],t);if(i.status!==Le.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const o=Ps(Pt(i.value));return this.log.print("Time from response:",o),this.log.print("Time from response in milliseconds:",Number(o)),Number(o)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await J(this,Ye,"m",ur).call(this);const t=await au(()=>Promise.resolve().then(()=>k0),void 0,import.meta.url),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=tn.createSync({identity:new oi,host:this.host.toString(),fetch:J(this,Ot,"f"),retryTimes:0}),c=(await t.request({canisterId:e??Ee.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");c&&(Ve(this,Tr,Number(c)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${J(this,Tr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=J(this,ft,"f")?{Authorization:"Basic "+btoa(J(this,ft,"f"))}:{};this.log.print('fetching "/api/v2/status"');const t=J(this,ar,"f").call(this),n=await J(this,Ye,"m",Xn).call(this,{backoff:t,request:()=>J(this,Ot,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},J(this,Fr,"f"))),tries:0});return Ft(await n.arrayBuffer())}async fetchRootKey(){let e;return J(this,sr,"f")?e=await J(this,sr,"f"):(Ve(this,sr,new Promise((t,n)=>{this.status().then(i=>{const o=i.root_key;this.rootKey=o,t(o)}).catch(n)}),"f"),e=await J(this,sr,"f")),Ve(this,sr,null,"f"),e}invalidateIdentity(){Ve(this,Et,null,"f")}replaceIdentity(e){Ve(this,Et,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await J(this,Ye,"m",ur).call(this);const t=Ee.from(e),i=(await mc({canisterId:t,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return J(this,cr,"f").set(t.toText(),i),i}_transform(e){let t=Promise.resolve(e);if(e.endpoint==="call")for(const n of J(this,Nr,"f"))t=t.then(i=>n(i).then(o=>o||i));else for(const n of J(this,Br,"f"))t=t.then(i=>n(i).then(o=>o||i));return t}}sr=new WeakMap,Mr=new WeakMap,Et=new WeakMap,Ot=new WeakMap,Fr=new WeakMap,Qr=new WeakMap,Tr=new WeakMap,ft=new WeakMap,lt=new WeakMap,ar=new WeakMap,or=new WeakMap,en=new WeakMap,Br=new WeakMap,Nr=new WeakMap,cr=new WeakMap,lr=new WeakMap,Jn=new WeakMap,Ye=new WeakSet,Pc=async function r(e){var t,n;const{ecid:i,transformedRequest:o,body:c,requestId:u,backoff:h,tries:w}=e,x=w===0?0:h.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:w,backoff:h,delay:x}),x===null)throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${J(this,lt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);x>0&&await new Promise(U=>setTimeout(U,x));let v;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const U=await J(this,Ot,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},J(this,Fr,"f")),o.request),{body:c}));if(U.status===200){const P=Ft(await U.arrayBuffer());v=Object.assign(Object.assign({},P),{httpDetails:{ok:U.ok,status:U.status,statusText:U.statusText,headers:Yr(U.headers)},requestId:u})}else throw new Fi(`Gateway returned an error:
  Code: ${U.status} (${U.statusText})
  Body: ${await U.text()}
`,{ok:U.ok,status:U.status,statusText:U.statusText,headers:Yr(U.headers)})}catch(U){if(w<J(this,lt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${U}
  Retrying query.`),await J(this,Ye,"m",r).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw U}const A=(n=(t=v.signatures)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.timestamp;if(!J(this,lr,"f"))return v;if(!A)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const d=Number(BigInt(A)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:d}),Number(this.waterMark)>d){const U=new Me("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",U,{timestamp:A,waterMark:this.waterMark}),w<J(this,lt,"f"))return await J(this,Ye,"m",r).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${J(this,lt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return v},Xn=async function r(e){const{request:t,backoff:n,tries:i}=e,o=i===0?0:n.next();if(o===null)throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${J(this,lt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);o>0&&await new Promise(w=>setTimeout(w,o));let c;try{c=await t()}catch(w){if(J(this,lt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${w}
  Retrying request.`),await J(this,Ye,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw w}if(c.ok)return c;const u=await c.clone().text(),h=`Server returned an error:
  Code: ${c.status} (${c.statusText})
  Body: ${u}
`;if(c.status===404&&c.url.includes("api/v3"))throw new Fi("v3 api not supported. Fall back to v2",{ok:c.ok,status:c.status,statusText:c.statusText,headers:Yr(c.headers)});if(i<J(this,lt,"f"))return await J(this,Ye,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw new Fi(h,{ok:c.ok,status:c.status,statusText:c.statusText,headers:Yr(c.headers)})},ur=async function(){if(!this.rootKey)if(this.rootKey===null&&J(this,Mr,"f"))await this.fetchRootKey();else throw new Me(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${J(this,Mr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Na;(function(r){r.Error="err",r.GetPrincipal="gp",r.GetPrincipalResponse="gpr",r.Query="q",r.QueryResponse="qr",r.Call="c",r.CallResponse="cr",r.ReadState="rs",r.ReadStateResponse="rsr",r.Status="s",r.StatusResponse="sr"})(Na||(Na={}));var pi=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Wt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Qn,ei,Or,Ur;function Oa(r){return r!==null&&typeof r=="object"}class Lt{constructor(e){if(Qn.set(this,void 0),ei.set(this,void 0),e.byteLength!==Lt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");pi(this,Qn,Pt(e),"f"),pi(this,ei,Lt.derEncode(e),"f")}static from(e){if(typeof e=="string"){const t=Mt(e);return this.fromRaw(t)}else if(Oa(e)){const t=e;if(Oa(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t)){const n=t;return this.fromRaw(Pt(n.buffer))}else{if(t instanceof ArrayBuffer)return this.fromRaw(t);if("rawKey"in t)return this.fromRaw(t.rawKey);if("derKey"in t)return this.fromDer(t.derKey);if("toDer"in t)return this.fromDer(t.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Lt(e)}static fromDer(e){return new Lt(this.derDecode(e))}static derEncode(e){const t=Ic(e,hi).buffer;return t.__derEncodedPublicKey__=void 0,t}static derDecode(e){const t=Ac(e,hi);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return Pt(t)}get rawKey(){return Wt(this,Qn,"f")}get derKey(){return Wt(this,ei,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Qn=new WeakMap,ei=new WeakMap;Lt.RAW_KEY_LENGTH=32;class Jt extends Bs{constructor(e,t){super(),Or.set(this,void 0),Ur.set(this,void 0),pi(this,Or,Lt.from(e),"f"),pi(this,Ur,new Uint8Array(t),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=Ar.utils.randomPrivateKey()),wn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const t=new Uint8Array(32);for(let i=0;i<32;i++)t[i]=new Uint8Array(e)[i];const n=Ar.getPublicKey(t);return Jt.fromKeyPair(n,t)}static fromParsedJson(e){const[t,n]=e;return new Jt(Lt.fromDer(Mt(t)),Mt(n))}static fromJSON(e){const t=JSON.parse(e);if(Array.isArray(t)){if(typeof t[0]=="string"&&typeof t[1]=="string")return this.fromParsedJson([t[0],t[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,t){return new Jt(Lt.fromRaw(e),t)}static fromSecretKey(e){const t=Ar.getPublicKey(new Uint8Array(e));return Jt.fromKeyPair(t,e)}toJSON(){return[Pe(Wt(this,Or,"f").toDer()),Pe(Wt(this,Ur,"f"))]}getKeyPair(){return{secretKey:Wt(this,Ur,"f"),publicKey:Wt(this,Or,"f")}}getPublicKey(){return Wt(this,Or,"f")}async sign(e){const t=new Uint8Array(e),n=rn(Ar.sign(t,Wt(this,Ur,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,t,n){const[i,o,c]=[e,t,n].map(u=>(typeof u=="string"&&(u=Mt(u)),u instanceof Uint8Array&&(u=Pt(u.buffer)),new Uint8Array(u)));return Ar.verify(i,o,c)}}Or=new WeakMap,Ur=new WeakMap;class Ls extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,Ls.prototype)}}function Ua(r){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(r)return r;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new Ls("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class yi extends Bs{constructor(e,t,n){super(),this._keyPair=e,this._derKey=t,this._subtleCrypto=n}static async generate(e){const{extractable:t=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},o=Ua(i),c=await o.generateKey({name:"ECDSA",namedCurve:"P-256"},t,n),u=await o.exportKey("spki",c.publicKey);return new this(c,u,o)}static async fromKeyPair(e,t){const n=Ua(t),i=await n.exportKey("spki",e.publicKey);return new yi(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,t=Object.create(this._keyPair.publicKey);return t.toDer=function(){return e},t}async sign(e){const t={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(t,this._keyPair.privateKey,e)}}var fl=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ir=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Nt;class ll{constructor(e){Nt.set(this,void 0),fl(this,Nt,e,"f")}get rawKey(){return Ir(this,Nt,"f").rawKey}get derKey(){return Ir(this,Nt,"f").derKey}toDer(){return Ir(this,Nt,"f").toDer()}getPublicKey(){return Ir(this,Nt,"f")}getPrincipal(){if(!Ir(this,Nt,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return Ee.fromUint8Array(new Uint8Array(Ir(this,Nt,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Nt=new WeakMap;var dl=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},hl=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},pl=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},ti;const yl=new TextEncoder().encode("ic-request-auth-delegation"),wl=new TextEncoder().encode(`
ic-request`);function Vi(r){if(typeof r!="string"||r.length<64)throw new Error("Invalid public key.");return Mt(r)}class Ms{constructor(e,t,n){this.pubkey=e,this.expiration=t,this.targets=n}toCBOR(){return nt.value.map(Object.assign({pubkey:nt.value.bytes(this.pubkey),expiration:nt.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:nt.value.array(this.targets.map(e=>nt.value.bytes(Cr(e.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Pe(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function gl(r,e,t,n){const i=new Ms(e.toDer(),BigInt(+t)*BigInt(1e6),n),o=new Uint8Array([...yl,...new Uint8Array(ln(Object.assign({},i)))]),c=await r.sign(Cr(o));return{delegation:i,signature:c}}class wi{constructor(e,t){this.delegations=e,this.publicKey=t}static async create(e,t,n=new Date(Date.now()+15*60*1e3),i={}){var o,c;const u=await gl(e,t,n,i.targets);return new wi([...((o=i.previous)===null||o===void 0?void 0:o.delegations)||[],u],((c=i.previous)===null||c===void 0?void 0:c.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:t,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(o=>{const{delegation:c,signature:u}=o,{pubkey:h,expiration:w,targets:x}=c;if(x!==void 0&&!Array.isArray(x))throw new Error("Invalid targets.");return{delegation:new Ms(Vi(h),BigInt("0x"+w),x&&x.map(v=>{if(typeof v!="string")throw new Error("Invalid target.");return Ee.fromHex(v)})),signature:Vi(u)}});return new this(i,Vi(t))}static fromDelegations(e,t){return new this(e,t)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:t,signature:n}=e,{targets:i}=t;return{delegation:Object.assign({expiration:t.expiration.toString(16),pubkey:Pe(t.pubkey)},i&&{targets:i.map(o=>o.toHex())}),signature:Pe(n)}}),publicKey:Pe(this.publicKey)}}}class Ra extends Bs{constructor(e,t){super(),this._inner=e,this._delegation=t}static fromDelegation(e,t){return new this(e,t)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:t}=e,n=pl(e,["body"]),i=await ln(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_sig:await this.sign(Cr(new Uint8Array([...wl,...new Uint8Array(i)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class gi extends ll{constructor(e,t){super(e),ti.set(this,void 0),dl(this,ti,t,"f")}get delegation(){return hl(this,ti,"f")}static fromDelegation(e,t){return new gi(e,t)}}ti=new WeakMap;function bl(r,e){for(const{delegation:n}of r.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const t=[];for(const n of t){const i=n.toText();for(const{delegation:o}of r.delegations){if(o.targets===void 0)continue;let c=!0;for(const u of o.targets)if(u.toText()===i){c=!1;break}if(c)return!1}}return!0}var Pa;(function(r){r[r.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(Pa||(Pa={}));const Fa=["mousedown","mousemove","keydown","touchstart","wheel"];class La{constructor(e={}){var t;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const o=this._resetTimer.bind(this);window.addEventListener("load",o,!0),Fa.forEach(function(u){document.addEventListener(u,o,!0)});const c=(u,h)=>{let w;return(...x)=>{const v=this,A=function(){w=void 0,u.apply(v,x)};clearTimeout(w),w=window.setTimeout(A,h)}};if(e?.captureScroll){const u=c(o,(t=e?.scrollDebounce)!==null&&t!==void 0?t:100);window.addEventListener("scroll",u,!0)}o()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);Fa.forEach(function(t){document.removeEventListener(t,e,!0)}),this.callbacks.forEach(t=>t())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const ml=(r,e)=>e.some(t=>r instanceof t);let Ma,Da;function _l(){return Ma||(Ma=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xl(){return Da||(Da=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fc=new WeakMap,ws=new WeakMap,Lc=new WeakMap,Ki=new WeakMap,Ds=new WeakMap;function El(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",c)},o=()=>{t(tr(r.result)),i()},c=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Fc.set(t,r)}).catch(()=>{}),Ds.set(e,r),e}function vl(r){if(ws.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",c),r.removeEventListener("abort",c)},o=()=>{t(),i()},c=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",c),r.addEventListener("abort",c)});ws.set(r,e)}let gs={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ws.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Lc.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tr(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function Il(r){gs=r(gs)}function Al(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(ji(this),e,...t);return Lc.set(n,e.sort?e.sort():[e]),tr(n)}:xl().includes(r)?function(...e){return r.apply(ji(this),e),tr(Fc.get(this))}:function(...e){return tr(r.apply(ji(this),e))}}function Sl(r){return typeof r=="function"?Al(r):(r instanceof IDBTransaction&&vl(r),ml(r,_l())?new Proxy(r,gs):r)}function tr(r){if(r instanceof IDBRequest)return El(r);if(Ki.has(r))return Ki.get(r);const e=Sl(r);return e!==r&&(Ki.set(r,e),Ds.set(e,r)),e}const ji=r=>Ds.get(r);function Tl(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(r,e),u=tr(c);return n&&c.addEventListener("upgradeneeded",h=>{n(tr(c.result),h.oldVersion,h.newVersion,tr(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",w=>i(w.oldVersion,w.newVersion,w))}).catch(()=>{}),u}const Bl=["get","getKey","getAll","getAllKeys","count"],Nl=["put","add","delete","clear"],zi=new Map;function ka(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(zi.get(e))return zi.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Nl.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Bl.includes(t)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let w=h.store;return n&&(w=w.index(u.shift())),(await Promise.all([w[t](...u),i&&h.done]))[0]};return zi.set(e,o),o}Il(r=>({...r,get:(e,t,n)=>ka(e,t)||r.get(e,t,n),has:(e,t)=>!!ka(e,t)||r.has(e,t)}));const Mc="auth-client-db",Dc="ic-keyval",Ol=async(r=Mc,e=Dc,t)=>(kc&&(localStorage!=null&&localStorage.getItem(Xt))&&(localStorage.removeItem(Xt),localStorage.removeItem(Yt)),await Tl(r,t,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function Ul(r,e,t){return await r.get(e,t)}async function Rl(r,e,t,n){return await r.put(e,n,t)}async function Pl(r,e,t){return await r.delete(e,t)}class ks{constructor(e,t){this._db=e,this._storeName=t}static async create(e){const{dbName:t=Mc,storeName:n=Dc,version:i=Dl}=e??{},o=await Ol(t,n,i);return new ks(o,n)}async set(e,t){return await Rl(this._db,this._storeName,e,t)}async get(e){var t;return(t=await Ul(this._db,this._storeName,e))!==null&&t!==void 0?t:null}async remove(e){return await Pl(this._db,this._storeName,e)}}var Fl=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ll=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ri;const Yt="identity",Xt="delegation",Ml="iv",Dl=1,kc=typeof window<"u";class kl{constructor(e="ic-",t){this.prefix=e,this._localStorage=t}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,t){return this._getLocalStorage().setItem(this.prefix+e,t),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class Cl{constructor(e){ri.set(this,void 0),Fl(this,ri,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}ks.create(Ll(this,ri,"f")).then(t=>{this.initializedDb=t,e(t)})})}async get(e){return await(await this._db).get(e)}async set(e,t){await(await this._db).set(e,t)}async remove(e){await(await this._db).remove(e)}}ri=new WeakMap;const $l="https://identity.internetcomputer.org",ql="#authorize",Wi="ECDSA",Yi="Ed25519",Gl=500,Hl="UserInterrupt";class Vl{constructor(e,t,n,i,o,c,u,h){this._identity=e,this._key=t,this._chain=n,this._storage=i,this.idleManager=o,this._createOptions=c,this._idpWindow=u,this._eventHandler=h,this._registerDefaultIdleCallback()}static async create(e={}){var t,n,i;const o=(t=e.storage)!==null&&t!==void 0?t:new Cl,c=(n=e.keyType)!==null&&n!==void 0?n:Wi;let u=null;if(e.identity)u=e.identity;else{let v=await o.get(Yt);if(!v&&kc)try{const A=new kl,d=await A.get(Xt),U=await A.get(Yt);d&&U&&c===Wi&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await o.set(Xt,d),await o.set(Yt,U),v=d,await A.remove(Xt),await A.remove(Yt))}catch(A){console.error("error while attempting to recover localstorage: "+A)}if(v)try{typeof v=="object"?c===Yi&&typeof v=="string"?u=await Jt.fromJSON(v):u=await yi.fromKeyPair(v):typeof v=="string"&&(u=Jt.fromJSON(v))}catch{}}let h=new oi,w=null;if(u)try{const v=await o.get(Xt);if(typeof v=="object"&&v!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?h=e.identity:v&&(w=wi.fromJSON(v),bl(w)?"toDer"in u?h=gi.fromDelegation(u,w):h=Ra.fromDelegation(u,w):(await Zi(o),u=null))}catch(v){console.error(v),await Zi(o),u=null}let x;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?x=void 0:(w||e.identity)&&(x=La.create(e.idleOptions)),u||(c===Yi?(u=await Jt.generate(),await o.set(Yt,JSON.stringify(u.toJSON()))):(e.storage&&c===Wi&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${Yi}' as the key type, as it can serialize to a string`),u=await yi.generate(),await o.set(Yt,u.getKeyPair()))),new this(h,u,w,o,x,e)}_registerDefaultIdleCallback(){var e,t;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!n?.onIdle&&!n?.disableDefaultIdleCallback&&((t=this.idleManager)===null||t===void 0||t.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,t){var n,i;const o=e.delegations.map(w=>({delegation:new Ms(w.delegation.pubkey,w.delegation.expiration,w.delegation.targets),signature:w.signature.buffer})),c=wi.fromDelegations(o,e.userPublicKey.buffer),u=this._key;if(!u)return;this._chain=c,"toDer"in u?this._identity=gi.fromDelegation(u,this._chain):this._identity=Ra.fromDelegation(u,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const h=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!h?.disableIdle&&(this.idleManager=La.create(h),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Xt,JSON.stringify(this._chain.toJSON())),t?.(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var t,n,i,o;const c=BigInt(8)*BigInt(36e11),u=new URL(((t=e?.identityProvider)===null||t===void 0?void 0:t.toString())||$l);u.hash=ql,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(u,Object.assign({maxTimeToLive:(i=e?.maxTimeToLive)!==null&&i!==void 0?i:c},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(o=window.open(u.toString(),"idpWindow",e?.windowOpenerFeatures))!==null&&o!==void 0?o:void 0;const h=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Hl,e?.onError):setTimeout(h,Gl))};h()}_getEventHandler(e,t){return async n=>{var i,o,c;if(n.origin!==e.origin)return;const u=n.data;switch(u.kind){case"authorize-ready":{const h=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:t?.maxTimeToLive,allowPinAuthentication:t?.allowPinAuthentication,derivationOrigin:(o=t?.derivationOrigin)===null||o===void 0?void 0:o.toString()},t?.customValues);(c=this._idpWindow)===null||c===void 0||c.postMessage(h,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(u,t?.onSuccess)}catch(h){this._handleFailure(h.message,t?.onError)}break;case"authorize-client-failure":this._handleFailure(u.text,t?.onError);break}}}_handleFailure(e,t){var n;(n=this._idpWindow)===null||n===void 0||n.close(),t?.(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await Zi(this._storage),this._identity=new oi,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function Zi(r){await r.remove(Yt),await r.remove(Xt),await r.remove(Ml)}const Xi=()=>Vl.create({idleOptions:{disableIdle:!0,disableDefaultIdleCallback:!0}});var Kl=(r=>(r[r.FractionalMoreThan8Decimals=0]="FractionalMoreThan8Decimals",r[r.InvalidFormat=1]="InvalidFormat",r[r.FractionalTooManyDecimals=2]="FractionalTooManyDecimals",r))(Kl||{});BigInt(1e8);var bs=r=>r==null,yd=r=>!bs(r),Ca="abcdefghijklmnopqrstuvwxyz234567",yn=Object.create(null);for(let r=0;r<Ca.length;r++)yn[Ca[r]]=r;yn[0]=yn.o;yn[1]=yn.i;const jl=({width:r,height:e})=>{if(bs(window)||bs(window.top))return;const{top:{innerWidth:t,innerHeight:n}}=window,i=n/2+screenY-e/2,o=t/2+screenX-r/2;return`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=${r}, height=${e}, top=${i}, left=${o}`};let _t;const zl="https://waterwaylabs.xyz",Wl="https://qm6x5-qqaaa-aaaal-qcnea-cai.icp0.io",Yl=()=>window.location.origin===zl,Zl=()=>{const{subscribe:r,set:e,update:t}=qa({identity:void 0});return{subscribe:r,sync:async()=>{_t=_t??await Xi();const n=await _t.isAuthenticated();e({identity:n?_t.getIdentity():null})},signIn:({domain:n})=>new Promise(async(i,o)=>{_t=_t??await Xi();const c=n;await _t?.login({maxTimeToLive:cu,onSuccess:()=>{t(u=>({...u,identity:_t?.getIdentity()})),i()},onError:o,identityProvider:c,...Yl()&&{derivationOrigin:Wl},windowOpenerFeatures:jl({width:uu,height:fu})})}),signOut:async()=>{await(_t??await Xi()).logout(),_t=null,t(i=>({...i,identity:null})),localStorage.removeItem("user_profile_data")}}},wd=Zl(),gd=qa(void 0);export{Me as A,cn as C,tn as H,cd as I,Ee as P,Ba as R,wd as a,bs as b,Cr as c,Ju as d,Xu as e,Cs as f,gd as g,ds as l,yd as s,Pe as t};
