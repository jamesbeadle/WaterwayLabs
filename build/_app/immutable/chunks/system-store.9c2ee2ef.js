import{w as m}from"./singletons.a3e0ed1f.js";import{H as d,A as g}from"./Layout.afec06dc.js";const y=({IDL:t})=>{const s=t.Record({hash:t.Text,category:t.Text}),r=t.Record({displayName:t.Text,createDate:t.Int,profilePicture:t.Vec(t.Nat8),principalId:t.Text}),c=t.Record({}),e=t.Variant({DecodeError:t.Null,NotAllowed:t.Null,NotFound:t.Null,NotAuthorized:t.Null,InvalidData:t.Null,AlreadyExists:t.Null}),a=t.Variant({ok:t.Null,err:e});return t.Service({getDataHashes:t.Func([],[t.Vec(s)],["query"]),getProfileDTO:t.Func([],[r],[]),getSystemState:t.Func([],[c],["query"]),isDisplayNameValid:t.Func([t.Text],[t.Bool],["query"]),updateDisplayName:t.Func([t.Text],[a],[]),updateProfilePicture:t.Func([t.Vec(t.Nat8)],[a],[])})};class i{static createActor(s,r="",c=null,e=null){const a={host:`https://${r}.icp-api.io`,identity:c};e?e.agentOptions?e.agentOptions.host=a.host:e.agentOptions=a:e={agentOptions:a};const n=new d({...e.agentOptions});return g.createActor(s,{agent:n,canisterId:r,...e?.actorOptions})}static createIdentityActor(s,r){let c;return new Promise((e,a)=>{c=s.subscribe(n=>{n.identity&&e(n.identity)})}).then(e=>(c(),i.createActor(y,r,e)))}}function N(t,s){return typeof s=="bigint"?s.toString():s}function h(){const{subscribe:t,set:s}=m(null);let r=i.createActor(y,"rbqtt-7yaaa-aaaal-qcndq-cai");async function c(){let a="system_state",u=(await r.getDataHashes()).find(l=>l.category===a)??null;const S=localStorage.getItem(a);if(u?.hash!=S){let l=await r.getSystemState();localStorage.setItem("system_state_data",JSON.stringify(l,N)),localStorage.setItem(a,u?.hash??""),s(l)}else{const l=localStorage.getItem("system_state_data");let o=null;try{o=JSON.parse(l||"{}")}catch{o=null}s(o)}}async function e(){let a;return t(n=>{a=n})(),a}return{subscribe:t,sync:c,getSystemState:e}}const O=h();export{i as A,O as s};
